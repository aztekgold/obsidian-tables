/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
*/

var Dt=Object.defineProperty;var or=Object.getOwnPropertyDescriptor;var sr=Object.getOwnPropertyNames;var lr=Object.prototype.hasOwnProperty;var cr=(r,t)=>{for(var e in t)Dt(r,e,{get:t[e],enumerable:!0})},dr=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of sr(t))!lr.call(r,a)&&a!==e&&Dt(r,a,{get:()=>t[a],enumerable:!(n=or(t,a))||n.enumerable});return r};var ur=r=>dr(Dt({},"__esModule",{value:!0}),r);var aa={};cr(aa,{default:()=>pt});module.exports=ur(aa);var Y=require("obsidian");var Ce=require("obsidian");var ee="json-table-view",We={tableRenderer:"default"};var $e=class{render(t,e,n,a,i){let c=e.createEl("input",{type:"text",value:n,cls:"json-table-input",title:n});c.addEventListener("blur",()=>i(c.value)),c.addEventListener("keydown",l=>{l.key==="Enter"&&(l.preventDefault(),c.blur())})}};var Ve=class{render(t,e,n,a,i){let l=e.createEl("div",{cls:"json-table-cell-content json-table-cell-checkbox"}).createEl("input",{type:"checkbox",cls:"json-table-checkbox"});l.checked=n==="true",l.addEventListener("change",()=>{i(l.checked.toString())})}};var Be=class{render(t,e,n,a,i){e.empty();let c=e.createEl("div",{cls:"json-table-dropdown"});this.renderTags(c,n,a),c.addEventListener("click",l=>{l.stopPropagation(),this.renderEdit(t,c,n,a,i)})}renderDisplay(t,e,n,a,i){e.empty(),e.removeClass("is-editing"),this.renderTags(e,n,a),e.addEventListener("click",c=>{c.stopPropagation(),this.renderEdit(t,e,n,a,i)})}renderEdit(t,e,n,a,i){let c=e.parentNode;if(!c)return;let l=e.cloneNode(!1);c.replaceChild(l,e),l.empty(),l.addClass("is-editing");let d=()=>{n="",i(""),this.renderEdit(t,l,"",a,i)};this.renderTags(l,n,a,d);let g=this.showDropdownPopup(l,n,a,p=>{n=p,i(p),this.renderEdit(t,l,p,a,i)}),f=p=>{!l.contains(p.target)&&!g.contains(p.target)&&(document.removeEventListener("click",f,!0),g.remove(),this.renderDisplay(t,l,n,a,i))};setTimeout(()=>{document.addEventListener("click",f,!0)},0)}renderTags(t,e,n,a){let i=n.typeOptions,c=(i==null?void 0:i.options)||[];if(t.empty(),!e){a||t.createEl("span",{text:"",cls:"json-table-dropdown-placeholder"});return}let l=c.find(g=>g.value===e),d=t.createEl("span",{cls:"json-table-dropdown-tag"});l&&l.style?d.addClass(`dropdown-tag--${l.style}`):d.addClass("dropdown-tag--default"),d.createEl("span",{text:e}),a&&d.createEl("span",{text:"\xD7",cls:"json-table-multiselect-tag-remove"}).addEventListener("mousedown",f=>{f.preventDefault(),f.stopPropagation(),a()})}showDropdownPopup(t,e,n,a){let i=n.typeOptions,c=(i==null?void 0:i.options)||[],l=document.body.querySelector(".json-table-dropdown-popup");l&&l.remove();let d=document.body.createEl("div",{cls:"json-table-popup json-table-dropdown-popup"}),g=t.getBoundingClientRect();return d.style.top=`${g.bottom+4}px`,d.style.left=`${g.left}px`,d.style.minWidth=`${g.width}px`,c.length>0?c.forEach(f=>{let p=d.createEl("div",{cls:"json-table-dropdown-option"}),h=p.createEl("span",{text:f.value,cls:"json-table-dropdown-tag"});f.style&&h.addClass(`dropdown-tag--${f.style}`),p.addEventListener("mousedown",y=>{y.preventDefault(),a(f.value)})}):d.createEl("div",{text:"No options defined",cls:"json-table-dropdown-option is-disabled"}),d}};var Je=class{render(t,e,n,a,i){e.empty();let c=e.createEl("div",{cls:"json-table-multiselect"});this.renderTags(c,n,a),c.addEventListener("click",l=>{l.stopPropagation(),this.renderEdit(t,c,n,a,i)})}renderDisplay(t,e,n,a,i){e.empty(),e.removeClass("is-editing"),this.renderTags(e,n,a),e.addEventListener("click",c=>{c.stopPropagation(),this.renderEdit(t,e,n,a,i)})}renderEdit(t,e,n,a,i){let c=e.parentNode;if(!c)return;let l=e.cloneNode(!1);c.replaceChild(l,e),l.empty(),l.addClass("is-editing");let d=p=>{let w=this.getValues(n).filter(b=>b!==p).join(",");n=w,i(w),this.renderEdit(t,l,w,a,i)};this.renderTags(l,n,a,d);let g=this.showDropdownPopup(l,n,a,p=>{let h=this.getValues(n);if(h.includes(p))return;h.push(p);let y=h.join(",");n=y,i(y),this.renderEdit(t,l,n,a,i)}),f=p=>{!l.contains(p.target)&&!g.contains(p.target)&&(document.removeEventListener("click",f,!0),g.remove(),this.renderDisplay(t,l,n,a,i))};setTimeout(()=>{document.addEventListener("click",f,!0)},0)}getValues(t){return t?t.split(",").filter(Boolean):[]}renderTags(t,e,n,a){let i=n.typeOptions,c=(i==null?void 0:i.options)||[],l=this.getValues(e);if(t.empty(),l.length===0){a||t.createEl("span",{text:"",cls:"json-table-dropdown-placeholder"});return}l.forEach(d=>{let g=c.find(p=>p.value===d),f=t.createEl("span",{cls:"json-table-dropdown-tag"});g&&g.style?f.addClass(`dropdown-tag--${g.style}`):f.addClass("dropdown-tag--default"),f.createEl("span",{text:d}),a&&f.createEl("span",{text:"\xD7",cls:"json-table-multiselect-tag-remove"}).addEventListener("mousedown",h=>{h.preventDefault(),h.stopPropagation(),a(d)})})}showDropdownPopup(t,e,n,a){let i=n.typeOptions,c=(i==null?void 0:i.options)||[],l=document.body.querySelector(".json-table-dropdown-popup");l&&l.remove();let d=document.body.createEl("div",{cls:"json-table-popup json-table-dropdown-popup"}),g=t.getBoundingClientRect();d.style.top=`${g.bottom+4}px`,d.style.left=`${g.left}px`,d.style.minWidth=`${g.width}px`;let f=this.getValues(e);return c.length>0?c.forEach(p=>{let h=d.createEl("div",{cls:"json-table-dropdown-option"}),y=h.createEl("span",{text:p.value,cls:"json-table-dropdown-tag"});p.style&&y.addClass(`dropdown-tag--${p.style}`),h.addEventListener("mousedown",w=>{w.preventDefault(),a(p.value)})}):d.createEl("div",{text:"No options defined",cls:"json-table-dropdown-option is-disabled"}),d}};var Gt=require("obsidian"),qe=class extends Gt.AbstractInputSuggest{constructor(e,n,a,i){super(e,n);this.suggestAllFiles=a;this.onSaveCallback=i}getSuggestions(e){let n=e.toLowerCase();return(this.suggestAllFiles?this.app.vault.getFiles():this.app.vault.getMarkdownFiles()).filter(i=>i.basename.toLowerCase().includes(n)||i.path.toLowerCase().includes(n))}renderSuggestion(e,n){n.setText(e.path),n.addClass("mod-complex")}selectSuggestion(e,n){let a=e.path;this.setValue(a),this.close(),this.onSaveCallback(a)}};var Ge=class{render(t,e,n,a,i){e.empty();let c=e.createEl("div",{cls:"json-table-notelink-wrapper"});this.renderDisplay(t,c,n,a,i)}renderDisplay(t,e,n,a,i){e.empty(),e.addClass("is-displaying-link");let c=t.metadataCache.getFirstLinkpathDest(n,"");e.addEventListener("click",l=>{l.target===e&&this.renderEdit(t,e,n,a,i)}),c?e.createEl("a",{text:c.basename,cls:"internal-link",attr:{"data-href":n,href:n}}).addEventListener("click",d=>{d.preventDefault(),d.stopPropagation(),t.workspace.openLinkText(n,"",!1)}):e.createEl("span",{text:n||"",cls:"json-table-notelink-empty"})}renderEdit(t,e,n,a,i){let c=e.parentNode;if(!c)return;let l=e.cloneNode(!1);c.replaceChild(l,e),l.empty(),l.removeClass("is-displaying-link");let d=l.createEl("input",{type:"text",value:n,cls:"json-table-input"}),g=!1,f=w=>{if(g||(g=!0,!l.parentElement))return;let b=w.trim(),E=b;if(b){let S=t.metadataCache.getFirstLinkpathDest(b,"");S&&(E=S.path)}i(E),this.renderDisplay(t,l,E,a,i)},p=a.typeOptions,h=!!(p!=null&&p.suggestAllFiles),y=new qe(t,d,h,w=>{f(w)});setTimeout(()=>{d.focus(),d.select()},0),d.addEventListener("keydown",w=>{let b=!!document.body.querySelector(".suggestion-container");if(w.key==="Enter"){if(w.preventDefault(),b)return;f(d.value)}w.key==="Escape"&&(w.preventDefault(),b?y.close():this.renderDisplay(t,l,n,a,i))}),d.addEventListener("blur",w=>{setTimeout(()=>{g||f(d.value)},100)})}};var ze=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],le={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:typeof window=="object"&&window.navigator.userAgent.indexOf("MSIE")===-1,ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:function(r){return typeof console!="undefined"&&console.warn(r)},getWeek:function(r){var t=new Date(r.getTime());t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7);var e=new Date(t.getFullYear(),0,4);return 1+Math.round(((t.getTime()-e.getTime())/864e5-3+(e.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1};var Ke={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(r){var t=r%100;if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},Qe=Ke;var B=function(r,t){return t===void 0&&(t=2),("000"+r).slice(t*-1)},G=function(r){return r===!0?1:0};function Et(r,t){var e;return function(){var n=this,a=arguments;clearTimeout(e),e=setTimeout(function(){return r.apply(n,a)},t)}}var Ue=function(r){return r instanceof Array?r:[r]};function J(r,t,e){if(e===!0)return r.classList.add(t);r.classList.remove(t)}function P(r,t,e){var n=window.document.createElement(r);return t=t||"",e=e||"",n.className=t,e!==void 0&&(n.textContent=e),n}function ke(r){for(;r.firstChild;)r.removeChild(r.firstChild)}function Ct(r,t){if(t(r))return r;if(r.parentNode)return Ct(r.parentNode,t)}function Fe(r,t){var e=P("div","numInputWrapper"),n=P("input","numInput "+r),a=P("span","arrowUp"),i=P("span","arrowDown");if(navigator.userAgent.indexOf("MSIE 9.0")===-1?n.type="number":(n.type="text",n.pattern="\\d*"),t!==void 0)for(var c in t)n.setAttribute(c,t[c]);return e.appendChild(n),e.appendChild(a),e.appendChild(i),e}function z(r){try{if(typeof r.composedPath=="function"){var t=r.composedPath();return t[0]}return r.target}catch(e){return r.target}}var Mt=function(){},Se=function(r,t,e){return e.months[t?"shorthand":"longhand"][r]},zt={D:Mt,F:function(r,t,e){r.setMonth(e.months.longhand.indexOf(t))},G:function(r,t){r.setHours((r.getHours()>=12?12:0)+parseFloat(t))},H:function(r,t){r.setHours(parseFloat(t))},J:function(r,t){r.setDate(parseFloat(t))},K:function(r,t,e){r.setHours(r.getHours()%12+12*G(new RegExp(e.amPM[1],"i").test(t)))},M:function(r,t,e){r.setMonth(e.months.shorthand.indexOf(t))},S:function(r,t){r.setSeconds(parseFloat(t))},U:function(r,t){return new Date(parseFloat(t)*1e3)},W:function(r,t,e){var n=parseInt(t),a=new Date(r.getFullYear(),0,2+(n-1)*7,0,0,0,0);return a.setDate(a.getDate()-a.getDay()+e.firstDayOfWeek),a},Y:function(r,t){r.setFullYear(parseFloat(t))},Z:function(r,t){return new Date(t)},d:function(r,t){r.setDate(parseFloat(t))},h:function(r,t){r.setHours((r.getHours()>=12?12:0)+parseFloat(t))},i:function(r,t){r.setMinutes(parseFloat(t))},j:function(r,t){r.setDate(parseFloat(t))},l:Mt,m:function(r,t){r.setMonth(parseFloat(t)-1)},n:function(r,t){r.setMonth(parseFloat(t)-1)},s:function(r,t){r.setSeconds(parseFloat(t))},u:function(r,t){return new Date(parseFloat(t))},w:Mt,y:function(r,t){r.setFullYear(2e3+parseFloat(t))}},ae={D:"",F:"",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},ve={Z:function(r){return r.toISOString()},D:function(r,t,e){return t.weekdays.shorthand[ve.w(r,t,e)]},F:function(r,t,e){return Se(ve.n(r,t,e)-1,!1,t)},G:function(r,t,e){return B(ve.h(r,t,e))},H:function(r){return B(r.getHours())},J:function(r,t){return t.ordinal!==void 0?r.getDate()+t.ordinal(r.getDate()):r.getDate()},K:function(r,t){return t.amPM[G(r.getHours()>11)]},M:function(r,t){return Se(r.getMonth(),!0,t)},S:function(r){return B(r.getSeconds())},U:function(r){return r.getTime()/1e3},W:function(r,t,e){return e.getWeek(r)},Y:function(r){return B(r.getFullYear(),4)},d:function(r){return B(r.getDate())},h:function(r){return r.getHours()%12?r.getHours()%12:12},i:function(r){return B(r.getMinutes())},j:function(r){return r.getDate()},l:function(r,t){return t.weekdays.longhand[r.getDay()]},m:function(r){return B(r.getMonth()+1)},n:function(r){return r.getMonth()+1},s:function(r){return r.getSeconds()},u:function(r){return r.getTime()},w:function(r){return r.getDay()},y:function(r){return String(r.getFullYear()).substring(2)}};var xt=function(r){var t=r.config,e=t===void 0?le:t,n=r.l10n,a=n===void 0?Ke:n,i=r.isMobile,c=i===void 0?!1:i;return function(l,d,g){var f=g||a;return e.formatDate!==void 0&&!c?e.formatDate(l,d,f):d.split("").map(function(p,h,y){return ve[p]&&y[h-1]!=="\\"?ve[p](l,f,e):p!=="\\"?p:""}).join("")}},Xe=function(r){var t=r.config,e=t===void 0?le:t,n=r.l10n,a=n===void 0?Ke:n;return function(i,c,l,d){if(!(i!==0&&!i)){var g=d||a,f,p=i;if(i instanceof Date)f=new Date(i.getTime());else if(typeof i!="string"&&i.toFixed!==void 0)f=new Date(i);else if(typeof i=="string"){var h=c||(e||le).dateFormat,y=String(i).trim();if(y==="today")f=new Date,l=!0;else if(e&&e.parseDate)f=e.parseDate(i,h);else if(/Z$/.test(y)||/GMT$/.test(y))f=new Date(i);else{for(var w=void 0,b=[],E=0,S=0,x="";E<h.length;E++){var k=h[E],I=k==="\\",$=h[E-1]==="\\"||I;if(ae[k]&&!$){x+=ae[k];var N=new RegExp(x).exec(i);N&&(w=!0)&&b[k!=="Y"?"push":"unshift"]({fn:zt[k],val:N[++S]})}else I||(x+=".")}f=!e||!e.noCalendar?new Date(new Date().getFullYear(),0,1,0,0,0,0):new Date(new Date().setHours(0,0,0,0)),b.forEach(function(te){var ne=te.fn,he=te.val;return f=ne(f,he,g)||f}),f=w?f:void 0}}if(!(f instanceof Date&&!isNaN(f.getTime()))){e.errorHandler(new Error("Invalid date provided: "+p));return}return l===!0&&f.setHours(0,0,0,0),f}}};function K(r,t,e){return e===void 0&&(e=!0),e!==!1?new Date(r.getTime()).setHours(0,0,0,0)-new Date(t.getTime()).setHours(0,0,0,0):r.getTime()-t.getTime()}var Kt=function(r,t,e){return r>Math.min(t,e)&&r<Math.max(t,e)},Ze=function(r,t,e){return r*3600+t*60+e},Qt=function(r){var t=Math.floor(r/3600),e=(r-t*3600)/60;return[t,e,r-t*3600-e*60]},Ut={DAY:864e5};function et(r){var t=r.defaultHour,e=r.defaultMinute,n=r.defaultSeconds;if(r.minDate!==void 0){var a=r.minDate.getHours(),i=r.minDate.getMinutes(),c=r.minDate.getSeconds();t<a&&(t=a),t===a&&e<i&&(e=i),t===a&&e===i&&n<c&&(n=r.minDate.getSeconds())}if(r.maxDate!==void 0){var l=r.maxDate.getHours(),d=r.maxDate.getMinutes();t=Math.min(t,l),t===l&&(e=Math.min(d,e)),t===l&&e===d&&(n=r.maxDate.getSeconds())}return{hours:t,minutes:e,seconds:n}}typeof Object.assign!="function"&&(Object.assign=function(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];if(!r)throw TypeError("Cannot convert undefined or null to object");for(var n=function(l){l&&Object.keys(l).forEach(function(d){return r[d]=l[d]})},a=0,i=t;a<i.length;a++){var c=i[a];n(c)}return r});var q=function(){return q=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(r[a]=t[a])}return r},q.apply(this,arguments)},Xt=function(){for(var r=0,t=0,e=arguments.length;t<e;t++)r+=arguments[t].length;for(var n=Array(r),a=0,t=0;t<e;t++)for(var i=arguments[t],c=0,l=i.length;c<l;c++,a++)n[a]=i[c];return n},fr=300;function pr(r,t){var e={config:q(q({},le),W.defaultConfig),l10n:Qe};e.parseDate=Xe({config:e.config,l10n:e.l10n}),e._handlers=[],e.pluginElements=[],e.loadedPlugins=[],e._bind=b,e._setHoursFromDate=h,e._positionCalendar=He,e.changeMonth=mt,e.changeYear=je,e.clear=Ln,e.close=Nn,e.onMouseOver=Ye,e._createElement=P,e.createDay=N,e.destroy=jn,e.isEnabled=ue,e.jumpToDate=x,e.updateValue=re,e.open=Hn,e.redraw=$t,e.set=$n,e.setDate=Vn,e.toggle=Gn;function n(){e.utils={getDaysInMonth:function(o,s){return o===void 0&&(o=e.currentMonth),s===void 0&&(s=e.currentYear),o===1&&(s%4===0&&s%100!==0||s%400===0)?29:e.l10n.daysInMonth[o]}}}function a(){e.element=e.input=r,e.isOpen=!1,Rn(),Wt(),Jn(),Bn(),n(),e.isMobile||$(),S(),(e.selectedDates.length||e.config.noCalendar)&&(e.config.enableTime&&h(e.config.noCalendar?e.latestSelectedDateObj:void 0),re(!1)),l();var o=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!e.isMobile&&o&&He(),A("onReady")}function i(){var o;return((o=e.calendarContainer)===null||o===void 0?void 0:o.getRootNode()).activeElement||document.activeElement}function c(o){return o.bind(e)}function l(){var o=e.config;o.weekNumbers===!1&&o.showMonths===1||o.noCalendar!==!0&&window.requestAnimationFrame(function(){if(e.calendarContainer!==void 0&&(e.calendarContainer.style.visibility="hidden",e.calendarContainer.style.display="block"),e.daysContainer!==void 0){var s=(e.days.offsetWidth+1)*o.showMonths;e.daysContainer.style.width=s+"px",e.calendarContainer.style.width=s+(e.weekWrapper!==void 0?e.weekWrapper.offsetWidth:0)+"px",e.calendarContainer.style.removeProperty("visibility"),e.calendarContainer.style.removeProperty("display")}})}function d(o){if(e.selectedDates.length===0){var s=e.config.minDate===void 0||K(new Date,e.config.minDate)>=0?new Date:new Date(e.config.minDate.getTime()),u=et(e.config);s.setHours(u.hours,u.minutes,u.seconds,s.getMilliseconds()),e.selectedDates=[s],e.latestSelectedDateObj=s}o!==void 0&&o.type!=="blur"&&Qn(o);var m=e._input.value;p(),re(),e._input.value!==m&&e._debouncedChange()}function g(o,s){return o%12+12*G(s===e.l10n.amPM[1])}function f(o){switch(o%24){case 0:case 12:return 12;default:return o%12}}function p(){if(!(e.hourElement===void 0||e.minuteElement===void 0)){var o=(parseInt(e.hourElement.value.slice(-2),10)||0)%24,s=(parseInt(e.minuteElement.value,10)||0)%60,u=e.secondElement!==void 0?(parseInt(e.secondElement.value,10)||0)%60:0;e.amPM!==void 0&&(o=g(o,e.amPM.textContent));var m=e.config.minTime!==void 0||e.config.minDate&&e.minDateHasTime&&e.latestSelectedDateObj&&K(e.latestSelectedDateObj,e.config.minDate,!0)===0,v=e.config.maxTime!==void 0||e.config.maxDate&&e.maxDateHasTime&&e.latestSelectedDateObj&&K(e.latestSelectedDateObj,e.config.maxDate,!0)===0;if(e.config.maxTime!==void 0&&e.config.minTime!==void 0&&e.config.minTime>e.config.maxTime){var D=Ze(e.config.minTime.getHours(),e.config.minTime.getMinutes(),e.config.minTime.getSeconds()),F=Ze(e.config.maxTime.getHours(),e.config.maxTime.getMinutes(),e.config.maxTime.getSeconds()),M=Ze(o,s,u);if(M>F&&M<D){var O=Qt(D);o=O[0],s=O[1],u=O[2]}}else{if(v){var C=e.config.maxTime!==void 0?e.config.maxTime:e.config.maxDate;o=Math.min(o,C.getHours()),o===C.getHours()&&(s=Math.min(s,C.getMinutes())),s===C.getMinutes()&&(u=Math.min(u,C.getSeconds()))}if(m){var T=e.config.minTime!==void 0?e.config.minTime:e.config.minDate;o=Math.max(o,T.getHours()),o===T.getHours()&&s<T.getMinutes()&&(s=T.getMinutes()),s===T.getMinutes()&&(u=Math.max(u,T.getSeconds()))}}y(o,s,u)}}function h(o){var s=o||e.latestSelectedDateObj;s&&s instanceof Date&&y(s.getHours(),s.getMinutes(),s.getSeconds())}function y(o,s,u){e.latestSelectedDateObj!==void 0&&e.latestSelectedDateObj.setHours(o%24,s,u||0,0),!(!e.hourElement||!e.minuteElement||e.isMobile)&&(e.hourElement.value=B(e.config.time_24hr?o:(12+o)%12+12*G(o%12===0)),e.minuteElement.value=B(s),e.amPM!==void 0&&(e.amPM.textContent=e.l10n.amPM[G(o>=12)]),e.secondElement!==void 0&&(e.secondElement.value=B(u)))}function w(o){var s=z(o),u=parseInt(s.value)+(o.delta||0);(u/1e3>1||o.key==="Enter"&&!/[^\d]/.test(u.toString()))&&je(u)}function b(o,s,u,m){if(s instanceof Array)return s.forEach(function(v){return b(o,v,u,m)});if(o instanceof Array)return o.forEach(function(v){return b(v,s,u,m)});o.addEventListener(s,u,m),e._handlers.push({remove:function(){return o.removeEventListener(s,u,m)}})}function E(){A("onChange")}function S(){if(e.config.wrap&&["open","close","toggle","clear"].forEach(function(u){Array.prototype.forEach.call(e.element.querySelectorAll("[data-"+u+"]"),function(m){return b(m,"click",e[u])})}),e.isMobile){qn();return}var o=Et(Yn,50);if(e._debouncedChange=Et(E,fr),e.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&b(e.daysContainer,"mouseover",function(u){e.config.mode==="range"&&Ye(z(u))}),b(e._input,"keydown",Ht),e.calendarContainer!==void 0&&b(e.calendarContainer,"keydown",Ht),!e.config.inline&&!e.config.static&&b(window,"resize",o),window.ontouchstart!==void 0?b(window.document,"touchstart",ht):b(window.document,"mousedown",ht),b(window.document,"focus",ht,{capture:!0}),e.config.clickOpens===!0&&(b(e._input,"focus",e.open),b(e._input,"click",e.open)),e.daysContainer!==void 0&&(b(e.monthNav,"click",Kn),b(e.monthNav,["keyup","increment"],w),b(e.daysContainer,"click",Vt)),e.timeContainer!==void 0&&e.minuteElement!==void 0&&e.hourElement!==void 0){var s=function(u){return z(u).select()};b(e.timeContainer,["increment"],d),b(e.timeContainer,"blur",d,{capture:!0}),b(e.timeContainer,"click",k),b([e.hourElement,e.minuteElement],["focus","click"],s),e.secondElement!==void 0&&b(e.secondElement,"focus",function(){return e.secondElement&&e.secondElement.select()}),e.amPM!==void 0&&b(e.amPM,"click",function(u){d(u)})}e.config.allowInput&&b(e._input,"blur",An)}function x(o,s){var u=o!==void 0?e.parseDate(o):e.latestSelectedDateObj||(e.config.minDate&&e.config.minDate>e.now?e.config.minDate:e.config.maxDate&&e.config.maxDate<e.now?e.config.maxDate:e.now),m=e.currentYear,v=e.currentMonth;try{u!==void 0&&(e.currentYear=u.getFullYear(),e.currentMonth=u.getMonth())}catch(D){D.message="Invalid date supplied: "+u,e.config.errorHandler(D)}s&&e.currentYear!==m&&(A("onYearChange"),R()),s&&(e.currentYear!==m||e.currentMonth!==v)&&A("onMonthChange"),e.redraw()}function k(o){var s=z(o);~s.className.indexOf("arrow")&&I(o,s.classList.contains("arrowUp")?1:-1)}function I(o,s,u){var m=o&&z(o),v=u||m&&m.parentNode&&m.parentNode.firstChild,D=vt("increment");D.delta=s,v&&v.dispatchEvent(D)}function $(){var o=window.document.createDocumentFragment();if(e.calendarContainer=P("div","flatpickr-calendar"),e.calendarContainer.tabIndex=-1,!e.config.noCalendar){if(o.appendChild(On()),e.innerContainer=P("div","flatpickr-innerContainer"),e.config.weekNumbers){var s=Pn(),u=s.weekWrapper,m=s.weekNumbers;e.innerContainer.appendChild(u),e.weekNumbers=m,e.weekWrapper=u}e.rContainer=P("div","flatpickr-rContainer"),e.rContainer.appendChild(At()),e.daysContainer||(e.daysContainer=P("div","flatpickr-days"),e.daysContainer.tabIndex=-1),V(),e.rContainer.appendChild(e.daysContainer),e.innerContainer.appendChild(e.rContainer),o.appendChild(e.innerContainer)}e.config.enableTime&&o.appendChild(In()),J(e.calendarContainer,"rangeMode",e.config.mode==="range"),J(e.calendarContainer,"animate",e.config.animate===!0),J(e.calendarContainer,"multiMonth",e.config.showMonths>1),e.calendarContainer.appendChild(o);var v=e.config.appendTo!==void 0&&e.config.appendTo.nodeType!==void 0;if((e.config.inline||e.config.static)&&(e.calendarContainer.classList.add(e.config.inline?"inline":"static"),e.config.inline&&(!v&&e.element.parentNode?e.element.parentNode.insertBefore(e.calendarContainer,e._input.nextSibling):e.config.appendTo!==void 0&&e.config.appendTo.appendChild(e.calendarContainer)),e.config.static)){var D=P("div","flatpickr-wrapper");e.element.parentNode&&e.element.parentNode.insertBefore(D,e.element),D.appendChild(e.element),e.altInput&&D.appendChild(e.altInput),D.appendChild(e.calendarContainer)}!e.config.static&&!e.config.inline&&(e.config.appendTo!==void 0?e.config.appendTo:window.document.body).appendChild(e.calendarContainer)}function N(o,s,u,m){var v=ue(s,!0),D=P("span",o,s.getDate().toString());return D.dateObj=s,D.$i=m,D.setAttribute("aria-label",e.formatDate(s,e.config.ariaDateFormat)),o.indexOf("hidden")===-1&&K(s,e.now)===0&&(e.todayDateElem=D,D.classList.add("today"),D.setAttribute("aria-current","date")),v?(D.tabIndex=-1,bt(s)&&(D.classList.add("selected"),e.selectedDateElem=D,e.config.mode==="range"&&(J(D,"startRange",e.selectedDates[0]&&K(s,e.selectedDates[0],!0)===0),J(D,"endRange",e.selectedDates[1]&&K(s,e.selectedDates[1],!0)===0),o==="nextMonthDay"&&D.classList.add("inRange")))):D.classList.add("flatpickr-disabled"),e.config.mode==="range"&&zn(s)&&!bt(s)&&D.classList.add("inRange"),e.weekNumbers&&e.config.showMonths===1&&o!=="prevMonthDay"&&m%7===6&&e.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+e.config.getWeek(s)+"</span>"),A("onDayCreate",D),D}function te(o){o.focus(),e.config.mode==="range"&&Ye(o)}function ne(o){for(var s=o>0?0:e.config.showMonths-1,u=o>0?e.config.showMonths:-1,m=s;m!=u;m+=o)for(var v=e.daysContainer.children[m],D=o>0?0:v.children.length-1,F=o>0?v.children.length:-1,M=D;M!=F;M+=o){var O=v.children[M];if(O.className.indexOf("hidden")===-1&&ue(O.dateObj))return O}}function he(o,s){for(var u=o.className.indexOf("Month")===-1?o.dateObj.getMonth():e.currentMonth,m=s>0?e.config.showMonths:-1,v=s>0?1:-1,D=u-e.currentMonth;D!=m;D+=v)for(var F=e.daysContainer.children[D],M=u-e.currentMonth===D?o.$i+s:s<0?F.children.length-1:0,O=F.children.length,C=M;C>=0&&C<O&&C!=(s>0?O:-1);C+=v){var T=F.children[C];if(T.className.indexOf("hidden")===-1&&ue(T.dateObj)&&Math.abs(o.$i-C)>=Math.abs(s))return te(T)}e.changeMonth(v),se(ne(v),0)}function se(o,s){var u=i(),m=Ae(u||document.body),v=o!==void 0?o:m?u:e.selectedDateElem!==void 0&&Ae(e.selectedDateElem)?e.selectedDateElem:e.todayDateElem!==void 0&&Ae(e.todayDateElem)?e.todayDateElem:ne(s>0?1:-1);v===void 0?e._input.focus():m?he(v,s):te(v)}function Ne(o,s){for(var u=(new Date(o,s,1).getDay()-e.l10n.firstDayOfWeek+7)%7,m=e.utils.getDaysInMonth((s-1+12)%12,o),v=e.utils.getDaysInMonth(s,o),D=window.document.createDocumentFragment(),F=e.config.showMonths>1,M=F?"prevMonthDay hidden":"prevMonthDay",O=F?"nextMonthDay hidden":"nextMonthDay",C=m+1-u,T=0;C<=m;C++,T++)D.appendChild(N("flatpickr-day "+M,new Date(o,s-1,C),C,T));for(C=1;C<=v;C++,T++)D.appendChild(N("flatpickr-day",new Date(o,s,C),C,T));for(var j=v+1;j<=42-u&&(e.config.showMonths===1||T%7!==0);j++,T++)D.appendChild(N("flatpickr-day "+O,new Date(o,s+1,j%v),j,T));var Z=P("div","dayContainer");return Z.appendChild(D),Z}function V(){if(e.daysContainer!==void 0){ke(e.daysContainer),e.weekNumbers&&ke(e.weekNumbers);for(var o=document.createDocumentFragment(),s=0;s<e.config.showMonths;s++){var u=new Date(e.currentYear,e.currentMonth,1);u.setMonth(e.currentMonth+s),o.appendChild(Ne(u.getFullYear(),u.getMonth()))}e.daysContainer.appendChild(o),e.days=e.daysContainer.firstChild,e.config.mode==="range"&&e.selectedDates.length===1&&Ye()}}function R(){if(!(e.config.showMonths>1||e.config.monthSelectorType!=="dropdown")){var o=function(m){return e.config.minDate!==void 0&&e.currentYear===e.config.minDate.getFullYear()&&m<e.config.minDate.getMonth()?!1:!(e.config.maxDate!==void 0&&e.currentYear===e.config.maxDate.getFullYear()&&m>e.config.maxDate.getMonth())};e.monthsDropdownContainer.tabIndex=-1,e.monthsDropdownContainer.innerHTML="";for(var s=0;s<12;s++)if(o(s)){var u=P("option","flatpickr-monthDropdown-month");u.value=new Date(e.currentYear,s).getMonth().toString(),u.textContent=Se(s,e.config.shorthandCurrentMonth,e.l10n),u.tabIndex=-1,e.currentMonth===s&&(u.selected=!0),e.monthsDropdownContainer.appendChild(u)}}}function Me(){var o=P("div","flatpickr-month"),s=window.document.createDocumentFragment(),u;e.config.showMonths>1||e.config.monthSelectorType==="static"?u=P("span","cur-month"):(e.monthsDropdownContainer=P("select","flatpickr-monthDropdown-months"),e.monthsDropdownContainer.setAttribute("aria-label",e.l10n.monthAriaLabel),b(e.monthsDropdownContainer,"change",function(F){var M=z(F),O=parseInt(M.value,10);e.changeMonth(O-e.currentMonth),A("onMonthChange")}),R(),u=e.monthsDropdownContainer);var m=Fe("cur-year",{tabindex:"-1"}),v=m.getElementsByTagName("input")[0];v.setAttribute("aria-label",e.l10n.yearAriaLabel),e.config.minDate&&v.setAttribute("min",e.config.minDate.getFullYear().toString()),e.config.maxDate&&(v.setAttribute("max",e.config.maxDate.getFullYear().toString()),v.disabled=!!e.config.minDate&&e.config.minDate.getFullYear()===e.config.maxDate.getFullYear());var D=P("div","flatpickr-current-month");return D.appendChild(u),D.appendChild(m),s.appendChild(D),o.appendChild(s),{container:o,yearElement:v,monthElement:u}}function jt(){ke(e.monthNav),e.monthNav.appendChild(e.prevMonthNav),e.config.showMonths&&(e.yearElements=[],e.monthElements=[]);for(var o=e.config.showMonths;o--;){var s=Me();e.yearElements.push(s.yearElement),e.monthElements.push(s.monthElement),e.monthNav.appendChild(s.container)}e.monthNav.appendChild(e.nextMonthNav)}function On(){return e.monthNav=P("div","flatpickr-months"),e.yearElements=[],e.monthElements=[],e.prevMonthNav=P("span","flatpickr-prev-month"),e.prevMonthNav.innerHTML=e.config.prevArrow,e.nextMonthNav=P("span","flatpickr-next-month"),e.nextMonthNav.innerHTML=e.config.nextArrow,jt(),Object.defineProperty(e,"_hidePrevMonthArrow",{get:function(){return e.__hidePrevMonthArrow},set:function(o){e.__hidePrevMonthArrow!==o&&(J(e.prevMonthNav,"flatpickr-disabled",o),e.__hidePrevMonthArrow=o)}}),Object.defineProperty(e,"_hideNextMonthArrow",{get:function(){return e.__hideNextMonthArrow},set:function(o){e.__hideNextMonthArrow!==o&&(J(e.nextMonthNav,"flatpickr-disabled",o),e.__hideNextMonthArrow=o)}}),e.currentYearElement=e.yearElements[0],_e(),e.monthNav}function In(){e.calendarContainer.classList.add("hasTime"),e.config.noCalendar&&e.calendarContainer.classList.add("noCalendar");var o=et(e.config);e.timeContainer=P("div","flatpickr-time"),e.timeContainer.tabIndex=-1;var s=P("span","flatpickr-time-separator",":"),u=Fe("flatpickr-hour",{"aria-label":e.l10n.hourAriaLabel});e.hourElement=u.getElementsByTagName("input")[0];var m=Fe("flatpickr-minute",{"aria-label":e.l10n.minuteAriaLabel});if(e.minuteElement=m.getElementsByTagName("input")[0],e.hourElement.tabIndex=e.minuteElement.tabIndex=-1,e.hourElement.value=B(e.latestSelectedDateObj?e.latestSelectedDateObj.getHours():e.config.time_24hr?o.hours:f(o.hours)),e.minuteElement.value=B(e.latestSelectedDateObj?e.latestSelectedDateObj.getMinutes():o.minutes),e.hourElement.setAttribute("step",e.config.hourIncrement.toString()),e.minuteElement.setAttribute("step",e.config.minuteIncrement.toString()),e.hourElement.setAttribute("min",e.config.time_24hr?"0":"1"),e.hourElement.setAttribute("max",e.config.time_24hr?"23":"12"),e.hourElement.setAttribute("maxlength","2"),e.minuteElement.setAttribute("min","0"),e.minuteElement.setAttribute("max","59"),e.minuteElement.setAttribute("maxlength","2"),e.timeContainer.appendChild(u),e.timeContainer.appendChild(s),e.timeContainer.appendChild(m),e.config.time_24hr&&e.timeContainer.classList.add("time24hr"),e.config.enableSeconds){e.timeContainer.classList.add("hasSeconds");var v=Fe("flatpickr-second");e.secondElement=v.getElementsByTagName("input")[0],e.secondElement.value=B(e.latestSelectedDateObj?e.latestSelectedDateObj.getSeconds():o.seconds),e.secondElement.setAttribute("step",e.minuteElement.getAttribute("step")),e.secondElement.setAttribute("min","0"),e.secondElement.setAttribute("max","59"),e.secondElement.setAttribute("maxlength","2"),e.timeContainer.appendChild(P("span","flatpickr-time-separator",":")),e.timeContainer.appendChild(v)}return e.config.time_24hr||(e.amPM=P("span","flatpickr-am-pm",e.l10n.amPM[G((e.latestSelectedDateObj?e.hourElement.value:e.config.defaultHour)>11)]),e.amPM.title=e.l10n.toggleTitle,e.amPM.tabIndex=-1,e.timeContainer.appendChild(e.amPM)),e.timeContainer}function At(){e.weekdayContainer?ke(e.weekdayContainer):e.weekdayContainer=P("div","flatpickr-weekdays");for(var o=e.config.showMonths;o--;){var s=P("div","flatpickr-weekdaycontainer");e.weekdayContainer.appendChild(s)}return Yt(),e.weekdayContainer}function Yt(){if(e.weekdayContainer){var o=e.l10n.firstDayOfWeek,s=Xt(e.l10n.weekdays.shorthand);o>0&&o<s.length&&(s=Xt(s.splice(o,s.length),s.splice(0,o)));for(var u=e.config.showMonths;u--;)e.weekdayContainer.children[u].innerHTML=`
      <span class='flatpickr-weekday'>
        `+s.join("</span><span class='flatpickr-weekday'>")+`
      </span>
      `}}function Pn(){e.calendarContainer.classList.add("hasWeeks");var o=P("div","flatpickr-weekwrapper");o.appendChild(P("span","flatpickr-weekday",e.l10n.weekAbbreviation));var s=P("div","flatpickr-weeks");return o.appendChild(s),{weekWrapper:o,weekNumbers:s}}function mt(o,s){s===void 0&&(s=!0);var u=s?o:o-e.currentMonth;u<0&&e._hidePrevMonthArrow===!0||u>0&&e._hideNextMonthArrow===!0||(e.currentMonth+=u,(e.currentMonth<0||e.currentMonth>11)&&(e.currentYear+=e.currentMonth>11?1:-1,e.currentMonth=(e.currentMonth+12)%12,A("onYearChange"),R()),V(),A("onMonthChange"),_e())}function Ln(o,s){if(o===void 0&&(o=!0),s===void 0&&(s=!0),e.input.value="",e.altInput!==void 0&&(e.altInput.value=""),e.mobileInput!==void 0&&(e.mobileInput.value=""),e.selectedDates=[],e.latestSelectedDateObj=void 0,s===!0&&(e.currentYear=e._initialDate.getFullYear(),e.currentMonth=e._initialDate.getMonth()),e.config.enableTime===!0){var u=et(e.config),m=u.hours,v=u.minutes,D=u.seconds;y(m,v,D)}e.redraw(),o&&A("onChange")}function Nn(){e.isOpen=!1,e.isMobile||(e.calendarContainer!==void 0&&e.calendarContainer.classList.remove("open"),e._input!==void 0&&e._input.classList.remove("active")),A("onClose")}function jn(){e.config!==void 0&&A("onDestroy");for(var o=e._handlers.length;o--;)e._handlers[o].remove();if(e._handlers=[],e.mobileInput)e.mobileInput.parentNode&&e.mobileInput.parentNode.removeChild(e.mobileInput),e.mobileInput=void 0;else if(e.calendarContainer&&e.calendarContainer.parentNode)if(e.config.static&&e.calendarContainer.parentNode){var s=e.calendarContainer.parentNode;if(s.lastChild&&s.removeChild(s.lastChild),s.parentNode){for(;s.firstChild;)s.parentNode.insertBefore(s.firstChild,s);s.parentNode.removeChild(s)}}else e.calendarContainer.parentNode.removeChild(e.calendarContainer);e.altInput&&(e.input.type="text",e.altInput.parentNode&&e.altInput.parentNode.removeChild(e.altInput),delete e.altInput),e.input&&(e.input.type=e.input._type,e.input.classList.remove("flatpickr-input"),e.input.removeAttribute("readonly")),["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach(function(u){try{delete e[u]}catch(m){}})}function xe(o){return e.calendarContainer.contains(o)}function ht(o){if(e.isOpen&&!e.config.inline){var s=z(o),u=xe(s),m=s===e.input||s===e.altInput||e.element.contains(s)||o.path&&o.path.indexOf&&(~o.path.indexOf(e.input)||~o.path.indexOf(e.altInput)),v=!m&&!u&&!xe(o.relatedTarget),D=!e.config.ignoredFocusElements.some(function(F){return F.contains(s)});v&&D&&(e.config.allowInput&&e.setDate(e._input.value,!1,e.config.altInput?e.config.altFormat:e.config.dateFormat),e.timeContainer!==void 0&&e.minuteElement!==void 0&&e.hourElement!==void 0&&e.input.value!==""&&e.input.value!==void 0&&d(),e.close(),e.config&&e.config.mode==="range"&&e.selectedDates.length===1&&e.clear(!1))}}function je(o){if(!(!o||e.config.minDate&&o<e.config.minDate.getFullYear()||e.config.maxDate&&o>e.config.maxDate.getFullYear())){var s=o,u=e.currentYear!==s;e.currentYear=s||e.currentYear,e.config.maxDate&&e.currentYear===e.config.maxDate.getFullYear()?e.currentMonth=Math.min(e.config.maxDate.getMonth(),e.currentMonth):e.config.minDate&&e.currentYear===e.config.minDate.getFullYear()&&(e.currentMonth=Math.max(e.config.minDate.getMonth(),e.currentMonth)),u&&(e.redraw(),A("onYearChange"),R())}}function ue(o,s){var u;s===void 0&&(s=!0);var m=e.parseDate(o,void 0,s);if(e.config.minDate&&m&&K(m,e.config.minDate,s!==void 0?s:!e.minDateHasTime)<0||e.config.maxDate&&m&&K(m,e.config.maxDate,s!==void 0?s:!e.maxDateHasTime)>0)return!1;if(!e.config.enable&&e.config.disable.length===0)return!0;if(m===void 0)return!1;for(var v=!!e.config.enable,D=(u=e.config.enable)!==null&&u!==void 0?u:e.config.disable,F=0,M=void 0;F<D.length;F++){if(M=D[F],typeof M=="function"&&M(m))return v;if(M instanceof Date&&m!==void 0&&M.getTime()===m.getTime())return v;if(typeof M=="string"){var O=e.parseDate(M,void 0,!0);return O&&O.getTime()===m.getTime()?v:!v}else if(typeof M=="object"&&m!==void 0&&M.from&&M.to&&m.getTime()>=M.from.getTime()&&m.getTime()<=M.to.getTime())return v}return!v}function Ae(o){return e.daysContainer!==void 0?o.className.indexOf("hidden")===-1&&o.className.indexOf("flatpickr-disabled")===-1&&e.daysContainer.contains(o):!1}function An(o){var s=o.target===e._input,u=e._input.value.trimEnd()!==wt();s&&u&&!(o.relatedTarget&&xe(o.relatedTarget))&&e.setDate(e._input.value,!0,o.target===e.altInput?e.config.altFormat:e.config.dateFormat)}function Ht(o){var s=z(o),u=e.config.wrap?r.contains(s):s===e._input,m=e.config.allowInput,v=e.isOpen&&(!m||!u),D=e.config.inline&&u&&!m;if(o.keyCode===13&&u){if(m)return e.setDate(e._input.value,!0,s===e.altInput?e.config.altFormat:e.config.dateFormat),e.close(),s.blur();e.open()}else if(xe(s)||v||D){var F=!!e.timeContainer&&e.timeContainer.contains(s);switch(o.keyCode){case 13:F?(o.preventDefault(),d(),gt()):Vt(o);break;case 27:o.preventDefault(),gt();break;case 8:case 46:u&&!e.config.allowInput&&(o.preventDefault(),e.clear());break;case 37:case 39:if(!F&&!u){o.preventDefault();var M=i();if(e.daysContainer!==void 0&&(m===!1||M&&Ae(M))){var O=o.keyCode===39?1:-1;o.ctrlKey?(o.stopPropagation(),mt(O),se(ne(1),0)):se(void 0,O)}}else e.hourElement&&e.hourElement.focus();break;case 38:case 40:o.preventDefault();var C=o.keyCode===40?1:-1;e.daysContainer&&s.$i!==void 0||s===e.input||s===e.altInput?o.ctrlKey?(o.stopPropagation(),je(e.currentYear-C),se(ne(1),0)):F||se(void 0,C*7):s===e.currentYearElement?je(e.currentYear-C):e.config.enableTime&&(!F&&e.hourElement&&e.hourElement.focus(),d(o),e._debouncedChange());break;case 9:if(F){var T=[e.hourElement,e.minuteElement,e.secondElement,e.amPM].concat(e.pluginElements).filter(function(U){return U}),j=T.indexOf(s);if(j!==-1){var Z=T[j+(o.shiftKey?-1:1)];o.preventDefault(),(Z||e._input).focus()}}else!e.config.noCalendar&&e.daysContainer&&e.daysContainer.contains(s)&&o.shiftKey&&(o.preventDefault(),e._input.focus());break;default:break}}if(e.amPM!==void 0&&s===e.amPM)switch(o.key){case e.l10n.amPM[0].charAt(0):case e.l10n.amPM[0].charAt(0).toLowerCase():e.amPM.textContent=e.l10n.amPM[0],p(),re();break;case e.l10n.amPM[1].charAt(0):case e.l10n.amPM[1].charAt(0).toLowerCase():e.amPM.textContent=e.l10n.amPM[1],p(),re();break}(u||xe(s))&&A("onKeyDown",o)}function Ye(o,s){if(s===void 0&&(s="flatpickr-day"),!(e.selectedDates.length!==1||o&&(!o.classList.contains(s)||o.classList.contains("flatpickr-disabled")))){for(var u=o?o.dateObj.getTime():e.days.firstElementChild.dateObj.getTime(),m=e.parseDate(e.selectedDates[0],void 0,!0).getTime(),v=Math.min(u,e.selectedDates[0].getTime()),D=Math.max(u,e.selectedDates[0].getTime()),F=!1,M=0,O=0,C=v;C<D;C+=Ut.DAY)ue(new Date(C),!0)||(F=F||C>v&&C<D,C<m&&(!M||C>M)?M=C:C>m&&(!O||C<O)&&(O=C));var T=Array.from(e.rContainer.querySelectorAll("*:nth-child(-n+"+e.config.showMonths+") > ."+s));T.forEach(function(j){var Z=j.dateObj,U=Z.getTime(),Te=M>0&&U<M||O>0&&U>O;if(Te){j.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach(function(ge){j.classList.remove(ge)});return}else if(F&&!Te)return;["startRange","inRange","endRange","notAllowed"].forEach(function(ge){j.classList.remove(ge)}),o!==void 0&&(o.classList.add(u<=e.selectedDates[0].getTime()?"startRange":"endRange"),m<u&&U===m?j.classList.add("startRange"):m>u&&U===m&&j.classList.add("endRange"),U>=M&&(O===0||U<=O)&&Kt(U,m,u)&&j.classList.add("inRange"))})}}function Yn(){e.isOpen&&!e.config.static&&!e.config.inline&&He()}function Hn(o,s){if(s===void 0&&(s=e._positionElement),e.isMobile===!0){if(o){o.preventDefault();var u=z(o);u&&u.blur()}e.mobileInput!==void 0&&(e.mobileInput.focus(),e.mobileInput.click()),A("onOpen");return}else if(e._input.disabled||e.config.inline)return;var m=e.isOpen;e.isOpen=!0,m||(e.calendarContainer.classList.add("open"),e._input.classList.add("active"),A("onOpen"),He(s)),e.config.enableTime===!0&&e.config.noCalendar===!0&&e.config.allowInput===!1&&(o===void 0||!e.timeContainer.contains(o.relatedTarget))&&setTimeout(function(){return e.hourElement.select()},50)}function Rt(o){return function(s){var u=e.config["_"+o+"Date"]=e.parseDate(s,e.config.dateFormat),m=e.config["_"+(o==="min"?"max":"min")+"Date"];u!==void 0&&(e[o==="min"?"minDateHasTime":"maxDateHasTime"]=u.getHours()>0||u.getMinutes()>0||u.getSeconds()>0),e.selectedDates&&(e.selectedDates=e.selectedDates.filter(function(v){return ue(v)}),!e.selectedDates.length&&o==="min"&&h(u),re()),e.daysContainer&&($t(),u!==void 0?e.currentYearElement[o]=u.getFullYear().toString():e.currentYearElement.removeAttribute(o),e.currentYearElement.disabled=!!m&&u!==void 0&&m.getFullYear()===u.getFullYear())}}function Rn(){var o=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],s=q(q({},JSON.parse(JSON.stringify(r.dataset||{}))),t),u={};e.config.parseDate=s.parseDate,e.config.formatDate=s.formatDate,Object.defineProperty(e.config,"enable",{get:function(){return e.config._enable},set:function(T){e.config._enable=Jt(T)}}),Object.defineProperty(e.config,"disable",{get:function(){return e.config._disable},set:function(T){e.config._disable=Jt(T)}});var m=s.mode==="time";if(!s.dateFormat&&(s.enableTime||m)){var v=W.defaultConfig.dateFormat||le.dateFormat;u.dateFormat=s.noCalendar||m?"H:i"+(s.enableSeconds?":S":""):v+" H:i"+(s.enableSeconds?":S":"")}if(s.altInput&&(s.enableTime||m)&&!s.altFormat){var D=W.defaultConfig.altFormat||le.altFormat;u.altFormat=s.noCalendar||m?"h:i"+(s.enableSeconds?":S K":" K"):D+(" h:i"+(s.enableSeconds?":S":"")+" K")}Object.defineProperty(e.config,"minDate",{get:function(){return e.config._minDate},set:Rt("min")}),Object.defineProperty(e.config,"maxDate",{get:function(){return e.config._maxDate},set:Rt("max")});var F=function(T){return function(j){e.config[T==="min"?"_minTime":"_maxTime"]=e.parseDate(j,"H:i:S")}};Object.defineProperty(e.config,"minTime",{get:function(){return e.config._minTime},set:F("min")}),Object.defineProperty(e.config,"maxTime",{get:function(){return e.config._maxTime},set:F("max")}),s.mode==="time"&&(e.config.noCalendar=!0,e.config.enableTime=!0),Object.assign(e.config,u,s);for(var M=0;M<o.length;M++)e.config[o[M]]=e.config[o[M]]===!0||e.config[o[M]]==="true";ze.filter(function(T){return e.config[T]!==void 0}).forEach(function(T){e.config[T]=Ue(e.config[T]||[]).map(c)}),e.isMobile=!e.config.disableMobile&&!e.config.inline&&e.config.mode==="single"&&!e.config.disable.length&&!e.config.enable&&!e.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(var M=0;M<e.config.plugins.length;M++){var O=e.config.plugins[M](e)||{};for(var C in O)ze.indexOf(C)>-1?e.config[C]=Ue(O[C]).map(c).concat(e.config[C]):typeof s[C]=="undefined"&&(e.config[C]=O[C])}s.altInputClass||(e.config.altInputClass=_t().className+" "+e.config.altInputClass),A("onParseConfig")}function _t(){return e.config.wrap?r.querySelector("[data-input]"):r}function Wt(){typeof e.config.locale!="object"&&typeof W.l10ns[e.config.locale]=="undefined"&&e.config.errorHandler(new Error("flatpickr: invalid locale "+e.config.locale)),e.l10n=q(q({},W.l10ns.default),typeof e.config.locale=="object"?e.config.locale:e.config.locale!=="default"?W.l10ns[e.config.locale]:void 0),ae.D="("+e.l10n.weekdays.shorthand.join("|")+")",ae.l="("+e.l10n.weekdays.longhand.join("|")+")",ae.M="("+e.l10n.months.shorthand.join("|")+")",ae.F="("+e.l10n.months.longhand.join("|")+")",ae.K="("+e.l10n.amPM[0]+"|"+e.l10n.amPM[1]+"|"+e.l10n.amPM[0].toLowerCase()+"|"+e.l10n.amPM[1].toLowerCase()+")";var o=q(q({},t),JSON.parse(JSON.stringify(r.dataset||{})));o.time_24hr===void 0&&W.defaultConfig.time_24hr===void 0&&(e.config.time_24hr=e.l10n.time_24hr),e.formatDate=xt(e),e.parseDate=Xe({config:e.config,l10n:e.l10n})}function He(o){if(typeof e.config.position=="function")return void e.config.position(e,o);if(e.calendarContainer!==void 0){A("onPreCalendarPosition");var s=o||e._positionElement,u=Array.prototype.reduce.call(e.calendarContainer.children,(function(ar,ir){return ar+ir.offsetHeight}),0),m=e.calendarContainer.offsetWidth,v=e.config.position.split(" "),D=v[0],F=v.length>1?v[1]:null,M=s.getBoundingClientRect(),O=window.innerHeight-M.bottom,C=D==="above"||D!=="below"&&O<u&&M.top>u,T=window.pageYOffset+M.top+(C?-u-2:s.offsetHeight+2);if(J(e.calendarContainer,"arrowTop",!C),J(e.calendarContainer,"arrowBottom",C),!e.config.inline){var j=window.pageXOffset+M.left,Z=!1,U=!1;F==="center"?(j-=(m-M.width)/2,Z=!0):F==="right"&&(j-=m-M.width,U=!0),J(e.calendarContainer,"arrowLeft",!Z&&!U),J(e.calendarContainer,"arrowCenter",Z),J(e.calendarContainer,"arrowRight",U);var Te=window.document.body.offsetWidth-(window.pageXOffset+M.right),ge=j+m>window.document.body.offsetWidth,Un=Te+m>window.document.body.offsetWidth;if(J(e.calendarContainer,"rightMost",ge),!e.config.static)if(e.calendarContainer.style.top=T+"px",!ge)e.calendarContainer.style.left=j+"px",e.calendarContainer.style.right="auto";else if(!Un)e.calendarContainer.style.left="auto",e.calendarContainer.style.right=Te+"px";else{var yt=_n();if(yt===void 0)return;var Xn=window.document.body.offsetWidth,Zn=Math.max(0,Xn/2-m/2),er=".flatpickr-calendar.centerMost:before",tr=".flatpickr-calendar.centerMost:after",nr=yt.cssRules.length,rr="{left:"+M.left+"px;right:auto;}";J(e.calendarContainer,"rightMost",!1),J(e.calendarContainer,"centerMost",!0),yt.insertRule(er+","+tr+rr,nr),e.calendarContainer.style.left=Zn+"px",e.calendarContainer.style.right="auto"}}}}function _n(){for(var o=null,s=0;s<document.styleSheets.length;s++){var u=document.styleSheets[s];if(u.cssRules){try{u.cssRules}catch(m){continue}o=u;break}}return o!=null?o:Wn()}function Wn(){var o=document.createElement("style");return document.head.appendChild(o),o.sheet}function $t(){e.config.noCalendar||e.isMobile||(R(),_e(),V())}function gt(){e._input.focus(),window.navigator.userAgent.indexOf("MSIE")!==-1||navigator.msMaxTouchPoints!==void 0?setTimeout(e.close,0):e.close()}function Vt(o){o.preventDefault(),o.stopPropagation();var s=function(T){return T.classList&&T.classList.contains("flatpickr-day")&&!T.classList.contains("flatpickr-disabled")&&!T.classList.contains("notAllowed")},u=Ct(z(o),s);if(u!==void 0){var m=u,v=e.latestSelectedDateObj=new Date(m.dateObj.getTime()),D=(v.getMonth()<e.currentMonth||v.getMonth()>e.currentMonth+e.config.showMonths-1)&&e.config.mode!=="range";if(e.selectedDateElem=m,e.config.mode==="single")e.selectedDates=[v];else if(e.config.mode==="multiple"){var F=bt(v);F?e.selectedDates.splice(parseInt(F),1):e.selectedDates.push(v)}else e.config.mode==="range"&&(e.selectedDates.length===2&&e.clear(!1,!1),e.latestSelectedDateObj=v,e.selectedDates.push(v),K(v,e.selectedDates[0],!0)!==0&&e.selectedDates.sort(function(T,j){return T.getTime()-j.getTime()}));if(p(),D){var M=e.currentYear!==v.getFullYear();e.currentYear=v.getFullYear(),e.currentMonth=v.getMonth(),M&&(A("onYearChange"),R()),A("onMonthChange")}if(_e(),V(),re(),!D&&e.config.mode!=="range"&&e.config.showMonths===1?te(m):e.selectedDateElem!==void 0&&e.hourElement===void 0&&e.selectedDateElem&&e.selectedDateElem.focus(),e.hourElement!==void 0&&e.hourElement!==void 0&&e.hourElement.focus(),e.config.closeOnSelect){var O=e.config.mode==="single"&&!e.config.enableTime,C=e.config.mode==="range"&&e.selectedDates.length===2&&!e.config.enableTime;(O||C)&&gt()}E()}}var Re={locale:[Wt,Yt],showMonths:[jt,l,At],minDate:[x],maxDate:[x],positionElement:[qt],clickOpens:[function(){e.config.clickOpens===!0?(b(e._input,"focus",e.open),b(e._input,"click",e.open)):(e._input.removeEventListener("focus",e.open),e._input.removeEventListener("click",e.open))}]};function $n(o,s){if(o!==null&&typeof o=="object"){Object.assign(e.config,o);for(var u in o)Re[u]!==void 0&&Re[u].forEach(function(m){return m()})}else e.config[o]=s,Re[o]!==void 0?Re[o].forEach(function(m){return m()}):ze.indexOf(o)>-1&&(e.config[o]=Ue(s));e.redraw(),re(!0)}function Bt(o,s){var u=[];if(o instanceof Array)u=o.map(function(m){return e.parseDate(m,s)});else if(o instanceof Date||typeof o=="number")u=[e.parseDate(o,s)];else if(typeof o=="string")switch(e.config.mode){case"single":case"time":u=[e.parseDate(o,s)];break;case"multiple":u=o.split(e.config.conjunction).map(function(m){return e.parseDate(m,s)});break;case"range":u=o.split(e.l10n.rangeSeparator).map(function(m){return e.parseDate(m,s)});break;default:break}else e.config.errorHandler(new Error("Invalid date supplied: "+JSON.stringify(o)));e.selectedDates=e.config.allowInvalidPreload?u:u.filter(function(m){return m instanceof Date&&ue(m,!1)}),e.config.mode==="range"&&e.selectedDates.sort(function(m,v){return m.getTime()-v.getTime()})}function Vn(o,s,u){if(s===void 0&&(s=!1),u===void 0&&(u=e.config.dateFormat),o!==0&&!o||o instanceof Array&&o.length===0)return e.clear(s);Bt(o,u),e.latestSelectedDateObj=e.selectedDates[e.selectedDates.length-1],e.redraw(),x(void 0,s),h(),e.selectedDates.length===0&&e.clear(!1),re(s),s&&A("onChange")}function Jt(o){return o.slice().map(function(s){return typeof s=="string"||typeof s=="number"||s instanceof Date?e.parseDate(s,void 0,!0):s&&typeof s=="object"&&s.from&&s.to?{from:e.parseDate(s.from,void 0),to:e.parseDate(s.to,void 0)}:s}).filter(function(s){return s})}function Bn(){e.selectedDates=[],e.now=e.parseDate(e.config.now)||new Date;var o=e.config.defaultDate||((e.input.nodeName==="INPUT"||e.input.nodeName==="TEXTAREA")&&e.input.placeholder&&e.input.value===e.input.placeholder?null:e.input.value);o&&Bt(o,e.config.dateFormat),e._initialDate=e.selectedDates.length>0?e.selectedDates[0]:e.config.minDate&&e.config.minDate.getTime()>e.now.getTime()?e.config.minDate:e.config.maxDate&&e.config.maxDate.getTime()<e.now.getTime()?e.config.maxDate:e.now,e.currentYear=e._initialDate.getFullYear(),e.currentMonth=e._initialDate.getMonth(),e.selectedDates.length>0&&(e.latestSelectedDateObj=e.selectedDates[0]),e.config.minTime!==void 0&&(e.config.minTime=e.parseDate(e.config.minTime,"H:i")),e.config.maxTime!==void 0&&(e.config.maxTime=e.parseDate(e.config.maxTime,"H:i")),e.minDateHasTime=!!e.config.minDate&&(e.config.minDate.getHours()>0||e.config.minDate.getMinutes()>0||e.config.minDate.getSeconds()>0),e.maxDateHasTime=!!e.config.maxDate&&(e.config.maxDate.getHours()>0||e.config.maxDate.getMinutes()>0||e.config.maxDate.getSeconds()>0)}function Jn(){if(e.input=_t(),!e.input){e.config.errorHandler(new Error("Invalid input element specified"));return}e.input._type=e.input.type,e.input.type="text",e.input.classList.add("flatpickr-input"),e._input=e.input,e.config.altInput&&(e.altInput=P(e.input.nodeName,e.config.altInputClass),e._input=e.altInput,e.altInput.placeholder=e.input.placeholder,e.altInput.disabled=e.input.disabled,e.altInput.required=e.input.required,e.altInput.tabIndex=e.input.tabIndex,e.altInput.type="text",e.input.setAttribute("type","hidden"),!e.config.static&&e.input.parentNode&&e.input.parentNode.insertBefore(e.altInput,e.input.nextSibling)),e.config.allowInput||e._input.setAttribute("readonly","readonly"),qt()}function qt(){e._positionElement=e.config.positionElement||e._input}function qn(){var o=e.config.enableTime?e.config.noCalendar?"time":"datetime-local":"date";e.mobileInput=P("input",e.input.className+" flatpickr-mobile"),e.mobileInput.tabIndex=1,e.mobileInput.type=o,e.mobileInput.disabled=e.input.disabled,e.mobileInput.required=e.input.required,e.mobileInput.placeholder=e.input.placeholder,e.mobileFormatStr=o==="datetime-local"?"Y-m-d\\TH:i:S":o==="date"?"Y-m-d":"H:i:S",e.selectedDates.length>0&&(e.mobileInput.defaultValue=e.mobileInput.value=e.formatDate(e.selectedDates[0],e.mobileFormatStr)),e.config.minDate&&(e.mobileInput.min=e.formatDate(e.config.minDate,"Y-m-d")),e.config.maxDate&&(e.mobileInput.max=e.formatDate(e.config.maxDate,"Y-m-d")),e.input.getAttribute("step")&&(e.mobileInput.step=String(e.input.getAttribute("step"))),e.input.type="hidden",e.altInput!==void 0&&(e.altInput.type="hidden");try{e.input.parentNode&&e.input.parentNode.insertBefore(e.mobileInput,e.input.nextSibling)}catch(s){}b(e.mobileInput,"change",function(s){e.setDate(z(s).value,!1,e.mobileFormatStr),A("onChange"),A("onClose")})}function Gn(o){if(e.isOpen===!0)return e.close();e.open(o)}function A(o,s){if(e.config!==void 0){var u=e.config[o];if(u!==void 0&&u.length>0)for(var m=0;u[m]&&m<u.length;m++)u[m](e.selectedDates,e.input.value,e,s);o==="onChange"&&(e.input.dispatchEvent(vt("change")),e.input.dispatchEvent(vt("input")))}}function vt(o){var s=document.createEvent("Event");return s.initEvent(o,!0,!0),s}function bt(o){for(var s=0;s<e.selectedDates.length;s++){var u=e.selectedDates[s];if(u instanceof Date&&K(u,o)===0)return""+s}return!1}function zn(o){return e.config.mode!=="range"||e.selectedDates.length<2?!1:K(o,e.selectedDates[0])>=0&&K(o,e.selectedDates[1])<=0}function _e(){e.config.noCalendar||e.isMobile||!e.monthNav||(e.yearElements.forEach(function(o,s){var u=new Date(e.currentYear,e.currentMonth,1);u.setMonth(e.currentMonth+s),e.config.showMonths>1||e.config.monthSelectorType==="static"?e.monthElements[s].textContent=Se(u.getMonth(),e.config.shorthandCurrentMonth,e.l10n)+" ":e.monthsDropdownContainer.value=u.getMonth().toString(),o.value=u.getFullYear().toString()}),e._hidePrevMonthArrow=e.config.minDate!==void 0&&(e.currentYear===e.config.minDate.getFullYear()?e.currentMonth<=e.config.minDate.getMonth():e.currentYear<e.config.minDate.getFullYear()),e._hideNextMonthArrow=e.config.maxDate!==void 0&&(e.currentYear===e.config.maxDate.getFullYear()?e.currentMonth+1>e.config.maxDate.getMonth():e.currentYear>e.config.maxDate.getFullYear()))}function wt(o){var s=o||(e.config.altInput?e.config.altFormat:e.config.dateFormat);return e.selectedDates.map(function(u){return e.formatDate(u,s)}).filter(function(u,m,v){return e.config.mode!=="range"||e.config.enableTime||v.indexOf(u)===m}).join(e.config.mode!=="range"?e.config.conjunction:e.l10n.rangeSeparator)}function re(o){o===void 0&&(o=!0),e.mobileInput!==void 0&&e.mobileFormatStr&&(e.mobileInput.value=e.latestSelectedDateObj!==void 0?e.formatDate(e.latestSelectedDateObj,e.mobileFormatStr):""),e.input.value=wt(e.config.dateFormat),e.altInput!==void 0&&(e.altInput.value=wt(e.config.altFormat)),o!==!1&&A("onValueUpdate")}function Kn(o){var s=z(o),u=e.prevMonthNav.contains(s),m=e.nextMonthNav.contains(s);u||m?mt(u?-1:1):e.yearElements.indexOf(s)>=0?s.select():s.classList.contains("arrowUp")?e.changeYear(e.currentYear+1):s.classList.contains("arrowDown")&&e.changeYear(e.currentYear-1)}function Qn(o){o.preventDefault();var s=o.type==="keydown",u=z(o),m=u;e.amPM!==void 0&&u===e.amPM&&(e.amPM.textContent=e.l10n.amPM[G(e.amPM.textContent===e.l10n.amPM[0])]);var v=parseFloat(m.getAttribute("min")),D=parseFloat(m.getAttribute("max")),F=parseFloat(m.getAttribute("step")),M=parseInt(m.value,10),O=o.delta||(s?o.which===38?1:-1:0),C=M+F*O;if(typeof m.value!="undefined"&&m.value.length===2){var T=m===e.hourElement,j=m===e.minuteElement;C<v?(C=D+C+G(!T)+(G(T)&&G(!e.amPM)),j&&I(void 0,-1,e.hourElement)):C>D&&(C=m===e.hourElement?C-D-G(!e.amPM):v,j&&I(void 0,1,e.hourElement)),e.amPM&&T&&(F===1?C+M===23:Math.abs(C-M)>F)&&(e.amPM.textContent=e.l10n.amPM[G(e.amPM.textContent===e.l10n.amPM[0])]),m.value=B(C)}}return a(),e}function be(r,t){for(var e=Array.prototype.slice.call(r).filter(function(c){return c instanceof HTMLElement}),n=[],a=0;a<e.length;a++){var i=e[a];try{if(i.getAttribute("data-fp-omit")!==null)continue;i._flatpickr!==void 0&&(i._flatpickr.destroy(),i._flatpickr=void 0),i._flatpickr=pr(i,t||{}),n.push(i._flatpickr)}catch(c){console.error(c)}}return n.length===1?n[0]:n}typeof HTMLElement!="undefined"&&typeof HTMLCollection!="undefined"&&typeof NodeList!="undefined"&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(r){return be(this,r)},HTMLElement.prototype.flatpickr=function(r){return be([this],r)});var W=function(r,t){return typeof r=="string"?be(window.document.querySelectorAll(r),t):r instanceof Node?be([r],t):be(r,t)};W.defaultConfig={};W.l10ns={en:q({},Qe),default:q({},Qe)};W.localize=function(r){W.l10ns.default=q(q({},W.l10ns.default),r)};W.setDefaults=function(r){W.defaultConfig=q(q({},W.defaultConfig),r)};W.parseDate=Xe({});W.formatDate=xt({});W.compareDates=K;typeof jQuery!="undefined"&&typeof jQuery.fn!="undefined"&&(jQuery.fn.flatpickr=function(r){return be(this,r)});Date.prototype.fp_incr=function(r){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+(typeof r=="string"?parseInt(r,10):r))};typeof window!="undefined"&&(window.flatpickr=W);var Zt=W;var mr=Math.pow(10,8)*24*60*60*1e3,Na=-mr,tt=6048e5,en=864e5;var hr=3600;var tn=hr*24,ja=tn*7,gr=tn*365.2425,vr=gr/12,Aa=vr*3,Tt=Symbol.for("constructDateFrom");function Q(r,t){return typeof r=="function"?r(t):r&&typeof r=="object"&&Tt in r?r[Tt](t):r instanceof Date?new r.constructor(t):new Date(t)}function H(r,t){return Q(t||r,r)}var br={};function ce(){return br}function ie(r,t){var l,d,g,f,p,h,y,w;let e=ce(),n=(w=(y=(f=(g=t==null?void 0:t.weekStartsOn)!=null?g:(d=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:d.weekStartsOn)!=null?f:e.weekStartsOn)!=null?y:(h=(p=e.locale)==null?void 0:p.options)==null?void 0:h.weekStartsOn)!=null?w:0,a=H(r,t==null?void 0:t.in),i=a.getDay(),c=(i<n?7:0)+i-n;return a.setDate(a.getDate()-c),a.setHours(0,0,0,0),a}function fe(r,t){return ie(r,{...t,weekStartsOn:1})}function nt(r,t){let e=H(r,t==null?void 0:t.in),n=e.getFullYear(),a=Q(e,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);let i=fe(a),c=Q(e,0);c.setFullYear(n,0,4),c.setHours(0,0,0,0);let l=fe(c);return e.getTime()>=i.getTime()?n+1:e.getTime()>=l.getTime()?n:n-1}function kt(r){let t=H(r),e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),+r-+e}function nn(r,...t){let e=Q.bind(null,r||t.find(n=>typeof n=="object"));return t.map(e)}function Ft(r,t){let e=H(r,t==null?void 0:t.in);return e.setHours(0,0,0,0),e}function rn(r,t,e){let[n,a]=nn(e==null?void 0:e.in,r,t),i=Ft(n),c=Ft(a),l=+i-kt(i),d=+c-kt(c);return Math.round((l-d)/en)}function an(r,t){let e=nt(r,t),n=Q((t==null?void 0:t.in)||r,0);return n.setFullYear(e,0,4),n.setHours(0,0,0,0),fe(n)}function on(r){return r instanceof Date||typeof r=="object"&&Object.prototype.toString.call(r)==="[object Date]"}function sn(r){return!(!on(r)&&typeof r!="number"||isNaN(+H(r)))}function ln(r,t){let e=H(r,t==null?void 0:t.in);return e.setFullYear(e.getFullYear(),0,1),e.setHours(0,0,0,0),e}var wr={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},cn=(r,t,e)=>{let n,a=wr[r];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),e!=null&&e.addSuffix?e.comparison&&e.comparison>0?"in "+n:n+" ago":n};function rt(r){return(t={})=>{let e=t.width?String(t.width):r.defaultWidth;return r.formats[e]||r.formats[r.defaultWidth]}}var yr={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Dr={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Er={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},dn={date:rt({formats:yr,defaultWidth:"full"}),time:rt({formats:Dr,defaultWidth:"full"}),dateTime:rt({formats:Er,defaultWidth:"full"})};var Cr={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},un=(r,t,e,n)=>Cr[r];function we(r){return(t,e)=>{let n=e!=null&&e.context?String(e.context):"standalone",a;if(n==="formatting"&&r.formattingValues){let c=r.defaultFormattingWidth||r.defaultWidth,l=e!=null&&e.width?String(e.width):c;a=r.formattingValues[l]||r.formattingValues[c]}else{let c=r.defaultWidth,l=e!=null&&e.width?String(e.width):r.defaultWidth;a=r.values[l]||r.values[c]}let i=r.argumentCallback?r.argumentCallback(t):t;return a[i]}}var Mr={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},xr={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Tr={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},kr={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Fr={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Sr={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Or=(r,t)=>{let e=Number(r),n=e%100;if(n>20||n<10)switch(n%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd"}return e+"th"},fn={ordinalNumber:Or,era:we({values:Mr,defaultWidth:"wide"}),quarter:we({values:xr,defaultWidth:"wide",argumentCallback:r=>r-1}),month:we({values:Tr,defaultWidth:"wide"}),day:we({values:kr,defaultWidth:"wide"}),dayPeriod:we({values:Fr,defaultWidth:"wide",formattingValues:Sr,defaultFormattingWidth:"wide"})};function ye(r){return(t,e={})=>{let n=e.width,a=n&&r.matchPatterns[n]||r.matchPatterns[r.defaultMatchWidth],i=t.match(a);if(!i)return null;let c=i[0],l=n&&r.parsePatterns[n]||r.parsePatterns[r.defaultParseWidth],d=Array.isArray(l)?Pr(l,p=>p.test(c)):Ir(l,p=>p.test(c)),g;g=r.valueCallback?r.valueCallback(d):d,g=e.valueCallback?e.valueCallback(g):g;let f=t.slice(c.length);return{value:g,rest:f}}}function Ir(r,t){for(let e in r)if(Object.prototype.hasOwnProperty.call(r,e)&&t(r[e]))return e}function Pr(r,t){for(let e=0;e<r.length;e++)if(t(r[e]))return e}function pn(r){return(t,e={})=>{let n=t.match(r.matchPattern);if(!n)return null;let a=n[0],i=t.match(r.parsePattern);if(!i)return null;let c=r.valueCallback?r.valueCallback(i[0]):i[0];c=e.valueCallback?e.valueCallback(c):c;let l=t.slice(a.length);return{value:c,rest:l}}}var Lr=/^(\d+)(th|st|nd|rd)?/i,Nr=/\d+/i,jr={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Ar={any:[/^b/i,/^(a|c)/i]},Yr={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Hr={any:[/1/i,/2/i,/3/i,/4/i]},Rr={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},_r={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Wr={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},$r={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Vr={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Br={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},mn={ordinalNumber:pn({matchPattern:Lr,parsePattern:Nr,valueCallback:r=>parseInt(r,10)}),era:ye({matchPatterns:jr,defaultMatchWidth:"wide",parsePatterns:Ar,defaultParseWidth:"any"}),quarter:ye({matchPatterns:Yr,defaultMatchWidth:"wide",parsePatterns:Hr,defaultParseWidth:"any",valueCallback:r=>r+1}),month:ye({matchPatterns:Rr,defaultMatchWidth:"wide",parsePatterns:_r,defaultParseWidth:"any"}),day:ye({matchPatterns:Wr,defaultMatchWidth:"wide",parsePatterns:$r,defaultParseWidth:"any"}),dayPeriod:ye({matchPatterns:Vr,defaultMatchWidth:"any",parsePatterns:Br,defaultParseWidth:"any"})};var St={code:"en-US",formatDistance:cn,formatLong:dn,formatRelative:un,localize:fn,match:mn,options:{weekStartsOn:0,firstWeekContainsDate:1}};function hn(r,t){let e=H(r,t==null?void 0:t.in);return rn(e,ln(e))+1}function gn(r,t){let e=H(r,t==null?void 0:t.in),n=+fe(e)-+an(e);return Math.round(n/tt)+1}function at(r,t){var f,p,h,y,w,b,E,S;let e=H(r,t==null?void 0:t.in),n=e.getFullYear(),a=ce(),i=(S=(E=(y=(h=t==null?void 0:t.firstWeekContainsDate)!=null?h:(p=(f=t==null?void 0:t.locale)==null?void 0:f.options)==null?void 0:p.firstWeekContainsDate)!=null?y:a.firstWeekContainsDate)!=null?E:(b=(w=a.locale)==null?void 0:w.options)==null?void 0:b.firstWeekContainsDate)!=null?S:1,c=Q((t==null?void 0:t.in)||r,0);c.setFullYear(n+1,0,i),c.setHours(0,0,0,0);let l=ie(c,t),d=Q((t==null?void 0:t.in)||r,0);d.setFullYear(n,0,i),d.setHours(0,0,0,0);let g=ie(d,t);return+e>=+l?n+1:+e>=+g?n:n-1}function vn(r,t){var l,d,g,f,p,h,y,w;let e=ce(),n=(w=(y=(f=(g=t==null?void 0:t.firstWeekContainsDate)!=null?g:(d=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:d.firstWeekContainsDate)!=null?f:e.firstWeekContainsDate)!=null?y:(h=(p=e.locale)==null?void 0:p.options)==null?void 0:h.firstWeekContainsDate)!=null?w:1,a=at(r,t),i=Q((t==null?void 0:t.in)||r,0);return i.setFullYear(a,0,n),i.setHours(0,0,0,0),ie(i,t)}function bn(r,t){let e=H(r,t==null?void 0:t.in),n=+ie(e,t)-+vn(e,t);return Math.round(n/tt)+1}function L(r,t){let e=r<0?"-":"",n=Math.abs(r).toString().padStart(t,"0");return e+n}var oe={y(r,t){let e=r.getFullYear(),n=e>0?e:1-e;return L(t==="yy"?n%100:n,t.length)},M(r,t){let e=r.getMonth();return t==="M"?String(e+1):L(e+1,2)},d(r,t){return L(r.getDate(),t.length)},a(r,t){let e=r.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return e.toUpperCase();case"aaa":return e;case"aaaaa":return e[0];case"aaaa":default:return e==="am"?"a.m.":"p.m."}},h(r,t){return L(r.getHours()%12||12,t.length)},H(r,t){return L(r.getHours(),t.length)},m(r,t){return L(r.getMinutes(),t.length)},s(r,t){return L(r.getSeconds(),t.length)},S(r,t){let e=t.length,n=r.getMilliseconds(),a=Math.trunc(n*Math.pow(10,e-3));return L(a,t.length)}};var De={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Ot={G:function(r,t,e){let n=r.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return e.era(n,{width:"abbreviated"});case"GGGGG":return e.era(n,{width:"narrow"});case"GGGG":default:return e.era(n,{width:"wide"})}},y:function(r,t,e){if(t==="yo"){let n=r.getFullYear(),a=n>0?n:1-n;return e.ordinalNumber(a,{unit:"year"})}return oe.y(r,t)},Y:function(r,t,e,n){let a=at(r,n),i=a>0?a:1-a;if(t==="YY"){let c=i%100;return L(c,2)}return t==="Yo"?e.ordinalNumber(i,{unit:"year"}):L(i,t.length)},R:function(r,t){let e=nt(r);return L(e,t.length)},u:function(r,t){let e=r.getFullYear();return L(e,t.length)},Q:function(r,t,e){let n=Math.ceil((r.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return L(n,2);case"Qo":return e.ordinalNumber(n,{unit:"quarter"});case"QQQ":return e.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return e.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return e.quarter(n,{width:"wide",context:"formatting"})}},q:function(r,t,e){let n=Math.ceil((r.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return L(n,2);case"qo":return e.ordinalNumber(n,{unit:"quarter"});case"qqq":return e.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return e.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return e.quarter(n,{width:"wide",context:"standalone"})}},M:function(r,t,e){let n=r.getMonth();switch(t){case"M":case"MM":return oe.M(r,t);case"Mo":return e.ordinalNumber(n+1,{unit:"month"});case"MMM":return e.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return e.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return e.month(n,{width:"wide",context:"formatting"})}},L:function(r,t,e){let n=r.getMonth();switch(t){case"L":return String(n+1);case"LL":return L(n+1,2);case"Lo":return e.ordinalNumber(n+1,{unit:"month"});case"LLL":return e.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return e.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return e.month(n,{width:"wide",context:"standalone"})}},w:function(r,t,e,n){let a=bn(r,n);return t==="wo"?e.ordinalNumber(a,{unit:"week"}):L(a,t.length)},I:function(r,t,e){let n=gn(r);return t==="Io"?e.ordinalNumber(n,{unit:"week"}):L(n,t.length)},d:function(r,t,e){return t==="do"?e.ordinalNumber(r.getDate(),{unit:"date"}):oe.d(r,t)},D:function(r,t,e){let n=hn(r);return t==="Do"?e.ordinalNumber(n,{unit:"dayOfYear"}):L(n,t.length)},E:function(r,t,e){let n=r.getDay();switch(t){case"E":case"EE":case"EEE":return e.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return e.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return e.day(n,{width:"short",context:"formatting"});case"EEEE":default:return e.day(n,{width:"wide",context:"formatting"})}},e:function(r,t,e,n){let a=r.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return L(i,2);case"eo":return e.ordinalNumber(i,{unit:"day"});case"eee":return e.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return e.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return e.day(a,{width:"short",context:"formatting"});case"eeee":default:return e.day(a,{width:"wide",context:"formatting"})}},c:function(r,t,e,n){let a=r.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return L(i,t.length);case"co":return e.ordinalNumber(i,{unit:"day"});case"ccc":return e.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return e.day(a,{width:"narrow",context:"standalone"});case"cccccc":return e.day(a,{width:"short",context:"standalone"});case"cccc":default:return e.day(a,{width:"wide",context:"standalone"})}},i:function(r,t,e){let n=r.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return L(a,t.length);case"io":return e.ordinalNumber(a,{unit:"day"});case"iii":return e.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return e.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return e.day(n,{width:"short",context:"formatting"});case"iiii":default:return e.day(n,{width:"wide",context:"formatting"})}},a:function(r,t,e){let a=r.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return e.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return e.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(r,t,e){let n=r.getHours(),a;switch(n===12?a=De.noon:n===0?a=De.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return e.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return e.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(r,t,e){let n=r.getHours(),a;switch(n>=17?a=De.evening:n>=12?a=De.afternoon:n>=4?a=De.morning:a=De.night,t){case"B":case"BB":case"BBB":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return e.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return e.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(r,t,e){if(t==="ho"){let n=r.getHours()%12;return n===0&&(n=12),e.ordinalNumber(n,{unit:"hour"})}return oe.h(r,t)},H:function(r,t,e){return t==="Ho"?e.ordinalNumber(r.getHours(),{unit:"hour"}):oe.H(r,t)},K:function(r,t,e){let n=r.getHours()%12;return t==="Ko"?e.ordinalNumber(n,{unit:"hour"}):L(n,t.length)},k:function(r,t,e){let n=r.getHours();return n===0&&(n=24),t==="ko"?e.ordinalNumber(n,{unit:"hour"}):L(n,t.length)},m:function(r,t,e){return t==="mo"?e.ordinalNumber(r.getMinutes(),{unit:"minute"}):oe.m(r,t)},s:function(r,t,e){return t==="so"?e.ordinalNumber(r.getSeconds(),{unit:"second"}):oe.s(r,t)},S:function(r,t){return oe.S(r,t)},X:function(r,t,e){let n=r.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return yn(n);case"XXXX":case"XX":return pe(n);case"XXXXX":case"XXX":default:return pe(n,":")}},x:function(r,t,e){let n=r.getTimezoneOffset();switch(t){case"x":return yn(n);case"xxxx":case"xx":return pe(n);case"xxxxx":case"xxx":default:return pe(n,":")}},O:function(r,t,e){let n=r.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+wn(n,":");case"OOOO":default:return"GMT"+pe(n,":")}},z:function(r,t,e){let n=r.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+wn(n,":");case"zzzz":default:return"GMT"+pe(n,":")}},t:function(r,t,e){let n=Math.trunc(+r/1e3);return L(n,t.length)},T:function(r,t,e){return L(+r,t.length)}};function wn(r,t=""){let e=r>0?"-":"+",n=Math.abs(r),a=Math.trunc(n/60),i=n%60;return i===0?e+String(a):e+String(a)+t+L(i,2)}function yn(r,t){return r%60===0?(r>0?"-":"+")+L(Math.abs(r)/60,2):pe(r,t)}function pe(r,t=""){let e=r>0?"-":"+",n=Math.abs(r),a=L(Math.trunc(n/60),2),i=L(n%60,2);return e+a+t+i}var Dn=(r,t)=>{switch(r){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},En=(r,t)=>{switch(r){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},Jr=(r,t)=>{let e=r.match(/(P+)(p+)?/)||[],n=e[1],a=e[2];if(!a)return Dn(r,t);let i;switch(n){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",Dn(n,t)).replace("{{time}}",En(a,t))},Cn={p:En,P:Jr};var qr=/^D+$/,Gr=/^Y+$/,zr=["D","DD","YY","YYYY"];function Mn(r){return qr.test(r)}function xn(r){return Gr.test(r)}function Tn(r,t,e){let n=Kr(r,t,e);if(console.warn(n),zr.includes(r))throw new RangeError(n)}function Kr(r,t,e){let n=r[0]==="Y"?"years":"days of the month";return`Use \`${r.toLowerCase()}\` instead of \`${r}\` (in \`${t}\`) for formatting ${n} to the input \`${e}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}var Qr=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Ur=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Xr=/^'([^]*?)'?$/,Zr=/''/g,ea=/[a-zA-Z]/;function It(r,t,e){var f,p,h,y,w,b,E,S,x,k,I,$,N,te,ne,he,se,Ne;let n=ce(),a=(p=(f=e==null?void 0:e.locale)!=null?f:n.locale)!=null?p:St,i=(k=(x=(b=(w=e==null?void 0:e.firstWeekContainsDate)!=null?w:(y=(h=e==null?void 0:e.locale)==null?void 0:h.options)==null?void 0:y.firstWeekContainsDate)!=null?b:n.firstWeekContainsDate)!=null?x:(S=(E=n.locale)==null?void 0:E.options)==null?void 0:S.firstWeekContainsDate)!=null?k:1,c=(Ne=(se=(te=(N=e==null?void 0:e.weekStartsOn)!=null?N:($=(I=e==null?void 0:e.locale)==null?void 0:I.options)==null?void 0:$.weekStartsOn)!=null?te:n.weekStartsOn)!=null?se:(he=(ne=n.locale)==null?void 0:ne.options)==null?void 0:he.weekStartsOn)!=null?Ne:0,l=H(r,e==null?void 0:e.in);if(!sn(l))throw new RangeError("Invalid time value");let d=t.match(Ur).map(V=>{let R=V[0];if(R==="p"||R==="P"){let Me=Cn[R];return Me(V,a.formatLong)}return V}).join("").match(Qr).map(V=>{if(V==="''")return{isToken:!1,value:"'"};let R=V[0];if(R==="'")return{isToken:!1,value:ta(V)};if(Ot[R])return{isToken:!0,value:V};if(R.match(ea))throw new RangeError("Format string contains an unescaped latin alphabet character `"+R+"`");return{isToken:!1,value:V}});a.localize.preprocessor&&(d=a.localize.preprocessor(l,d));let g={firstWeekContainsDate:i,weekStartsOn:c,locale:a};return d.map(V=>{if(!V.isToken)return V.value;let R=V.value;(!(e!=null&&e.useAdditionalWeekYearTokens)&&xn(R)||!(e!=null&&e.useAdditionalDayOfYearTokens)&&Mn(R))&&Tn(R,t,String(r));let Me=Ot[R[0]];return Me(l,R,a.localize,g)}).join("")}function ta(r){let t=r.match(Xr);return t?t[1].replace(Zr,"'"):r}var Pt=new WeakMap,it=class{constructor(){this.formatMap={"MMMM D, YYYY":"MMMM d, yyyy","MMM D":"MMM d","DD/MM/YYYY":"dd/MM/yyyy","MM/DD/YYYY":"MM/dd/yyyy","YYYY/MM/DD":"yyyy/MM/dd"}}render(t,e,n,a,i){e.empty(),e.addClass("json-table-date-cell");let c=Pt.get(e);c&&(c.destroy(),Pt.delete(e));let l=a.typeOptions,d=(l==null?void 0:l.dateFormat)||"YYYY/MM/DD",g=this.formatMap[d],f=parseInt(n,10),p="",h=null;if(!isNaN(f)){h=new Date(f);try{p=It(h,g)}catch(b){console.error("Error formatting date:",b),p="Invalid Date",h=null}}let y=e.createEl("div",{cls:"json-table-date-wrapper"}),w=y.createSpan({text:p,cls:"json-table-date-display"});try{let b=Zt(y,{clickOpens:!0,allowInput:!1,dateFormat:"U",defaultDate:h||void 0,appendTo:document.body,onChange:E=>{var S;if(E.length>0){let x=E[0],k=x.getTime(),I=this.formatMap[((S=a.typeOptions)==null?void 0:S.dateFormat)||"YYYY/MM/DD"];w.setText(It(x,I)),i(k.toString())}else w.setText(""),i("")}});Pt.set(e,b)}catch(b){console.error("Failed to initialize flatpickr:",b),e.setText("Error initializing date picker");return}}};var Oe=class{render(t,e,n,a){}};var kn=require("obsidian"),Ie=class{render(t,e,n,a){t.createEl("label",{text:"Options",cls:"json-table-popup-label"}),e.typeOptions=e.typeOptions||{};let i=e.typeOptions;i.options=i.options||[];let c=t.createEl("div",{cls:"json-table-edit-options-list"}),l=()=>{c.empty(),i.options.forEach((h,y)=>{let w=c.createEl("div",{cls:"json-table-edit-option"}),b=w.createEl("span",{text:h.value,cls:"json-table-dropdown-tag"});h.style&&b.addClass(`dropdown-tag--${h.style}`);let E=w.createEl("button",{text:"\xD7",cls:"json-table-edit-option-delete",attr:{title:"Delete option"}});E.addEventListener("mousedown",S=>S.preventDefault()),E.addEventListener("click",async()=>{let S=h.value;i.options.splice(y,1),n.rows.forEach(k=>{k.forEach(I=>{if(I.column===e.id&&I.value){if(e.type==="dropdown")I.value===S&&(I.value="");else if(e.type==="multiselect"){let $=I.value.split(",").map(N=>N.trim()).filter(N=>N&&N!==S);I.value=$.join(",")}}})}),await a.saveTableData(n);let x=a.getFilePath();if(x){let k=a.app.vault.getAbstractFileByPath(x);k instanceof kn.TFile?await a.renderContent(k):console.error("Cannot re-render, file not found at path:",x)}else console.error("Cannot re-render, view has no file path set.");l()})})};l();let d=t.createEl("div",{cls:"json-table-edit-option-add"}),g=d.createEl("input",{type:"text",placeholder:"Add new option",cls:"json-table-edit-input"}),f=d.createEl("button",{text:"Add",cls:"json-table-add-row"}),p=async()=>{let h=g.value.trim();h&&(i.options.find(y=>y.value===h)||(i.options.push({value:h,style:"default"}),g.value="",await a.saveTableData(n),l()))};f.addEventListener("mousedown",h=>h.preventDefault()),f.addEventListener("click",p),g.addEventListener("keydown",h=>{h.key==="Enter"&&(h.preventDefault(),p())})}};var ot=class{render(t,e,n,a){t.createEl("label",{cls:"json-table-popup-label",text:"Suggest Options:"});let i=t.createDiv({cls:"json-table-editor-setting"}),c=`suggest-all-${e.id}`,l=i.createEl("input",{type:"checkbox",attr:{id:c}}),d=e.typeOptions;l.checked=!!(d!=null&&d.suggestAllFiles),i.createEl("label",{text:"Suggest all file types (not just notes)",attr:{for:c}}),l.addEventListener("change",async()=>{e.typeOptions=e.typeOptions||{};let g=e.typeOptions;g.suggestAllFiles=l.checked,await a.saveTableData(n)})}};var Fn=require("obsidian"),st=class{constructor(){this.availableFormats=[{label:"Full Date",format:"MMMM D, YYYY"},{label:"Short Date",format:"MMM D"},{label:"Day/Month/Year",format:"DD/MM/YYYY"},{label:"Month/Day/Year",format:"MM/DD/YYYY"},{label:"Year/Month/Day",format:"YYYY/MM/DD"}];this.defaultFormat="YYYY/MM/DD"}render(t,e,n,a){t.createEl("label",{cls:"json-table-popup-label",text:"Date Format:"});let i=t.createEl("select",{cls:"json-table-popup-select"}),c=e.typeOptions,l=(c==null?void 0:c.dateFormat)||this.defaultFormat;this.availableFormats.forEach(d=>{let g=i.createEl("option",{text:d.label,value:d.format});l===d.format&&(g.selected=!0)}),i.addEventListener("change",async()=>{let d=i.value;e.typeOptions=e.typeOptions||{};let g=e.typeOptions;if(g.dateFormat!==d){g.dateFormat=d,await a.saveTableData(n);let f=a.getRenderer();if(f)f.render();else{let p=a.getFilePath();if(p){let h=a.app.vault.getAbstractFileByPath(p);h instanceof Fn.TFile&&await a.renderContent(h)}}}})}};var lt=class{constructor(t,e,n){this.data=t;this.triggerRender=e;this.view=n;(!this.data.views||!Array.isArray(this.data.views)||this.data.views.length===0)&&(console.warn("No views array found in data, creating default view."),this.data.views=[{id:"default_"+Date.now(),name:"Default",sort:[],filter:[]}]),this.data.views[0].sort||(this.data.views[0].sort=[]),this.data.views[0].filter||(this.data.views[0].filter=[])}getCurrentSortRules(){var t,e;return((e=(t=this.data.views)==null?void 0:t[0])==null?void 0:e.sort)||[]}setCurrentSortRules(t){this.data.views&&this.data.views[0]?this.data.views[0].sort=t:console.error("Cannot set sort rules: No view definition found in data.")}showSortPopup(t){let e=document.querySelector(".json-table-sort-popup");e&&e.remove();let n=document.body.createEl("div",{cls:"json-table-popup json-table-sort-popup"}),a=t.getBoundingClientRect();n.style.top=`${a.bottom+5}px`,n.style.left=`${a.left}px`;let i=this.getCurrentSortRules(),c=i.length>0?i[0]:{columnId:null,direction:"asc"};n.createEl("div",{cls:"json-table-popup-header"}).createEl("h3",{text:"Sort",cls:"json-table-popup-title"});let d=n.createEl("div",{cls:"json-table-popup-content"}),g=d.createEl("select",{cls:"json-table-popup-select"}),f=g.createEl("option",{text:"-- None --",value:""});c.columnId===null&&(f.selected=!0),this.data.columns.forEach(k=>{let I=g.createEl("option",{text:k.name,value:k.id});k.id===c.columnId&&(I.selected=!0)});let p=d.createEl("select",{cls:"json-table-popup-select"}),h=p.createEl("option",{text:"Ascending",value:"asc"}),y=p.createEl("option",{text:"Descending",value:"desc"});c.direction==="asc"?h.selected=!0:y.selected=!0,p.disabled=c.columnId===null,g.addEventListener("change",()=>{p.disabled=g.value===""});let b=n.createEl("div",{cls:"json-table-popup-footer"}).createEl("button",{text:"Apply",cls:"json-table-btn json-table-btn--standard"}),E=async()=>{let k=g.value||null,I=p.value,$=k?[{columnId:k,direction:I}]:[];try{if(this.setCurrentSortRules($),this.view&&typeof this.view.saveTableData=="function")await this.view.saveTableData(this.data);else{console.error("Error: View instance or saveTableData method is not available!"),S();return}this.triggerRender(),S()}catch(N){console.error("Error applying sort or saving:",N),S()}};b.addEventListener("click",E);let S=()=>{n.remove(),document.removeEventListener("click",x,!0)},x=k=>{!n.contains(k.target)&&!t.contains(k.target)&&S()};setTimeout(()=>{document.addEventListener("click",x,!0)},0)}sortDataInMemory(){let t=this.getCurrentSortRules();if(t.length===0)return;let{columnId:e,direction:n}=t[0],a=this.data.columns.find(c=>c.id===e);if(!a){console.warn(`Sort column with ID "${e}" not found. Skipping sort.`);return}let i=c=>c.replace(/[\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{1F1E0}-\u{1F1FF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}\u{FE0F}\u{1F900}-\u{1F9FF}\u{1FA70}-\u{1FAFF}]/gu,"").trim();this.data.rows.sort((c,l)=>{let d=c.find(b=>b.column===e),g=l.find(b=>b.column===e),f=(d==null?void 0:d.value)||"",p=(g==null?void 0:g.value)||"",h=!f,y=!p;if(h&&y)return 0;if(h)return 1;if(y)return-1;let w=0;switch(a.type){case"date":let b=parseInt(f,10),E=parseInt(p,10);w=(isNaN(b)?0:b)-(isNaN(E)?0:E);break;case"checkbox":let S=f==="true";w=S===(p==="true")?0:S?1:-1;break;default:let k=i(f),I=i(p);w=k.toLowerCase().localeCompare(I.toLowerCase());break}return n==="asc"?w:w*-1})}};var Sn=require("obsidian"),_={sort:"arrow-up-down",filter:"filter",text:"case-sensitive",dropdown:"circle-chevron-down",multiselect:"list",checkbox:"check-square",date:"calendar",link:"link",plus:"plus",moreVertical:"more-vertical",trash:"trash-2",gripVertical:"grip-vertical",table:"table"};function X(r,t=16,e){let n=document.createElement("span");n.classList.add("json-table-icon"),e&&n.classList.add(e),(0,Sn.setIcon)(n,r);let a=n.querySelector("svg");return a&&(a.setAttribute("width",t.toString()),a.setAttribute("height",t.toString()),a.setAttribute("stroke-width","2")),n}var ct=class{constructor(t,e,n){this.data=t;this.triggerRender=e;this.view=n;var a,i,c;(i=(a=this.data.views)==null?void 0:a[0])!=null&&i.filter||((c=this.data.views)!=null&&c[0]?this.data.views[0].filter=[]:this.data.views=[{id:"default_"+Date.now(),name:"Default",sort:[],filter:[]}])}getCurrentFilterRules(){var t,e;return((e=(t=this.data.views)==null?void 0:t[0])==null?void 0:e.filter)||[]}setCurrentFilterRules(t){var e;(e=this.data.views)!=null&&e[0]?this.data.views[0].filter=t:console.error("Cannot set filter rules: No view definition found.")}showFilterPopup(t){let e=document.querySelector(".json-table-filter-popup");e&&e.remove();let n=document.body.createEl("div",{cls:"json-table-popup json-table-filter-popup"}),a=t.getBoundingClientRect();n.style.top=`${a.bottom+5}px`,n.style.left=`${a.left}px`,n.createEl("div",{cls:"json-table-popup-header"}).createEl("h3",{text:"Filters",cls:"json-table-popup-title"});let l=n.createEl("div",{cls:"json-table-popup-content"}).createDiv({cls:"json-table-filters-list"});this.rebuildFilterListUI(l,n),n.createEl("div",{cls:"json-table-popup-footer"}).createEl("button",{text:"+ Add Filter",cls:"json-table-btn json-table-btn--standard"}).addEventListener("click",()=>{var b;let h=(b=this.data.columns[0])==null?void 0:b.id;if(!h){console.warn("Cannot add filter: No columns exist.");return}let y={id:`filter_${Date.now()}`,columnId:h,operator:"contains",value:""},w=this.getCurrentFilterRules();w.push(y),this.setCurrentFilterRules(w),this.rebuildFilterListUI(l,n),this.applyFiltersAndRerender()});let f=()=>{n.remove(),document.removeEventListener("click",p,!0)},p=h=>{!n.contains(h.target)&&!t.contains(h.target)&&f()};setTimeout(()=>{document.addEventListener("click",p,!0)},0)}rebuildFilterListUI(t,e){t.empty();let n=this.getCurrentFilterRules();n.length===0?t.createDiv({text:"No filters applied",cls:"json-table-filter-empty"}):n.forEach((a,i)=>{this.renderFilterRow(t,a,i)})}renderFilterRow(t,e,n){let a=t.createDiv({cls:"json-table-filter-row"}),i=a.createEl("select",{cls:"json-table-popup-select"});this.data.columns.forEach(p=>{let h=i.createEl("option",{text:p.name,value:p.id});p.id===e.columnId&&(h.selected=!0)}),i.addEventListener("change",()=>{e.columnId=i.value,this.applyFiltersAndRerender()});let c=a.createEl("select",{cls:"json-table-popup-select"});[{label:"Contains",value:"contains"},{label:"Does not contain",value:"doesNotContain"},{label:"Starts with",value:"startsWith"},{label:"Ends with",value:"endsWith"},{label:"Is empty",value:"isEmpty"},{label:"Is not empty",value:"isNotEmpty"},{label:"Equals",value:"equals"},{label:"Not equal",value:"notEqual"}].forEach(p=>{let h=c.createEl("option",{text:p.label,value:p.value});p.value===e.operator&&(h.selected=!0)}),c.addEventListener("change",()=>{e.operator=c.value,e.operator==="isEmpty"||e.operator==="isNotEmpty"?d.addClass("is-hidden"):d.removeClass("is-hidden"),this.applyFiltersAndRerender()});let d=a.createEl("input",{type:"text",value:e.value||"",cls:"json-table-popup-input"});(e.operator==="isEmpty"||e.operator==="isNotEmpty")&&d.addClass("is-hidden"),d.addEventListener("blur",()=>{e.value=d.value,this.applyFiltersAndRerender()}),d.addEventListener("keydown",p=>{p.key==="Enter"&&(e.value=d.value,this.applyFiltersAndRerender())});let g=a.createEl("button",{cls:"json-table-delete-filter-button"}),f=X(_.trash,14);g.appendChild(f),g.addEventListener("click",async()=>{let p=this.getCurrentFilterRules();p.splice(n,1),this.setCurrentFilterRules(p),await this.view.saveTableData(this.data),this.triggerRender();let h=t.closest(".json-table-filter-popup"),y=h==null?void 0:h.querySelector(".json-table-filters-list");y&&h?this.rebuildFilterListUI(y,h):console.error("Could not find filter list container/popup to re-render after delete.")})}async applyFiltersAndRerender(){try{await this.view.saveTableData(this.data),this.triggerRender()}catch(t){console.error("Error saving data after filter change:",t)}}getFilteredRows(){let t=this.getCurrentFilterRules();return t.length===0?this.data.rows:this.data.rows.filter(e=>t.every(n=>{let a=e.find(g=>g.column===n.columnId),i=(a==null?void 0:a.value)||"",c=n.value||"",l=i.toLowerCase(),d=c.toLowerCase();switch(n.operator){case"contains":return l.includes(d);case"doesNotContain":return!l.includes(d);case"startsWith":return l.startsWith(d);case"endsWith":return l.endsWith(d);case"isEmpty":return i==="";case"isNotEmpty":return i!=="";case"equals":return l===d;case"notEqual":return l!==d;default:return console.warn(`Unknown filter operator: ${n.operator}`),!0}}))}hasActiveFilters(){return this.getCurrentFilterRules().length>0}};var na={text:_.text,dropdown:_.dropdown,multiselect:_.multiselect,checkbox:_.checkbox,date:_.date,notelink:_.link},dt=class{constructor(t,e,n){this.container=t;this.data=e;this.view=n;this.isResizing=!1;this.colGroup=null;this.cellRenderers=new Map,this.registerRenderers(),this.columnEditors=new Map,this.registerColumnEditors(),this.sortHandler=new lt(this.data,()=>this.render(),this.view),this.filterHandler=new ct(this.data,()=>this.render(),this.view)}registerRenderers(){this.cellRenderers.set("text",new $e),this.cellRenderers.set("checkbox",new Ve),this.cellRenderers.set("dropdown",new Be),this.cellRenderers.set("multiselect",new Je),this.cellRenderers.set("notelink",new Ge),this.cellRenderers.set("date",new it)}registerColumnEditors(){this.columnEditors.set("text",new Oe),this.columnEditors.set("checkbox",new Oe),this.columnEditors.set("dropdown",new Ie),this.columnEditors.set("multiselect",new Ie),this.columnEditors.set("notelink",new ot),this.columnEditors.set("date",new st)}renderRenameInput(){let t=this.container.createDiv({cls:"json-table-rename-container"}),e=this.view.getFilePath();if(!e)return;let a=e.substring(e.lastIndexOf("/")+1).replace(/\.(table\.json|table\.md)$/,""),i=t.createEl("input",{type:"text",cls:"json-table-rename-input",value:a,placeholder:"Table name"});i.addEventListener("blur",async()=>{let c=i.value.trim();c&&c!==a?await this.view.renameFile(c)||(i.value=a):c||(i.value=a)}),i.addEventListener("keydown",c=>{c.key==="Enter"?(c.preventDefault(),i.blur()):c.key==="Escape"&&(c.preventDefault(),i.value=a,i.blur())})}render(){var h,y;let t=this.container.querySelector(".json-table-wrapper"),e=(h=t==null?void 0:t.scrollLeft)!=null?h:0,n=(y=t==null?void 0:t.scrollTop)!=null?y:0;this.container.empty(),this.renderRenameInput();let a=this.container.createDiv({cls:"json-table-controls"}),i=a.createEl("button",{cls:"json-table-btn json-table-btn--standard json-table-sort-button",attr:{"aria-label":"Sort table"}}),c=X(_.sort,16,"icon-sort");i.appendChild(c),i.appendText(" Sort"),i.addEventListener("click",()=>{this.sortHandler.showSortPopup(i)});let l=a.createEl("button",{cls:"json-table-btn json-table-btn--standard json-table-filter-button"}),d=X(_.filter,16,"icon-filter");l.appendChild(d),l.appendText(" Filter"),this.filterHandler.hasActiveFilters()&&l.addClass("json-table-btn--active"),l.addEventListener("click",()=>{this.filterHandler.showFilterPopup(l)});let g=this.container.createEl("div",{cls:"json-table-wrapper"}),f=g.createEl("table",{cls:"json-table"});this.sortHandler.sortDataInMemory();let p=this.filterHandler.getFilteredRows();this.colGroup=f.createEl("colgroup"),this.renderColGroup(),this.renderHeader(f),this.renderBody(f,p),this.renderAddRowButton(this.container),requestAnimationFrame(()=>{g.scrollLeft=e,g.scrollTop=n})}renderColGroup(){if(!this.colGroup)return;let t=this.colGroup;t.empty(),this.data.columns.forEach((n,a)=>{let i=t.createEl("col");i.style.width=n.width?`${n.width}px`:"150px",i.setAttribute("data-col-index",a.toString())}),t.createEl("col").addClass("json-table-buttons-col")}renderHeader(t){let n=t.createEl("thead").createEl("tr"),a=null;this.data.columns.forEach((f,p)=>{let h=n.createEl("th",{cls:"json-table-header-cell"});h.draggable=!0,h.setAttribute("data-col-index",p.toString());let y=h.createEl("div",{cls:"json-table-header-content"}),w=na[f.type];if(w){let E=X(w,14,`icon-col-${f.type}`);E&&y.appendChild(E)}y.appendText(f.name),h.createEl("div",{cls:"json-table-resize-handle"}).addEventListener("mousedown",E=>{this.onResizeStart(E,f,p)}),h.addEventListener("dragstart",E=>{if(E.target.classList.contains("json-table-resize-handle")){E.preventDefault();return}E.dataTransfer&&(E.dataTransfer.effectAllowed="move",a=p,h.classList.add("is-dragging"))}),h.addEventListener("dragover",E=>{E.preventDefault(),E.dataTransfer&&(E.dataTransfer.dropEffect="move"),h.classList.add("is-dragover")}),h.addEventListener("dragleave",()=>h.classList.remove("is-dragover")),h.addEventListener("drop",E=>{if(E.preventDefault(),h.classList.remove("is-dragover"),a===null)return;let S=p;if(a===S)return;let x=this.data.columns.splice(a,1)[0];this.data.columns.splice(S,0,x),this.view.saveTableData(this.data),this.render()}),h.addEventListener("dragend",()=>{h.classList.remove("is-dragging"),a=null}),h.addEventListener("click",E=>{if(this.isResizing){this.isResizing=!1;return}E.target.classList.contains("json-table-resize-handle")||(E.stopPropagation(),this.showEditColumnDialog(h,f,this.data,p))})});let i=n.createEl("th",{cls:"json-table-header-sticky json-table-buttons-th"}),l=i.createEl("div",{cls:"json-table-header-buttons-container"}).createEl("div",{cls:"json-table-btn json-table-btn--icon",attr:{"aria-label":"Add column",title:"Add column"}}),d=X(_.plus,18);l.appendChild(d);let g=!1;l.addEventListener("click",f=>{f.preventDefault(),f.stopPropagation(),!g&&(g=!0,this.showAddColumnDialog(i,l,this.data,()=>{g=!1}))})}renderBody(t,e){let n=t.createEl("tbody"),a=new Map;this.data.rows.forEach((i,c)=>a.set(i,c)),e.forEach(i=>{var h;let c=n.createEl("tr",{cls:"json-table-row"}),l=(h=a.get(i))!=null?h:-1;this.renderRow(c,i,this.data.columns,l,this.data);let f=c.createEl("td",{cls:"json-table-row-actions-cell"}).createEl("div",{cls:"json-table-cell-content"}).createEl("div",{cls:"json-table-btn json-table-btn--icon",attr:{"aria-label":"Delete row",title:"Delete row"}}),p=X(_.trash,16);f.appendChild(p),f.addEventListener("click",async y=>{y.stopPropagation(),l>-1?(this.data.rows.splice(l,1),await this.view.saveTableData(this.data),this.render()):console.error("Could not find original row index for deletion while filtered.")})})}renderRow(t,e,n,a,i){let c=new Map;e.forEach(l=>c.set(l.column,l.value)),n.forEach(l=>{let d=c.get(l.id)||"",g=t.createEl("td",{cls:"json-table-cell"}),f=this.cellRenderers.get(l.type)||this.cellRenderers.get("text");if(!f)return;let p=async h=>{let y=e.find(w=>w.column===l.id);y?y.value=h:e.push({column:l.id,value:h}),await this.view.saveTableData(i),(this.sortHandler.getCurrentSortRules().some(w=>w.columnId===l.id)||this.filterHandler.hasActiveFilters())&&this.render()};f.render(this.view.app,g,d,l,p)})}renderAddRowButton(t){let e=t.createEl("div",{cls:"json-table-add-row"}),n=e.createDiv({cls:"json-table-btn json-table-btn--hybrid"}),a=X(_.plus,16);n.appendChild(a),n.createSpan({text:"Add row",cls:"json-table-add-row-text"}),e.addEventListener("click",async()=>{let i={};this.data.columns.forEach(d=>{i[d.id]=d.type==="checkbox"?"false":""}),this.filterHandler.getCurrentFilterRules().forEach(d=>{d.operator==="equals"&&d.value&&i.hasOwnProperty(d.columnId)&&(i[d.columnId]=d.value)});let l=Object.entries(i).map(([d,g])=>({column:d,value:g}));this.data.rows.push(l),await this.view.saveTableData(this.data),this.render()})}onResizeStart(t,e,n){if(!this.colGroup)return;this.isResizing=!0,t.preventDefault(),t.stopPropagation();let a=this.colGroup.querySelector(`col[data-col-index="${n}"]`);if(!a){this.isResizing=!1;return}let i=t.clientX,c=a.offsetWidth,l=g=>{let f=c+(g.clientX-i);f>40&&(a.style.width=`${f}px`)},d=()=>{document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",d);let g=a.offsetWidth;e.width=g,this.view.saveTableData(this.data),setTimeout(()=>{this.isResizing=!1},0)};document.addEventListener("mousemove",l),document.addEventListener("mouseup",d)}showEditColumnDialog(t,e,n,a){let i=document.querySelector(".json-table-edit-column-popup");i&&i.remove();let c=document.body.createEl("div",{cls:"json-table-popup json-table-edit-column-popup"}),l=t.getBoundingClientRect();c.style.top=`${l.bottom+5}px`,c.style.left=`${l.left}px`;let d=c.createEl("div",{cls:"json-table-popup-wrapper"}),g=d.createEl("input",{type:"text",cls:"json-table-edit-input",value:e.name,placeholder:"Column name"}),f=d.createEl("div",{cls:"json-table-column-editor-container"}),p=this.columnEditors.get(e.type)||this.columnEditors.get("text");p&&p.render(f,e,this.data,this.view);let h=d.createEl("button",{cls:"json-table-btn json-table-btn--hybrid json-table-btn---delete-column"}),y=X(_.trash,16);h.appendChild(y),h.appendText("Delete Column"),g.focus(),g.select();let w=()=>{c.remove(),document.removeEventListener("click",S)},b=async()=>{let x=g.value.trim(),k=!1;if(x&&x!==e.name&&(e.name=x,k=!0),k){await this.view.saveTableData(n);let I=t.querySelector(".json-table-header-content"),$=I?Array.from(I.childNodes).find(N=>N.nodeType===Node.TEXT_NODE):null;$?$.textContent=x:console.warn("Could not find text node to update header name."),this.render()}w()},E=async()=>{n.columns.splice(a,1),n.rows.forEach(x=>{let k=x.findIndex(I=>I.column===e.id);k!==-1&&x.splice(k,1)}),await this.view.saveTableData(n),this.render(),w()};h.addEventListener("mousedown",x=>x.preventDefault()),h.addEventListener("click",async x=>{x.stopPropagation(),x.preventDefault(),document.removeEventListener("click",S),await E()}),g.addEventListener("keydown",x=>{x.key==="Enter"?(x.preventDefault(),b()):x.key==="Escape"&&(x.preventDefault(),w())});let S=x=>{!c.contains(x.target)&&!t.contains(x.target)&&b()};setTimeout(()=>{document.addEventListener("click",S)},100)}showAddColumnDialog(t,e,n,a){e.addClass("is-dimmed");let i=document.body.createEl("div",{cls:"json-table-popup json-table-column-popup"}),c=e.getBoundingClientRect();i.style.top=`${c.top}px`,i.style.right=`${document.body.clientWidth-c.right}px`;let l=i.createEl("div",{cls:"json-table-popup-wrapper"}),d=l.createEl("input",{type:"text",cls:"json-table-edit-input",placeholder:"New column name"});setTimeout(()=>d.focus(),50),l.createEl("div",{text:"Select column type:",cls:"json-table-popup-label"});let g=l.createEl("div",{cls:"json-table-type-buttons"}),f=[{type:"text",name:"Text",icon:_.text},{type:"checkbox",name:"Checkbox",icon:_.checkbox},{type:"dropdown",name:"Dropdown",icon:_.dropdown},{type:"multiselect",name:"Multi-select",icon:_.multiselect},{type:"notelink",name:"Note Link",icon:_.link},{type:"date",name:"Date",icon:_.date}],p=[{value:"To Do",style:"red"},{value:"In Progress",style:"blue"},{value:"Done",style:"green"}];f.forEach(({type:E,name:S,icon:x})=>{let k=g.createEl("div",{cls:"json-table-btn json-table-btn--hybrid",attr:{role:"button",tabindex:0}}),I=X(x,16,`icon-type-${E}`);I&&k.appendChild(I),k.appendText(S);let $=()=>{let N={};(E==="dropdown"||E==="multiselect")&&(N={typeOptions:{options:p}}),E==="date"&&(N={dateFormat:"YYYY/MM/DD"}),y(E,S,N)};k.addEventListener("click",$),k.addEventListener("keydown",N=>{(N.key==="Enter"||N.key===" ")&&(N.preventDefault(),$())})});let h=()=>{i.remove(),e.removeClass("is-dimmed"),document.removeEventListener("click",w),document.removeEventListener("keydown",b),a()},y=async(E,S,x={})=>{let k=d.value.trim()||S,I="col_"+Date.now();n.columns.push({id:I,name:k,type:E,width:150,...x}),n.rows.forEach($=>$.push({column:I,value:""})),await this.view.saveTableData(n),this.render(),h()},w=E=>{!i.contains(E.target)&&!e.contains(E.target)&&h()},b=E=>{E.key==="Escape"&&h()};d.addEventListener("keydown",E=>{E.key==="Enter"&&(E.preventDefault(),y("text","Text",{}))}),setTimeout(()=>{document.addEventListener("click",w),document.addEventListener("keydown",b)},100)}};var Ee=class{constructor(t){this.app=t}async read(t){let e=await this.app.vault.read(t);if(!e)return console.warn(`File is empty: ${t.path}. Returning default structure.`),{columns:[],rows:[],views:[{id:"default_"+Date.now(),name:"Default",sort:[],filter:[]}]};try{let n=JSON.parse(e);if(!n.views||!Array.isArray(n.views)||n.views.length===0?(n.views=[{id:"default_"+Date.now(),name:"Default",sort:[],filter:[]}],n.views[0].sort||(n.views[0].sort=[]),n.views[0].filter||(n.views[0].filter=[])):(n.views[0].sort||(n.views[0].sort=[]),n.views[0].filter||(n.views[0].filter=[])),n.columns.forEach(a=>{a.typeOptions||(a.typeOptions={})}),!n.columns||!n.rows||!n.views)throw new Error("Invalid table JSON structure: missing columns, rows, or views.");return n}catch(n){throw console.error(`Error parsing JSON file ${t.path}:`,n),new Error(`Invalid JSON: ${n.message}`)}}async save(t,e){try{(!e.views||e.views.length===0)&&(e.views=[{id:"default_"+Date.now(),name:"Default",sort:[],filter:[]}]),e.views[0].sort||(e.views[0].sort=[]),e.views[0].filter||(e.views[0].filter=[]),e.columns.forEach(a=>{a.typeOptions||(a.typeOptions={})});let n=JSON.stringify(e,null,2);await this.app.vault.modify(t,n)}catch(n){throw console.error(`Error saving JSON file ${t.path}:`,n),new Error(`Failed to save file: ${n.message}`)}}};var ft=require("obsidian"),de="```json-table",ut="```",Pe=new RegExp(`${de}\\s*\\n?([\\s\\S]*?)\\n?\\s*${ut}`),Lt="json-table-plugin",ra="table-links",me=class{constructor(t){this.app=t}async read(t){let e=await this.app.vault.read(t),n=this.app.metadataCache.getFileCache(t);if(((n==null?void 0:n.frontmatter)||{})[Lt]!==!0)throw new Error(`File ${t.path} is not a valid table file. Missing '${Lt}: true' in frontmatter.`);let i=e.match(Pe);if(!i||i[1]===void 0||i[1]===null)if(e.includes(de))if(e.substring(e.indexOf(de)).includes(ut)){let l=e.indexOf(de);throw console.error(`Regex failed despite markers present. Content around block:
`,e.substring(Math.max(0,l-20),l+100)),new Error(`Could not extract content from '${de}' code block in ${t.path}. Check for malformed block or unexpected characters.`)}else throw new Error(`Found '${de}' but no closing '${ut}' in ${t.path}`);else throw new Error(`Could not find '${de}' code block start in ${t.path}`);let c=i[1].trim();if(!c)return console.warn(`Empty json-table code block found in ${t.path}. Returning default structure.`),{columns:[],rows:[],views:[{id:"default_"+Date.now(),name:"Default",sort:[],filter:[]}]};try{let l=JSON.parse(c);if(!l||typeof l!="object"||!Array.isArray(l.columns)||!Array.isArray(l.rows))throw new Error("Invalid table JSON structure: missing columns or rows.");return(!l.views||!Array.isArray(l.views)||l.views.length===0)&&(l.views=[{id:"default_"+Date.now(),name:"Default",sort:[],filter:[]}]),l.views[0].sort||(l.views[0].sort=[]),l.columns.forEach(d=>{d.typeOptions||(d.typeOptions={},d.dateFormat&&(d.typeOptions.dateFormat=d.dateFormat,delete d.dateFormat),d.options&&(d.typeOptions.options=d.options,delete d.options),d.suggestAllFiles!==void 0&&(d.typeOptions.suggestAllFiles=d.suggestAllFiles,delete d.suggestAllFiles))}),l}catch(l){throw console.error(`Error parsing embedded JSON in ${t.path}:`,c.substring(0,500),l),new Error(`Invalid embedded JSON: ${l.message}`)}}async save(t,e){try{let n=JSON.stringify(e,null,2),a=this.extractLinkPaths(e),i=await this.app.vault.read(t),c=this.updateMarkdownContent(i,n,a);await this.app.vault.modify(t,c)}catch(n){throw console.error(`Error saving Markdown file ${t.path}:`,n),new Error(`Failed to save Markdown file: ${n.message}`)}}extractLinkPaths(t){let e=new Set,n=t.columns.filter(a=>a.type==="notelink").map(a=>a.id);return n.length===0?[]:(t.rows.forEach(a=>{a.forEach(i=>{n.includes(i.column)&&i.value&&e.add(i.value)})}),Array.from(e))}updateMarkdownContent(t,e,n){let a={},i=t;if(t.startsWith("---")){let f=t.match(/^---\s*([\s\S]*?)\s*---/);if(f&&f[1])try{a=(0,ft.parseYaml)(f[1])||{},i=t.substring(f[0].length).trimStart()}catch(p){console.warn(`Could not parse existing frontmatter in file, preserving original body structure. Error: ${p}`),a={},i=t}else i=t}else i=t;a[Lt]=!0,a[ra]=n.map(f=>`[[${f}]]`);let c=`---
${(0,ft.stringifyYaml)(a)}---
`,l=i,d=i.match(Pe),g=`${de}
${e}
${ut}`;if(d){let f=i.replace(Pe,"").trim(),p=/<!--[\s\S]*?-->/g,h=f.replace(p,"").trim();!h||h.startsWith("##"),l=i.replace(Pe,g)}else console.warn("No json-table code block found in body, appending new one."),l=(i.trim()?i.trim()+`

`:"")+g;return c+l.trim()+`
`}};var Le=class extends Ce.ItemView{constructor(e){super(e);this.renderer=null;this.fileHandler=null;this.data=null;this.settings=We;this.currentFilePath=null}getFilePath(){return this.currentFilePath}getRenderer(){return this.renderer}getViewType(){return ee}getDisplayText(){let e=this.currentFilePath;return e&&e.substring(e.lastIndexOf("/")+1).replace(/\.(table\.json|table\.md)$/,"")||"Table"}getIcon(){return"table"}setSettings(e){this.settings=e,this.currentFilePath&&this.app.workspace.activeLeaf===this.leaf&&this.loadFileAndRender(this.currentFilePath)}async setState(e,n){let a=e.file||null,i=a!==this.currentFilePath;if(this.currentFilePath=a,await super.setState(e,n),this.currentFilePath&&(i||!this.data))await this.loadFileAndRender(this.currentFilePath);else if(!this.currentFilePath){let c=this.containerEl.children[1];c&&this.showError(c,"No file specified in view state.",!1)}}getState(){return{file:this.currentFilePath}}async loadFileAndRender(e){let n=this.app.vault.getAbstractFileByPath(e);n instanceof Ce.TFile?(this.selectFileHandler(n),await this.renderContent(n)):(console.error(`File not found or is a folder: ${e}`),this.showError(this.containerEl.children[1],`Cannot load table: File not found at "${e}".`,!1),this.clearView())}selectFileHandler(e){let n=this.settings.tableRenderer==="default",a=e.name.endsWith(".table.md"),i=e.name.endsWith(".table.json");this.fileHandler=null,a?n&&(this.fileHandler=new me(this.app)):i&&(this.fileHandler=new Ee(this.app))}async renderContent(e){let n=this.containerEl.children[1];if(n){if(n.empty(),this.renderer=null,this.data=null,n.addClass("json-table-view-container"),this.fileHandler||this.selectFileHandler(e),!this.fileHandler||!this.checkIfHandlerIsValid(e)){console.warn(`renderContent: No valid file handler for ${e.path} with current settings.`);let a=this.settings.tableRenderer==="default";e.name.endsWith(".table.md")&&!a?this.showError(n,"Set 'Table Renderer' to 'Default' in settings to view this file.",!1):this.showError(n,"This file is not recognized as a valid table type or requires different settings.",!0);return}try{if(this.data=await this.fileHandler.read(e),!this.data||typeof this.data!="object"||!Array.isArray(this.data.columns)||!Array.isArray(this.data.rows))throw new Error("Invalid table data structure received.");this.renderer=new dt(n,this.data,this),this.renderer.render()}catch(a){console.error(`Error rendering table for ${e.path}:`,a),this.clearView(),this.showError(n,`Error reading table file: ${a.message}`,!0)}}}async saveTableData(e){if(!this.currentFilePath){console.error("Cannot save: No file path associated with the view."),this.app.workspace.trigger("notice","Error: Cannot save, no file loaded.");return}let n=this.app.vault.getAbstractFileByPath(this.currentFilePath);if(!(n instanceof Ce.TFile)){console.error(`Cannot save: File not found at path "${this.currentFilePath}".`),this.app.workspace.trigger("notice","Error: File to save not found.");return}if(this.selectFileHandler(n),!this.fileHandler||!e||!this.checkIfHandlerIsValid(n)){console.error("Cannot save: No valid handler, data, or settings mismatch.",{file:n,handler:this.fileHandler,data:e}),this.app.workspace.trigger("notice","Error: Could not save table data.");return}try{await this.fileHandler.save(n,e),this.data=e}catch(a){console.error("Error saving table data:",a),this.app.workspace.trigger("notice",`Error saving table: ${a.message}`)}}async onOpen(){this.currentFilePath&&!this.renderer?await this.loadFileAndRender(this.currentFilePath):this.currentFilePath||this.showError(this.containerEl.children[1],"No file loaded.",!1)}async onClose(){this.clearView()}async renameFile(e){var h;if(!this.currentFilePath)return console.error("Cannot rename: No file path associated with the view."),!1;let n=this.app.vault.getAbstractFileByPath(this.currentFilePath);if(!(n instanceof Ce.TFile))return console.error(`Cannot rename: File not found at path "${this.currentFilePath}".`),!1;let a=((h=n.parent)==null?void 0:h.path)||"",i=n.name,c=i.endsWith(".table.json"),l=i.endsWith(".table.md");if(!c&&!l)return console.error(`Cannot rename: File "${i}" is not a recognized table file type.`),!1;let f=`${e.replace(/\.(table\.json|table\.md)$/,"")}${c?".table.json":".table.md"}`,p=a?`${a}/${f}`:f;if(await this.app.vault.adapter.exists(p))return console.error(`Cannot rename: File "${f}" already exists.`),!1;try{return await this.app.vault.rename(n,p),this.currentFilePath=p,!0}catch(y){return console.error("Error renaming file:",y),!1}}clearView(){var e;(e=this.containerEl.children[1])==null||e.empty(),this.renderer=null,this.fileHandler=null,this.data=null,this.currentFilePath=null}checkIfHandlerIsValid(e){let n=this.settings.tableRenderer==="default",a=e.name.endsWith(".table.md"),i=e.name.endsWith(".table.json");return a?n:!!i}showError(e,n,a=!1){if(!e)return;e.empty(),e.addClass("json-table-view-container");let i=e.createEl("div",{cls:"json-table-error"});i.createEl("p",{text:n});let c=this.currentFilePath;a&&c&&i.createEl("button",{text:"Open as raw text",cls:"json-table-add-row"}).addEventListener("click",()=>{this.leaf&&this.leaf.setViewState({type:"plaintext",state:{file:c}})})}};var pt=class extends Y.Plugin{async onload(){await this.loadSettings(),this.registerView(ee,t=>{let e=new Le(t);return e.setSettings(this.settings),e}),this.app.workspace.onLayoutReady(()=>{this.registerFileExtensions()}),this.addSettingTab(new Nt(this.app,this)),this.registerEvent(this.app.workspace.on("file-menu",(t,e,n,a)=>{var c;if(!(e instanceof Y.TFile))t.addItem(l=>{l.setTitle("New table").setIcon("table").onClick(async()=>{await this.createNewTable(e)})});else if(e instanceof Y.TFile&&e.name.endsWith(".table.md")&&a){let l=this.app.metadataCache.getFileCache(e);(c=l==null?void 0:l.frontmatter)!=null&&c["json-table-plugin"]&&a.view.getViewType()!==ee&&t.addItem(d=>{d.setTitle("Open as Table").setIcon("table").onClick(async()=>{await a.setViewState({type:ee,state:{file:e.path}},{focus:!0})})})}})),this.registerEvent(this.app.workspace.on("files-menu",(t,e)=>{if(e.length===1&&!(e[0]instanceof Y.TFile)){let n=e[0];t.addItem(a=>{a.setTitle("New table").setIcon("table").onClick(async()=>{await this.createNewTable(n)})})}})),this.addCommand({id:"create-new-table",name:"Create new table",checkCallback:t=>{let e=this.app.workspace.getActiveFile(),n=e?e.parent:this.app.vault.getRoot();return n&&!(n instanceof Y.TFile)?(t||this.createNewTable(n),!0):!1}}),this.addCommand({id:"import-csv",name:"Import CSV file",callback:()=>{this.importCSVFile()}}),this.registerEvent(this.app.vault.on("rename",(t,e)=>{t instanceof Y.TFile&&this.updateLinksInAllTables(e,t.path)})),this.registerEvent(this.app.vault.on("delete",t=>{t instanceof Y.TFile&&this.removeLinksInAllTables(t.path)})),this.registerEvent(this.app.workspace.on("file-open",async t=>{var i;if(this.settings.tableRenderer!=="default"||!t||!t.name.endsWith(".table.md"))return;let e=!1;try{let c=await this.app.vault.read(t);e=/^---\s*\n[\s\S]*?json-table-plugin:\s*true[\s\S]*?\n---/.test(c)}catch(c){console.error("file-open: Error reading file content:",c);return}if(!e)return;let n=null,a=this.app.workspace.getLeavesOfType("markdown");for(let c of a)if(((i=c.getViewState().state)==null?void 0:i.file)===t.path){n=c;break}if(n)try{await n.setViewState({type:ee,state:{file:t.path}},{focus:!0})}catch(c){console.error("file-open: Error during setViewState:",c)}}))}onunload(){}registerFileExtensions(){this.registerExtensions(["table.md"],ee),this.registerExtensions(["json"],ee)}async loadSettings(){this.settings=Object.assign({},We,await this.loadData())}async saveSettings(){await this.saveData(this.settings),this.app.workspace.getLeavesOfType(ee).forEach(t=>{t.view instanceof Le&&t.view.setSettings(this.settings)})}async createNewTable(t){(!t||t instanceof Y.TFile)&&(console.error("Invalid target folder provided for createNewTable. Using Vault root."),t=this.app.vault.getRoot());let e="col"+Date.now()+"_1",n="col"+Date.now()+"_2",a={columns:[{id:e,name:"Column 1",type:"text",width:150,typeOptions:{}},{id:n,name:"Column 2",type:"text",width:150,typeOptions:{}}],rows:[[{column:e,value:""},{column:n,value:""}]],views:[{id:"default_"+Date.now(),name:"Default",sort:[],filter:[]}]},i="",c="",l=1,d="",g="New Table",f=t.path==="/"?"":t.path;if(this.settings.tableRenderer==="default"){let p=".table.md";for(i=`${g}${p}`,d=f?`${f}/${i}`:i;await this.app.vault.adapter.exists(d);)i=`${g} ${l}${p}`,d=f?`${f}/${i}`:i,l++;let h=i.replace(p,""),y=JSON.stringify(a,null,2),w=`---
json-table-plugin: true
table-links: []
---
`,b=`
## ${h}

<!-- Do not edit the code block below manually -->

\`\`\`json-table
${y}
\`\`\`
`;c=w+b}else{let p=".table.json";for(i=`${g}${p}`,d=f?`${f}/${i}`:i;await this.app.vault.adapter.exists(d);)i=`${g} ${l}${p}`,d=f?`${f}/${i}`:i,l++;c=JSON.stringify(a,null,2)}try{let p=await this.app.vault.create(d,c);await this.app.workspace.getLeaf("tab").openFile(p)}catch(p){console.error(`Error creating table file "${d}":`,p),new Y.Notice("Error creating table file. Check console for details.")}}async importCSVFile(){let t=document.createElement("input");t.type="file",t.accept=".csv",t.style.display="none",t.onchange=async e=>{var a;let n=(a=e.target.files)==null?void 0:a[0];if(!n){t.remove();return}try{let i=await n.text(),c=this.parseCSV(i);if(!c){new Y.Notice("Failed to parse CSV file. Check console for details."),t.remove();return}let l=this.app.workspace.getActiveFile(),d=l?l.parent:this.app.vault.getRoot();if(!d||d instanceof Y.TFile){new Y.Notice("Error: Could not determine target folder."),t.remove();return}await this.createTableFromCSV(d,n.name,c),new Y.Notice("CSV imported successfully!")}catch(i){console.error("Error importing CSV:",i),new Y.Notice("Error importing CSV file. Check console for details.")}finally{t.remove()}},document.body.appendChild(t),t.click()}parseCSV(t){try{let e=t.split(`
`).filter(i=>i.trim());if(e.length<1)return console.error("CSV file is empty"),null;let n=this.parseCSVLine(e[0]),a=[];for(let i=1;i<e.length;i++){let c=this.parseCSVLine(e[i]);c.length===n.length&&a.push(c)}return{columns:n,rows:a}}catch(e){return console.error("Error parsing CSV:",e),null}}parseCSVLine(t){let e=[],n="",a=!1;for(let i=0;i<t.length;i++){let c=t[i],l=t[i+1];c==='"'?a&&l==='"'?(n+='"',i++):a=!a:c===","&&!a?(e.push(n.trim()),n=""):n+=c}return e.push(n.trim()),e}async createTableFromCSV(t,e,n){let a=t.path==="."?"":t.path,i=e.replace(/\.csv$/i,"").replace(/[^a-zA-Z0-9-_]/g,"_"),c=this.settings.tableRenderer==="default"?".table.md":".table.json",l=`${i}${c}`,d=a?`${a}/${l}`:l,g=1;for(;await this.app.vault.adapter.exists(d);)l=`${i} ${g}${c}`,d=a?`${a}/${l}`:l,g++;let f=n.columns.map((w,b)=>({id:`col_${b}`,name:w,type:"text",width:150})),p=n.rows.map(w=>w.map((b,E)=>({column:`col_${E}`,value:b}))),h={columns:f,rows:p,views:[{id:"default_"+Date.now(),name:"Default",sort:[],filter:[]}]},y;if(this.settings.tableRenderer==="default"){let w=new me(this.app),b=`json-table-plugin: true
table-links: []
`,E=`\`\`\`json-table
${JSON.stringify(h,null,2)}
\`\`\`
`;y=`---
${b}---
${E}`}else y=JSON.stringify(h,null,2);try{let w=await this.app.vault.create(d,y);await this.app.workspace.getLeaf("tab").openFile(w)}catch(w){console.error(`Error creating table file "${d}":`,w),new Y.Notice("Error creating table file. Check console for details.")}}getHandlerForFile(t){return t.name.endsWith(".table.md")?new me(this.app):t.name.endsWith(".table.json")?new Ee(this.app):null}async updateLinksInAllTables(t,e){let a=this.app.vault.getFiles().filter(i=>i.name.endsWith(".table.json")||i.name.endsWith(".table.md"));if(a.length!==0)for(let i of a){let c=this.getHandlerForFile(i);if(!c)continue;let l=null,d=!1;try{if(l=await c.read(i),!l||!l.columns||!l.rows){console.warn(`Skipping invalid data structure in ${i.path}`);continue}let g=l.columns.filter(f=>f.type==="notelink").map(f=>f.id);if(g.length===0)continue;l.rows.forEach(f=>{f.forEach(p=>{g.includes(p.column)&&p.value===t&&(p.value=e,d=!0)})}),d&&await c.save(i,l)}catch(g){console.error(`Failed to process links update in ${i.path}:`,g)}}}async removeLinksInAllTables(t){let n=this.app.vault.getFiles().filter(a=>a.name.endsWith(".table.json")||a.name.endsWith(".table.md"));if(n.length!==0)for(let a of n){let i=this.getHandlerForFile(a);if(!i)continue;let c=null,l=!1;try{if(c=await i.read(a),!c||!c.columns||!c.rows)continue;let d=c.columns.filter(g=>g.type==="notelink").map(g=>g.id);if(d.length===0)continue;c.rows.forEach(g=>{g.forEach(f=>{d.includes(f.column)&&f.value===t&&(f.value="",l=!0)})}),l&&await i.save(a,c)}catch(d){console.error(`Failed to process link removal in ${a.path}:`,d)}}}},Nt=class extends Y.PluginSettingTab{constructor(t,e){super(t,e),this.plugin=e}display(){let{containerEl:t}=this;t.empty(),t.createEl("h2",{text:"Tables Settings"}),new Y.Setting(t).setName("Table Renderer").setDesc("By default, Tables uses .table.md to maximise compatibility and incorporate Obsidian backlink functionality. JSON is an alternative - it's faster and uses native JSON. Use if experiencing issues with the default renderer. Reload Obsidian for changes to take full effect on file handling and creation.").addDropdown(e=>e.addOption("default","Default (.table.md)").addOption("json","JSON (.table.json)").setValue(this.plugin.settings.tableRenderer).onChange(async n=>{this.plugin.settings.tableRenderer=n,await this.plugin.saveSettings(),new Y.Notice("Reload required for file handling changes to take full effect.",7e3)}))}};
