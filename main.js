/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
*/

var xt=Object.defineProperty;var or=Object.getOwnPropertyDescriptor;var sr=Object.getOwnPropertyNames;var lr=Object.prototype.hasOwnProperty;var cr=(n,t)=>{for(var e in t)xt(n,e,{get:t[e],enumerable:!0})},dr=(n,t,e,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of sr(t))!lr.call(n,a)&&a!==e&&xt(n,a,{get:()=>t[a],enumerable:!(r=or(t,a))||r.enumerable});return n};var ur=n=>dr(xt({},"__esModule",{value:!0}),n);var aa={};cr(aa,{default:()=>pt});module.exports=ur(aa);var B=require("obsidian");var De=require("obsidian");var ee="json-table-view",_e={tableRenderer:"default"};var $e=class{render(t,e,r,a,o){let c=e.createEl("input",{type:"text",value:r,cls:"json-table-input",title:r});c.addEventListener("blur",()=>o(c.value)),c.addEventListener("keydown",l=>{l.key==="Enter"&&(l.preventDefault(),c.blur())})}};var Be=class{render(t,e,r,a,o){let l=e.createEl("div",{cls:"json-table-cell-content json-table-cell-checkbox"}).createEl("input",{type:"checkbox",cls:"json-table-checkbox"});l.checked=r==="true",l.addEventListener("change",()=>{o(l.checked.toString())})}};var Ve=class{render(t,e,r,a,o){e.empty();let c=e.createEl("div",{cls:"json-table-dropdown"});this.renderTags(c,r,a),c.addEventListener("click",l=>{l.stopPropagation(),this.renderEdit(t,c,r,a,o)})}renderDisplay(t,e,r,a,o){e.empty(),e.removeClass("is-editing"),this.renderTags(e,r,a),e.addEventListener("click",c=>{c.stopPropagation(),this.renderEdit(t,e,r,a,o)})}renderEdit(t,e,r,a,o){let c=e.parentNode;if(!c)return;let l=e.cloneNode(!1);c.replaceChild(l,e),l.empty(),l.addClass("is-editing");let d=()=>{r="",o(""),this.renderEdit(t,l,"",a,o)};this.renderTags(l,r,a,d);let g=this.showDropdownPopup(l,r,a,p=>{r=p,o(p),this.renderEdit(t,l,p,a,o)}),f=p=>{!l.contains(p.target)&&!g.contains(p.target)&&(document.removeEventListener("click",f,!0),g.remove(),this.renderDisplay(t,l,r,a,o))};setTimeout(()=>{document.addEventListener("click",f,!0)},0)}renderTags(t,e,r,a){let o=r.typeOptions,c=(o==null?void 0:o.options)||[];if(t.empty(),!e){a||t.createEl("span",{text:"",cls:"json-table-dropdown-placeholder"});return}let l=c.find(g=>g.value===e),d=t.createEl("span",{cls:"json-table-dropdown-tag"});l&&l.style?d.addClass(`dropdown-tag--${l.style}`):d.addClass("dropdown-tag--default"),d.createEl("span",{text:e}),a&&d.createEl("span",{text:"\xD7",cls:"json-table-multiselect-tag-remove"}).addEventListener("mousedown",f=>{f.preventDefault(),f.stopPropagation(),a()})}showDropdownPopup(t,e,r,a){let o=r.typeOptions,c=(o==null?void 0:o.options)||[],l=document.body.querySelector(".json-table-dropdown-popup");l&&l.remove();let d=document.body.createEl("div",{cls:"json-table-popup json-table-dropdown-popup"}),g=t.getBoundingClientRect();return d.style.top=`${g.bottom+4}px`,d.style.left=`${g.left}px`,d.style.minWidth=`${g.width}px`,c.length>0?c.forEach(f=>{let p=d.createEl("div",{cls:"json-table-dropdown-option"}),h=p.createEl("span",{text:f.value,cls:"json-table-dropdown-tag"});f.style&&h.addClass(`dropdown-tag--${f.style}`),p.addEventListener("mousedown",y=>{y.preventDefault(),a(f.value)})}):d.createEl("div",{text:"No options defined",cls:"json-table-dropdown-option is-disabled"}),d}};var ze=class{render(t,e,r,a,o){e.empty();let c=e.createEl("div",{cls:"json-table-multiselect"});this.renderTags(c,r,a),c.addEventListener("click",l=>{l.stopPropagation(),this.renderEdit(t,c,r,a,o)})}renderDisplay(t,e,r,a,o){e.empty(),e.removeClass("is-editing"),this.renderTags(e,r,a),e.addEventListener("click",c=>{c.stopPropagation(),this.renderEdit(t,e,r,a,o)})}renderEdit(t,e,r,a,o){let c=e.parentNode;if(!c)return;let l=e.cloneNode(!1);c.replaceChild(l,e),l.empty(),l.addClass("is-editing");let d=p=>{let k=this.getValues(r).filter(v=>v!==p).join(",");r=k,o(k),this.renderEdit(t,l,k,a,o)};this.renderTags(l,r,a,d);let g=this.showDropdownPopup(l,r,a,p=>{let h=this.getValues(r);if(h.includes(p))return;h.push(p);let y=h.join(",");r=y,o(y),this.renderEdit(t,l,r,a,o)}),f=p=>{!l.contains(p.target)&&!g.contains(p.target)&&(document.removeEventListener("click",f,!0),g.remove(),this.renderDisplay(t,l,r,a,o))};setTimeout(()=>{document.addEventListener("click",f,!0)},0)}getValues(t){return t?t.split(",").filter(Boolean):[]}renderTags(t,e,r,a){let o=r.typeOptions,c=(o==null?void 0:o.options)||[],l=this.getValues(e);if(t.empty(),l.length===0){a||t.createEl("span",{text:"",cls:"json-table-dropdown-placeholder"});return}l.forEach(d=>{let g=c.find(p=>p.value===d),f=t.createEl("span",{cls:"json-table-dropdown-tag"});g&&g.style?f.addClass(`dropdown-tag--${g.style}`):f.addClass("dropdown-tag--default"),f.createEl("span",{text:d}),a&&f.createEl("span",{text:"\xD7",cls:"json-table-multiselect-tag-remove"}).addEventListener("mousedown",h=>{h.preventDefault(),h.stopPropagation(),a(d)})})}showDropdownPopup(t,e,r,a){let o=r.typeOptions,c=(o==null?void 0:o.options)||[],l=document.body.querySelector(".json-table-dropdown-popup");l&&l.remove();let d=document.body.createEl("div",{cls:"json-table-popup json-table-dropdown-popup"}),g=t.getBoundingClientRect();d.style.top=`${g.bottom+4}px`,d.style.left=`${g.left}px`,d.style.minWidth=`${g.width}px`;let f=this.getValues(e);return c.length>0?c.forEach(p=>{let h=d.createEl("div",{cls:"json-table-dropdown-option"}),y=h.createEl("span",{text:p.value,cls:"json-table-dropdown-tag"});p.style&&y.addClass(`dropdown-tag--${p.style}`),h.addEventListener("mousedown",k=>{k.preventDefault(),a(p.value)})}):d.createEl("div",{text:"No options defined",cls:"json-table-dropdown-option is-disabled"}),d}};var qt=require("obsidian"),Je=class extends qt.AbstractInputSuggest{constructor(e,r,a,o){super(e,r);this.suggestAllFiles=a;this.onSaveCallback=o}getSuggestions(e){let r=e.toLowerCase();return(this.suggestAllFiles?this.app.vault.getFiles():this.app.vault.getMarkdownFiles()).filter(o=>o.basename.toLowerCase().includes(r)||o.path.toLowerCase().includes(r))}renderSuggestion(e,r){r.setText(e.path),r.addClass("mod-complex")}selectSuggestion(e,r){let a=e.path;this.setValue(a),this.close(),this.onSaveCallback(a)}};var qe=class{render(t,e,r,a,o){e.empty();let c=e.createEl("div",{cls:"json-table-notelink-wrapper"});this.renderDisplay(t,c,r,a,o)}renderDisplay(t,e,r,a,o){e.empty(),e.addClass("is-displaying-link");let c=t.metadataCache.getFirstLinkpathDest(r,"");e.addEventListener("click",l=>{l.target===e&&this.renderEdit(t,e,r,a,o)}),c?e.createEl("a",{text:c.basename,cls:"internal-link",attr:{"data-href":r,href:r}}).addEventListener("click",d=>{d.preventDefault(),d.stopPropagation(),t.workspace.openLinkText(r,"",!1)}):e.createEl("span",{text:r||"",cls:"json-table-notelink-empty"})}renderEdit(t,e,r,a,o){let c=e.parentNode;if(!c)return;let l=e.cloneNode(!1);c.replaceChild(l,e),l.empty(),l.removeClass("is-displaying-link");let d=l.createEl("input",{type:"text",value:r,cls:"json-table-input"}),g=!1,f=k=>{if(g||(g=!0,!l.parentElement))return;let v=k.trim(),x=v;if(v){let O=t.metadataCache.getFirstLinkpathDest(v,"");O&&(x=O.path)}o(x),this.renderDisplay(t,l,x,a,o)},p=a.typeOptions,h=!!(p!=null&&p.suggestAllFiles),y=new Je(t,d,h,k=>{f(k)});setTimeout(()=>{d.focus(),d.select()},0),d.addEventListener("keydown",k=>{let v=!!document.body.querySelector(".suggestion-container");if(k.key==="Enter"){if(k.preventDefault(),v)return;f(d.value)}k.key==="Escape"&&(k.preventDefault(),v?y.close():this.renderDisplay(t,l,r,a,o))}),d.addEventListener("blur",k=>{setTimeout(()=>{g||f(d.value)},100)})}};var Ge=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],le={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:typeof window=="object"&&window.navigator.userAgent.indexOf("MSIE")===-1,ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:function(n){return typeof console!="undefined"&&console.warn(n)},getWeek:function(n){var t=new Date(n.getTime());t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7);var e=new Date(t.getFullYear(),0,4);return 1+Math.round(((t.getTime()-e.getTime())/864e5-3+(e.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1};var Ue={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(n){var t=n%100;if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},Ke=Ue;var V=function(n,t){return t===void 0&&(t=2),("000"+n).slice(t*-1)},q=function(n){return n===!0?1:0};function kt(n,t){var e;return function(){var r=this,a=arguments;clearTimeout(e),e=setTimeout(function(){return n.apply(r,a)},t)}}var Xe=function(n){return n instanceof Array?n:[n]};function z(n,t,e){if(e===!0)return n.classList.add(t);n.classList.remove(t)}function P(n,t,e){var r=window.document.createElement(n);return t=t||"",e=e||"",r.className=t,e!==void 0&&(r.textContent=e),r}function Te(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function Dt(n,t){if(t(n))return n;if(n.parentNode)return Dt(n.parentNode,t)}function Fe(n,t){var e=P("div","numInputWrapper"),r=P("input","numInput "+n),a=P("span","arrowUp"),o=P("span","arrowDown");if(navigator.userAgent.indexOf("MSIE 9.0")===-1?r.type="number":(r.type="text",r.pattern="\\d*"),t!==void 0)for(var c in t)r.setAttribute(c,t[c]);return e.appendChild(r),e.appendChild(a),e.appendChild(o),e}function G(n){try{if(typeof n.composedPath=="function"){var t=n.composedPath();return t[0]}return n.target}catch(e){return n.target}}var Et=function(){},Oe=function(n,t,e){return e.months[t?"shorthand":"longhand"][n]},Gt={D:Et,F:function(n,t,e){n.setMonth(e.months.longhand.indexOf(t))},G:function(n,t){n.setHours((n.getHours()>=12?12:0)+parseFloat(t))},H:function(n,t){n.setHours(parseFloat(t))},J:function(n,t){n.setDate(parseFloat(t))},K:function(n,t,e){n.setHours(n.getHours()%12+12*q(new RegExp(e.amPM[1],"i").test(t)))},M:function(n,t,e){n.setMonth(e.months.shorthand.indexOf(t))},S:function(n,t){n.setSeconds(parseFloat(t))},U:function(n,t){return new Date(parseFloat(t)*1e3)},W:function(n,t,e){var r=parseInt(t),a=new Date(n.getFullYear(),0,2+(r-1)*7,0,0,0,0);return a.setDate(a.getDate()-a.getDay()+e.firstDayOfWeek),a},Y:function(n,t){n.setFullYear(parseFloat(t))},Z:function(n,t){return new Date(t)},d:function(n,t){n.setDate(parseFloat(t))},h:function(n,t){n.setHours((n.getHours()>=12?12:0)+parseFloat(t))},i:function(n,t){n.setMinutes(parseFloat(t))},j:function(n,t){n.setDate(parseFloat(t))},l:Et,m:function(n,t){n.setMonth(parseFloat(t)-1)},n:function(n,t){n.setMonth(parseFloat(t)-1)},s:function(n,t){n.setSeconds(parseFloat(t))},u:function(n,t){return new Date(parseFloat(t))},w:Et,y:function(n,t){n.setFullYear(2e3+parseFloat(t))}},ae={D:"",F:"",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},ge={Z:function(n){return n.toISOString()},D:function(n,t,e){return t.weekdays.shorthand[ge.w(n,t,e)]},F:function(n,t,e){return Oe(ge.n(n,t,e)-1,!1,t)},G:function(n,t,e){return V(ge.h(n,t,e))},H:function(n){return V(n.getHours())},J:function(n,t){return t.ordinal!==void 0?n.getDate()+t.ordinal(n.getDate()):n.getDate()},K:function(n,t){return t.amPM[q(n.getHours()>11)]},M:function(n,t){return Oe(n.getMonth(),!0,t)},S:function(n){return V(n.getSeconds())},U:function(n){return n.getTime()/1e3},W:function(n,t,e){return e.getWeek(n)},Y:function(n){return V(n.getFullYear(),4)},d:function(n){return V(n.getDate())},h:function(n){return n.getHours()%12?n.getHours()%12:12},i:function(n){return V(n.getMinutes())},j:function(n){return n.getDate()},l:function(n,t){return t.weekdays.longhand[n.getDay()]},m:function(n){return V(n.getMonth()+1)},n:function(n){return n.getMonth()+1},s:function(n){return n.getSeconds()},u:function(n){return n.getTime()},w:function(n){return n.getDay()},y:function(n){return String(n.getFullYear()).substring(2)}};var Ct=function(n){var t=n.config,e=t===void 0?le:t,r=n.l10n,a=r===void 0?Ue:r,o=n.isMobile,c=o===void 0?!1:o;return function(l,d,g){var f=g||a;return e.formatDate!==void 0&&!c?e.formatDate(l,d,f):d.split("").map(function(p,h,y){return ge[p]&&y[h-1]!=="\\"?ge[p](l,f,e):p!=="\\"?p:""}).join("")}},Qe=function(n){var t=n.config,e=t===void 0?le:t,r=n.l10n,a=r===void 0?Ue:r;return function(o,c,l,d){if(!(o!==0&&!o)){var g=d||a,f,p=o;if(o instanceof Date)f=new Date(o.getTime());else if(typeof o!="string"&&o.toFixed!==void 0)f=new Date(o);else if(typeof o=="string"){var h=c||(e||le).dateFormat,y=String(o).trim();if(y==="today")f=new Date,l=!0;else if(e&&e.parseDate)f=e.parseDate(o,h);else if(/Z$/.test(y)||/GMT$/.test(y))f=new Date(o);else{for(var k=void 0,v=[],x=0,O=0,C="";x<h.length;x++){var T=h[x],I=T==="\\",_=h[x-1]==="\\"||I;if(ae[T]&&!_){C+=ae[T];var j=new RegExp(C).exec(o);j&&(k=!0)&&v[T!=="Y"?"push":"unshift"]({fn:Gt[T],val:j[++O]})}else I||(C+=".")}f=!e||!e.noCalendar?new Date(new Date().getFullYear(),0,1,0,0,0,0):new Date(new Date().setHours(0,0,0,0)),v.forEach(function(te){var ne=te.fn,me=te.val;return f=ne(f,me,g)||f}),f=k?f:void 0}}if(!(f instanceof Date&&!isNaN(f.getTime()))){e.errorHandler(new Error("Invalid date provided: "+p));return}return l===!0&&f.setHours(0,0,0,0),f}}};function U(n,t,e){return e===void 0&&(e=!0),e!==!1?new Date(n.getTime()).setHours(0,0,0,0)-new Date(t.getTime()).setHours(0,0,0,0):n.getTime()-t.getTime()}var Ut=function(n,t,e){return n>Math.min(t,e)&&n<Math.max(t,e)},Ze=function(n,t,e){return n*3600+t*60+e},Kt=function(n){var t=Math.floor(n/3600),e=(n-t*3600)/60;return[t,e,n-t*3600-e*60]},Xt={DAY:864e5};function et(n){var t=n.defaultHour,e=n.defaultMinute,r=n.defaultSeconds;if(n.minDate!==void 0){var a=n.minDate.getHours(),o=n.minDate.getMinutes(),c=n.minDate.getSeconds();t<a&&(t=a),t===a&&e<o&&(e=o),t===a&&e===o&&r<c&&(r=n.minDate.getSeconds())}if(n.maxDate!==void 0){var l=n.maxDate.getHours(),d=n.maxDate.getMinutes();t=Math.min(t,l),t===l&&(e=Math.min(d,e)),t===l&&e===d&&(r=n.maxDate.getSeconds())}return{hours:t,minutes:e,seconds:r}}typeof Object.assign!="function"&&(Object.assign=function(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];if(!n)throw TypeError("Cannot convert undefined or null to object");for(var r=function(l){l&&Object.keys(l).forEach(function(d){return n[d]=l[d]})},a=0,o=t;a<o.length;a++){var c=o[a];r(c)}return n});var J=function(){return J=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++){t=arguments[e];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a])}return n},J.apply(this,arguments)},Qt=function(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;for(var r=Array(n),a=0,t=0;t<e;t++)for(var o=arguments[t],c=0,l=o.length;c<l;c++,a++)r[a]=o[c];return r},fr=300;function pr(n,t){var e={config:J(J({},le),W.defaultConfig),l10n:Ke};e.parseDate=Qe({config:e.config,l10n:e.l10n}),e._handlers=[],e.pluginElements=[],e.loadedPlugins=[],e._bind=v,e._setHoursFromDate=h,e._positionCalendar=Ye,e.changeMonth=mt,e.changeYear=Ne,e.clear=Ln,e.close=jn,e.onMouseOver=Ae,e._createElement=P,e.createDay=j,e.destroy=Nn,e.isEnabled=ue,e.jumpToDate=C,e.updateValue=re,e.open=Yn,e.redraw=$t,e.set=$n,e.setDate=Bn,e.toggle=qn;function r(){e.utils={getDaysInMonth:function(i,s){return i===void 0&&(i=e.currentMonth),s===void 0&&(s=e.currentYear),i===1&&(s%4===0&&s%100!==0||s%400===0)?29:e.l10n.daysInMonth[i]}}}function a(){e.element=e.input=n,e.isOpen=!1,Hn(),_t(),zn(),Vn(),r(),e.isMobile||_(),O(),(e.selectedDates.length||e.config.noCalendar)&&(e.config.enableTime&&h(e.config.noCalendar?e.latestSelectedDateObj:void 0),re(!1)),l();var i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!e.isMobile&&i&&Ye(),R("onReady")}function o(){var i;return((i=e.calendarContainer)===null||i===void 0?void 0:i.getRootNode()).activeElement||document.activeElement}function c(i){return i.bind(e)}function l(){var i=e.config;i.weekNumbers===!1&&i.showMonths===1||i.noCalendar!==!0&&window.requestAnimationFrame(function(){if(e.calendarContainer!==void 0&&(e.calendarContainer.style.visibility="hidden",e.calendarContainer.style.display="block"),e.daysContainer!==void 0){var s=(e.days.offsetWidth+1)*i.showMonths;e.daysContainer.style.width=s+"px",e.calendarContainer.style.width=s+(e.weekWrapper!==void 0?e.weekWrapper.offsetWidth:0)+"px",e.calendarContainer.style.removeProperty("visibility"),e.calendarContainer.style.removeProperty("display")}})}function d(i){if(e.selectedDates.length===0){var s=e.config.minDate===void 0||U(new Date,e.config.minDate)>=0?new Date:new Date(e.config.minDate.getTime()),u=et(e.config);s.setHours(u.hours,u.minutes,u.seconds,s.getMilliseconds()),e.selectedDates=[s],e.latestSelectedDateObj=s}i!==void 0&&i.type!=="blur"&&Kn(i);var m=e._input.value;p(),re(),e._input.value!==m&&e._debouncedChange()}function g(i,s){return i%12+12*q(s===e.l10n.amPM[1])}function f(i){switch(i%24){case 0:case 12:return 12;default:return i%12}}function p(){if(!(e.hourElement===void 0||e.minuteElement===void 0)){var i=(parseInt(e.hourElement.value.slice(-2),10)||0)%24,s=(parseInt(e.minuteElement.value,10)||0)%60,u=e.secondElement!==void 0?(parseInt(e.secondElement.value,10)||0)%60:0;e.amPM!==void 0&&(i=g(i,e.amPM.textContent));var m=e.config.minTime!==void 0||e.config.minDate&&e.minDateHasTime&&e.latestSelectedDateObj&&U(e.latestSelectedDateObj,e.config.minDate,!0)===0,b=e.config.maxTime!==void 0||e.config.maxDate&&e.maxDateHasTime&&e.latestSelectedDateObj&&U(e.latestSelectedDateObj,e.config.maxDate,!0)===0;if(e.config.maxTime!==void 0&&e.config.minTime!==void 0&&e.config.minTime>e.config.maxTime){var w=Ze(e.config.minTime.getHours(),e.config.minTime.getMinutes(),e.config.minTime.getSeconds()),F=Ze(e.config.maxTime.getHours(),e.config.maxTime.getMinutes(),e.config.maxTime.getSeconds()),E=Ze(i,s,u);if(E>F&&E<w){var S=Kt(w);i=S[0],s=S[1],u=S[2]}}else{if(b){var D=e.config.maxTime!==void 0?e.config.maxTime:e.config.maxDate;i=Math.min(i,D.getHours()),i===D.getHours()&&(s=Math.min(s,D.getMinutes())),s===D.getMinutes()&&(u=Math.min(u,D.getSeconds()))}if(m){var M=e.config.minTime!==void 0?e.config.minTime:e.config.minDate;i=Math.max(i,M.getHours()),i===M.getHours()&&s<M.getMinutes()&&(s=M.getMinutes()),s===M.getMinutes()&&(u=Math.max(u,M.getSeconds()))}}y(i,s,u)}}function h(i){var s=i||e.latestSelectedDateObj;s&&s instanceof Date&&y(s.getHours(),s.getMinutes(),s.getSeconds())}function y(i,s,u){e.latestSelectedDateObj!==void 0&&e.latestSelectedDateObj.setHours(i%24,s,u||0,0),!(!e.hourElement||!e.minuteElement||e.isMobile)&&(e.hourElement.value=V(e.config.time_24hr?i:(12+i)%12+12*q(i%12===0)),e.minuteElement.value=V(s),e.amPM!==void 0&&(e.amPM.textContent=e.l10n.amPM[q(i>=12)]),e.secondElement!==void 0&&(e.secondElement.value=V(u)))}function k(i){var s=G(i),u=parseInt(s.value)+(i.delta||0);(u/1e3>1||i.key==="Enter"&&!/[^\d]/.test(u.toString()))&&Ne(u)}function v(i,s,u,m){if(s instanceof Array)return s.forEach(function(b){return v(i,b,u,m)});if(i instanceof Array)return i.forEach(function(b){return v(b,s,u,m)});i.addEventListener(s,u,m),e._handlers.push({remove:function(){return i.removeEventListener(s,u,m)}})}function x(){R("onChange")}function O(){if(e.config.wrap&&["open","close","toggle","clear"].forEach(function(u){Array.prototype.forEach.call(e.element.querySelectorAll("[data-"+u+"]"),function(m){return v(m,"click",e[u])})}),e.isMobile){Jn();return}var i=kt(An,50);if(e._debouncedChange=kt(x,fr),e.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&v(e.daysContainer,"mouseover",function(u){e.config.mode==="range"&&Ae(G(u))}),v(e._input,"keydown",Yt),e.calendarContainer!==void 0&&v(e.calendarContainer,"keydown",Yt),!e.config.inline&&!e.config.static&&v(window,"resize",i),window.ontouchstart!==void 0?v(window.document,"touchstart",ht):v(window.document,"mousedown",ht),v(window.document,"focus",ht,{capture:!0}),e.config.clickOpens===!0&&(v(e._input,"focus",e.open),v(e._input,"click",e.open)),e.daysContainer!==void 0&&(v(e.monthNav,"click",Un),v(e.monthNav,["keyup","increment"],k),v(e.daysContainer,"click",Bt)),e.timeContainer!==void 0&&e.minuteElement!==void 0&&e.hourElement!==void 0){var s=function(u){return G(u).select()};v(e.timeContainer,["increment"],d),v(e.timeContainer,"blur",d,{capture:!0}),v(e.timeContainer,"click",T),v([e.hourElement,e.minuteElement],["focus","click"],s),e.secondElement!==void 0&&v(e.secondElement,"focus",function(){return e.secondElement&&e.secondElement.select()}),e.amPM!==void 0&&v(e.amPM,"click",function(u){d(u)})}e.config.allowInput&&v(e._input,"blur",Rn)}function C(i,s){var u=i!==void 0?e.parseDate(i):e.latestSelectedDateObj||(e.config.minDate&&e.config.minDate>e.now?e.config.minDate:e.config.maxDate&&e.config.maxDate<e.now?e.config.maxDate:e.now),m=e.currentYear,b=e.currentMonth;try{u!==void 0&&(e.currentYear=u.getFullYear(),e.currentMonth=u.getMonth())}catch(w){w.message="Invalid date supplied: "+u,e.config.errorHandler(w)}s&&e.currentYear!==m&&(R("onYearChange"),Y()),s&&(e.currentYear!==m||e.currentMonth!==b)&&R("onMonthChange"),e.redraw()}function T(i){var s=G(i);~s.className.indexOf("arrow")&&I(i,s.classList.contains("arrowUp")?1:-1)}function I(i,s,u){var m=i&&G(i),b=u||m&&m.parentNode&&m.parentNode.firstChild,w=bt("increment");w.delta=s,b&&b.dispatchEvent(w)}function _(){var i=window.document.createDocumentFragment();if(e.calendarContainer=P("div","flatpickr-calendar"),e.calendarContainer.tabIndex=-1,!e.config.noCalendar){if(i.appendChild(Sn()),e.innerContainer=P("div","flatpickr-innerContainer"),e.config.weekNumbers){var s=Pn(),u=s.weekWrapper,m=s.weekNumbers;e.innerContainer.appendChild(u),e.weekNumbers=m,e.weekWrapper=u}e.rContainer=P("div","flatpickr-rContainer"),e.rContainer.appendChild(Rt()),e.daysContainer||(e.daysContainer=P("div","flatpickr-days"),e.daysContainer.tabIndex=-1),$(),e.rContainer.appendChild(e.daysContainer),e.innerContainer.appendChild(e.rContainer),i.appendChild(e.innerContainer)}e.config.enableTime&&i.appendChild(In()),z(e.calendarContainer,"rangeMode",e.config.mode==="range"),z(e.calendarContainer,"animate",e.config.animate===!0),z(e.calendarContainer,"multiMonth",e.config.showMonths>1),e.calendarContainer.appendChild(i);var b=e.config.appendTo!==void 0&&e.config.appendTo.nodeType!==void 0;if((e.config.inline||e.config.static)&&(e.calendarContainer.classList.add(e.config.inline?"inline":"static"),e.config.inline&&(!b&&e.element.parentNode?e.element.parentNode.insertBefore(e.calendarContainer,e._input.nextSibling):e.config.appendTo!==void 0&&e.config.appendTo.appendChild(e.calendarContainer)),e.config.static)){var w=P("div","flatpickr-wrapper");e.element.parentNode&&e.element.parentNode.insertBefore(w,e.element),w.appendChild(e.element),e.altInput&&w.appendChild(e.altInput),w.appendChild(e.calendarContainer)}!e.config.static&&!e.config.inline&&(e.config.appendTo!==void 0?e.config.appendTo:window.document.body).appendChild(e.calendarContainer)}function j(i,s,u,m){var b=ue(s,!0),w=P("span",i,s.getDate().toString());return w.dateObj=s,w.$i=m,w.setAttribute("aria-label",e.formatDate(s,e.config.ariaDateFormat)),i.indexOf("hidden")===-1&&U(s,e.now)===0&&(e.todayDateElem=w,w.classList.add("today"),w.setAttribute("aria-current","date")),b?(w.tabIndex=-1,vt(s)&&(w.classList.add("selected"),e.selectedDateElem=w,e.config.mode==="range"&&(z(w,"startRange",e.selectedDates[0]&&U(s,e.selectedDates[0],!0)===0),z(w,"endRange",e.selectedDates[1]&&U(s,e.selectedDates[1],!0)===0),i==="nextMonthDay"&&w.classList.add("inRange")))):w.classList.add("flatpickr-disabled"),e.config.mode==="range"&&Gn(s)&&!vt(s)&&w.classList.add("inRange"),e.weekNumbers&&e.config.showMonths===1&&i!=="prevMonthDay"&&m%7===6&&e.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+e.config.getWeek(s)+"</span>"),R("onDayCreate",w),w}function te(i){i.focus(),e.config.mode==="range"&&Ae(i)}function ne(i){for(var s=i>0?0:e.config.showMonths-1,u=i>0?e.config.showMonths:-1,m=s;m!=u;m+=i)for(var b=e.daysContainer.children[m],w=i>0?0:b.children.length-1,F=i>0?b.children.length:-1,E=w;E!=F;E+=i){var S=b.children[E];if(S.className.indexOf("hidden")===-1&&ue(S.dateObj))return S}}function me(i,s){for(var u=i.className.indexOf("Month")===-1?i.dateObj.getMonth():e.currentMonth,m=s>0?e.config.showMonths:-1,b=s>0?1:-1,w=u-e.currentMonth;w!=m;w+=b)for(var F=e.daysContainer.children[w],E=u-e.currentMonth===w?i.$i+s:s<0?F.children.length-1:0,S=F.children.length,D=E;D>=0&&D<S&&D!=(s>0?S:-1);D+=b){var M=F.children[D];if(M.className.indexOf("hidden")===-1&&ue(M.dateObj)&&Math.abs(i.$i-D)>=Math.abs(s))return te(M)}e.changeMonth(b),se(ne(b),0)}function se(i,s){var u=o(),m=Re(u||document.body),b=i!==void 0?i:m?u:e.selectedDateElem!==void 0&&Re(e.selectedDateElem)?e.selectedDateElem:e.todayDateElem!==void 0&&Re(e.todayDateElem)?e.todayDateElem:ne(s>0?1:-1);b===void 0?e._input.focus():m?me(b,s):te(b)}function je(i,s){for(var u=(new Date(i,s,1).getDay()-e.l10n.firstDayOfWeek+7)%7,m=e.utils.getDaysInMonth((s-1+12)%12,i),b=e.utils.getDaysInMonth(s,i),w=window.document.createDocumentFragment(),F=e.config.showMonths>1,E=F?"prevMonthDay hidden":"prevMonthDay",S=F?"nextMonthDay hidden":"nextMonthDay",D=m+1-u,M=0;D<=m;D++,M++)w.appendChild(j("flatpickr-day "+E,new Date(i,s-1,D),D,M));for(D=1;D<=b;D++,M++)w.appendChild(j("flatpickr-day",new Date(i,s,D),D,M));for(var N=b+1;N<=42-u&&(e.config.showMonths===1||M%7!==0);N++,M++)w.appendChild(j("flatpickr-day "+S,new Date(i,s+1,N%b),N,M));var Z=P("div","dayContainer");return Z.appendChild(w),Z}function $(){if(e.daysContainer!==void 0){Te(e.daysContainer),e.weekNumbers&&Te(e.weekNumbers);for(var i=document.createDocumentFragment(),s=0;s<e.config.showMonths;s++){var u=new Date(e.currentYear,e.currentMonth,1);u.setMonth(e.currentMonth+s),i.appendChild(je(u.getFullYear(),u.getMonth()))}e.daysContainer.appendChild(i),e.days=e.daysContainer.firstChild,e.config.mode==="range"&&e.selectedDates.length===1&&Ae()}}function Y(){if(!(e.config.showMonths>1||e.config.monthSelectorType!=="dropdown")){var i=function(m){return e.config.minDate!==void 0&&e.currentYear===e.config.minDate.getFullYear()&&m<e.config.minDate.getMonth()?!1:!(e.config.maxDate!==void 0&&e.currentYear===e.config.maxDate.getFullYear()&&m>e.config.maxDate.getMonth())};e.monthsDropdownContainer.tabIndex=-1,e.monthsDropdownContainer.innerHTML="";for(var s=0;s<12;s++)if(i(s)){var u=P("option","flatpickr-monthDropdown-month");u.value=new Date(e.currentYear,s).getMonth().toString(),u.textContent=Oe(s,e.config.shorthandCurrentMonth,e.l10n),u.tabIndex=-1,e.currentMonth===s&&(u.selected=!0),e.monthsDropdownContainer.appendChild(u)}}}function Ee(){var i=P("div","flatpickr-month"),s=window.document.createDocumentFragment(),u;e.config.showMonths>1||e.config.monthSelectorType==="static"?u=P("span","cur-month"):(e.monthsDropdownContainer=P("select","flatpickr-monthDropdown-months"),e.monthsDropdownContainer.setAttribute("aria-label",e.l10n.monthAriaLabel),v(e.monthsDropdownContainer,"change",function(F){var E=G(F),S=parseInt(E.value,10);e.changeMonth(S-e.currentMonth),R("onMonthChange")}),Y(),u=e.monthsDropdownContainer);var m=Fe("cur-year",{tabindex:"-1"}),b=m.getElementsByTagName("input")[0];b.setAttribute("aria-label",e.l10n.yearAriaLabel),e.config.minDate&&b.setAttribute("min",e.config.minDate.getFullYear().toString()),e.config.maxDate&&(b.setAttribute("max",e.config.maxDate.getFullYear().toString()),b.disabled=!!e.config.minDate&&e.config.minDate.getFullYear()===e.config.maxDate.getFullYear());var w=P("div","flatpickr-current-month");return w.appendChild(u),w.appendChild(m),s.appendChild(w),i.appendChild(s),{container:i,yearElement:b,monthElement:u}}function Nt(){Te(e.monthNav),e.monthNav.appendChild(e.prevMonthNav),e.config.showMonths&&(e.yearElements=[],e.monthElements=[]);for(var i=e.config.showMonths;i--;){var s=Ee();e.yearElements.push(s.yearElement),e.monthElements.push(s.monthElement),e.monthNav.appendChild(s.container)}e.monthNav.appendChild(e.nextMonthNav)}function Sn(){return e.monthNav=P("div","flatpickr-months"),e.yearElements=[],e.monthElements=[],e.prevMonthNav=P("span","flatpickr-prev-month"),e.prevMonthNav.innerHTML=e.config.prevArrow,e.nextMonthNav=P("span","flatpickr-next-month"),e.nextMonthNav.innerHTML=e.config.nextArrow,Nt(),Object.defineProperty(e,"_hidePrevMonthArrow",{get:function(){return e.__hidePrevMonthArrow},set:function(i){e.__hidePrevMonthArrow!==i&&(z(e.prevMonthNav,"flatpickr-disabled",i),e.__hidePrevMonthArrow=i)}}),Object.defineProperty(e,"_hideNextMonthArrow",{get:function(){return e.__hideNextMonthArrow},set:function(i){e.__hideNextMonthArrow!==i&&(z(e.nextMonthNav,"flatpickr-disabled",i),e.__hideNextMonthArrow=i)}}),e.currentYearElement=e.yearElements[0],We(),e.monthNav}function In(){e.calendarContainer.classList.add("hasTime"),e.config.noCalendar&&e.calendarContainer.classList.add("noCalendar");var i=et(e.config);e.timeContainer=P("div","flatpickr-time"),e.timeContainer.tabIndex=-1;var s=P("span","flatpickr-time-separator",":"),u=Fe("flatpickr-hour",{"aria-label":e.l10n.hourAriaLabel});e.hourElement=u.getElementsByTagName("input")[0];var m=Fe("flatpickr-minute",{"aria-label":e.l10n.minuteAriaLabel});if(e.minuteElement=m.getElementsByTagName("input")[0],e.hourElement.tabIndex=e.minuteElement.tabIndex=-1,e.hourElement.value=V(e.latestSelectedDateObj?e.latestSelectedDateObj.getHours():e.config.time_24hr?i.hours:f(i.hours)),e.minuteElement.value=V(e.latestSelectedDateObj?e.latestSelectedDateObj.getMinutes():i.minutes),e.hourElement.setAttribute("step",e.config.hourIncrement.toString()),e.minuteElement.setAttribute("step",e.config.minuteIncrement.toString()),e.hourElement.setAttribute("min",e.config.time_24hr?"0":"1"),e.hourElement.setAttribute("max",e.config.time_24hr?"23":"12"),e.hourElement.setAttribute("maxlength","2"),e.minuteElement.setAttribute("min","0"),e.minuteElement.setAttribute("max","59"),e.minuteElement.setAttribute("maxlength","2"),e.timeContainer.appendChild(u),e.timeContainer.appendChild(s),e.timeContainer.appendChild(m),e.config.time_24hr&&e.timeContainer.classList.add("time24hr"),e.config.enableSeconds){e.timeContainer.classList.add("hasSeconds");var b=Fe("flatpickr-second");e.secondElement=b.getElementsByTagName("input")[0],e.secondElement.value=V(e.latestSelectedDateObj?e.latestSelectedDateObj.getSeconds():i.seconds),e.secondElement.setAttribute("step",e.minuteElement.getAttribute("step")),e.secondElement.setAttribute("min","0"),e.secondElement.setAttribute("max","59"),e.secondElement.setAttribute("maxlength","2"),e.timeContainer.appendChild(P("span","flatpickr-time-separator",":")),e.timeContainer.appendChild(b)}return e.config.time_24hr||(e.amPM=P("span","flatpickr-am-pm",e.l10n.amPM[q((e.latestSelectedDateObj?e.hourElement.value:e.config.defaultHour)>11)]),e.amPM.title=e.l10n.toggleTitle,e.amPM.tabIndex=-1,e.timeContainer.appendChild(e.amPM)),e.timeContainer}function Rt(){e.weekdayContainer?Te(e.weekdayContainer):e.weekdayContainer=P("div","flatpickr-weekdays");for(var i=e.config.showMonths;i--;){var s=P("div","flatpickr-weekdaycontainer");e.weekdayContainer.appendChild(s)}return At(),e.weekdayContainer}function At(){if(e.weekdayContainer){var i=e.l10n.firstDayOfWeek,s=Qt(e.l10n.weekdays.shorthand);i>0&&i<s.length&&(s=Qt(s.splice(i,s.length),s.splice(0,i)));for(var u=e.config.showMonths;u--;)e.weekdayContainer.children[u].innerHTML=`
      <span class='flatpickr-weekday'>
        `+s.join("</span><span class='flatpickr-weekday'>")+`
      </span>
      `}}function Pn(){e.calendarContainer.classList.add("hasWeeks");var i=P("div","flatpickr-weekwrapper");i.appendChild(P("span","flatpickr-weekday",e.l10n.weekAbbreviation));var s=P("div","flatpickr-weeks");return i.appendChild(s),{weekWrapper:i,weekNumbers:s}}function mt(i,s){s===void 0&&(s=!0);var u=s?i:i-e.currentMonth;u<0&&e._hidePrevMonthArrow===!0||u>0&&e._hideNextMonthArrow===!0||(e.currentMonth+=u,(e.currentMonth<0||e.currentMonth>11)&&(e.currentYear+=e.currentMonth>11?1:-1,e.currentMonth=(e.currentMonth+12)%12,R("onYearChange"),Y()),$(),R("onMonthChange"),We())}function Ln(i,s){if(i===void 0&&(i=!0),s===void 0&&(s=!0),e.input.value="",e.altInput!==void 0&&(e.altInput.value=""),e.mobileInput!==void 0&&(e.mobileInput.value=""),e.selectedDates=[],e.latestSelectedDateObj=void 0,s===!0&&(e.currentYear=e._initialDate.getFullYear(),e.currentMonth=e._initialDate.getMonth()),e.config.enableTime===!0){var u=et(e.config),m=u.hours,b=u.minutes,w=u.seconds;y(m,b,w)}e.redraw(),i&&R("onChange")}function jn(){e.isOpen=!1,e.isMobile||(e.calendarContainer!==void 0&&e.calendarContainer.classList.remove("open"),e._input!==void 0&&e._input.classList.remove("active")),R("onClose")}function Nn(){e.config!==void 0&&R("onDestroy");for(var i=e._handlers.length;i--;)e._handlers[i].remove();if(e._handlers=[],e.mobileInput)e.mobileInput.parentNode&&e.mobileInput.parentNode.removeChild(e.mobileInput),e.mobileInput=void 0;else if(e.calendarContainer&&e.calendarContainer.parentNode)if(e.config.static&&e.calendarContainer.parentNode){var s=e.calendarContainer.parentNode;if(s.lastChild&&s.removeChild(s.lastChild),s.parentNode){for(;s.firstChild;)s.parentNode.insertBefore(s.firstChild,s);s.parentNode.removeChild(s)}}else e.calendarContainer.parentNode.removeChild(e.calendarContainer);e.altInput&&(e.input.type="text",e.altInput.parentNode&&e.altInput.parentNode.removeChild(e.altInput),delete e.altInput),e.input&&(e.input.type=e.input._type,e.input.classList.remove("flatpickr-input"),e.input.removeAttribute("readonly")),["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach(function(u){try{delete e[u]}catch(m){}})}function Ce(i){return e.calendarContainer.contains(i)}function ht(i){if(e.isOpen&&!e.config.inline){var s=G(i),u=Ce(s),m=s===e.input||s===e.altInput||e.element.contains(s)||i.path&&i.path.indexOf&&(~i.path.indexOf(e.input)||~i.path.indexOf(e.altInput)),b=!m&&!u&&!Ce(i.relatedTarget),w=!e.config.ignoredFocusElements.some(function(F){return F.contains(s)});b&&w&&(e.config.allowInput&&e.setDate(e._input.value,!1,e.config.altInput?e.config.altFormat:e.config.dateFormat),e.timeContainer!==void 0&&e.minuteElement!==void 0&&e.hourElement!==void 0&&e.input.value!==""&&e.input.value!==void 0&&d(),e.close(),e.config&&e.config.mode==="range"&&e.selectedDates.length===1&&e.clear(!1))}}function Ne(i){if(!(!i||e.config.minDate&&i<e.config.minDate.getFullYear()||e.config.maxDate&&i>e.config.maxDate.getFullYear())){var s=i,u=e.currentYear!==s;e.currentYear=s||e.currentYear,e.config.maxDate&&e.currentYear===e.config.maxDate.getFullYear()?e.currentMonth=Math.min(e.config.maxDate.getMonth(),e.currentMonth):e.config.minDate&&e.currentYear===e.config.minDate.getFullYear()&&(e.currentMonth=Math.max(e.config.minDate.getMonth(),e.currentMonth)),u&&(e.redraw(),R("onYearChange"),Y())}}function ue(i,s){var u;s===void 0&&(s=!0);var m=e.parseDate(i,void 0,s);if(e.config.minDate&&m&&U(m,e.config.minDate,s!==void 0?s:!e.minDateHasTime)<0||e.config.maxDate&&m&&U(m,e.config.maxDate,s!==void 0?s:!e.maxDateHasTime)>0)return!1;if(!e.config.enable&&e.config.disable.length===0)return!0;if(m===void 0)return!1;for(var b=!!e.config.enable,w=(u=e.config.enable)!==null&&u!==void 0?u:e.config.disable,F=0,E=void 0;F<w.length;F++){if(E=w[F],typeof E=="function"&&E(m))return b;if(E instanceof Date&&m!==void 0&&E.getTime()===m.getTime())return b;if(typeof E=="string"){var S=e.parseDate(E,void 0,!0);return S&&S.getTime()===m.getTime()?b:!b}else if(typeof E=="object"&&m!==void 0&&E.from&&E.to&&m.getTime()>=E.from.getTime()&&m.getTime()<=E.to.getTime())return b}return!b}function Re(i){return e.daysContainer!==void 0?i.className.indexOf("hidden")===-1&&i.className.indexOf("flatpickr-disabled")===-1&&e.daysContainer.contains(i):!1}function Rn(i){var s=i.target===e._input,u=e._input.value.trimEnd()!==wt();s&&u&&!(i.relatedTarget&&Ce(i.relatedTarget))&&e.setDate(e._input.value,!0,i.target===e.altInput?e.config.altFormat:e.config.dateFormat)}function Yt(i){var s=G(i),u=e.config.wrap?n.contains(s):s===e._input,m=e.config.allowInput,b=e.isOpen&&(!m||!u),w=e.config.inline&&u&&!m;if(i.keyCode===13&&u){if(m)return e.setDate(e._input.value,!0,s===e.altInput?e.config.altFormat:e.config.dateFormat),e.close(),s.blur();e.open()}else if(Ce(s)||b||w){var F=!!e.timeContainer&&e.timeContainer.contains(s);switch(i.keyCode){case 13:F?(i.preventDefault(),d(),gt()):Bt(i);break;case 27:i.preventDefault(),gt();break;case 8:case 46:u&&!e.config.allowInput&&(i.preventDefault(),e.clear());break;case 37:case 39:if(!F&&!u){i.preventDefault();var E=o();if(e.daysContainer!==void 0&&(m===!1||E&&Re(E))){var S=i.keyCode===39?1:-1;i.ctrlKey?(i.stopPropagation(),mt(S),se(ne(1),0)):se(void 0,S)}}else e.hourElement&&e.hourElement.focus();break;case 38:case 40:i.preventDefault();var D=i.keyCode===40?1:-1;e.daysContainer&&s.$i!==void 0||s===e.input||s===e.altInput?i.ctrlKey?(i.stopPropagation(),Ne(e.currentYear-D),se(ne(1),0)):F||se(void 0,D*7):s===e.currentYearElement?Ne(e.currentYear-D):e.config.enableTime&&(!F&&e.hourElement&&e.hourElement.focus(),d(i),e._debouncedChange());break;case 9:if(F){var M=[e.hourElement,e.minuteElement,e.secondElement,e.amPM].concat(e.pluginElements).filter(function(X){return X}),N=M.indexOf(s);if(N!==-1){var Z=M[N+(i.shiftKey?-1:1)];i.preventDefault(),(Z||e._input).focus()}}else!e.config.noCalendar&&e.daysContainer&&e.daysContainer.contains(s)&&i.shiftKey&&(i.preventDefault(),e._input.focus());break;default:break}}if(e.amPM!==void 0&&s===e.amPM)switch(i.key){case e.l10n.amPM[0].charAt(0):case e.l10n.amPM[0].charAt(0).toLowerCase():e.amPM.textContent=e.l10n.amPM[0],p(),re();break;case e.l10n.amPM[1].charAt(0):case e.l10n.amPM[1].charAt(0).toLowerCase():e.amPM.textContent=e.l10n.amPM[1],p(),re();break}(u||Ce(s))&&R("onKeyDown",i)}function Ae(i,s){if(s===void 0&&(s="flatpickr-day"),!(e.selectedDates.length!==1||i&&(!i.classList.contains(s)||i.classList.contains("flatpickr-disabled")))){for(var u=i?i.dateObj.getTime():e.days.firstElementChild.dateObj.getTime(),m=e.parseDate(e.selectedDates[0],void 0,!0).getTime(),b=Math.min(u,e.selectedDates[0].getTime()),w=Math.max(u,e.selectedDates[0].getTime()),F=!1,E=0,S=0,D=b;D<w;D+=Xt.DAY)ue(new Date(D),!0)||(F=F||D>b&&D<w,D<m&&(!E||D>E)?E=D:D>m&&(!S||D<S)&&(S=D));var M=Array.from(e.rContainer.querySelectorAll("*:nth-child(-n+"+e.config.showMonths+") > ."+s));M.forEach(function(N){var Z=N.dateObj,X=Z.getTime(),Me=E>0&&X<E||S>0&&X>S;if(Me){N.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach(function(he){N.classList.remove(he)});return}else if(F&&!Me)return;["startRange","inRange","endRange","notAllowed"].forEach(function(he){N.classList.remove(he)}),i!==void 0&&(i.classList.add(u<=e.selectedDates[0].getTime()?"startRange":"endRange"),m<u&&X===m?N.classList.add("startRange"):m>u&&X===m&&N.classList.add("endRange"),X>=E&&(S===0||X<=S)&&Ut(X,m,u)&&N.classList.add("inRange"))})}}function An(){e.isOpen&&!e.config.static&&!e.config.inline&&Ye()}function Yn(i,s){if(s===void 0&&(s=e._positionElement),e.isMobile===!0){if(i){i.preventDefault();var u=G(i);u&&u.blur()}e.mobileInput!==void 0&&(e.mobileInput.focus(),e.mobileInput.click()),R("onOpen");return}else if(e._input.disabled||e.config.inline)return;var m=e.isOpen;e.isOpen=!0,m||(e.calendarContainer.classList.add("open"),e._input.classList.add("active"),R("onOpen"),Ye(s)),e.config.enableTime===!0&&e.config.noCalendar===!0&&e.config.allowInput===!1&&(i===void 0||!e.timeContainer.contains(i.relatedTarget))&&setTimeout(function(){return e.hourElement.select()},50)}function Ht(i){return function(s){var u=e.config["_"+i+"Date"]=e.parseDate(s,e.config.dateFormat),m=e.config["_"+(i==="min"?"max":"min")+"Date"];u!==void 0&&(e[i==="min"?"minDateHasTime":"maxDateHasTime"]=u.getHours()>0||u.getMinutes()>0||u.getSeconds()>0),e.selectedDates&&(e.selectedDates=e.selectedDates.filter(function(b){return ue(b)}),!e.selectedDates.length&&i==="min"&&h(u),re()),e.daysContainer&&($t(),u!==void 0?e.currentYearElement[i]=u.getFullYear().toString():e.currentYearElement.removeAttribute(i),e.currentYearElement.disabled=!!m&&u!==void 0&&m.getFullYear()===u.getFullYear())}}function Hn(){var i=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],s=J(J({},JSON.parse(JSON.stringify(n.dataset||{}))),t),u={};e.config.parseDate=s.parseDate,e.config.formatDate=s.formatDate,Object.defineProperty(e.config,"enable",{get:function(){return e.config._enable},set:function(M){e.config._enable=zt(M)}}),Object.defineProperty(e.config,"disable",{get:function(){return e.config._disable},set:function(M){e.config._disable=zt(M)}});var m=s.mode==="time";if(!s.dateFormat&&(s.enableTime||m)){var b=W.defaultConfig.dateFormat||le.dateFormat;u.dateFormat=s.noCalendar||m?"H:i"+(s.enableSeconds?":S":""):b+" H:i"+(s.enableSeconds?":S":"")}if(s.altInput&&(s.enableTime||m)&&!s.altFormat){var w=W.defaultConfig.altFormat||le.altFormat;u.altFormat=s.noCalendar||m?"h:i"+(s.enableSeconds?":S K":" K"):w+(" h:i"+(s.enableSeconds?":S":"")+" K")}Object.defineProperty(e.config,"minDate",{get:function(){return e.config._minDate},set:Ht("min")}),Object.defineProperty(e.config,"maxDate",{get:function(){return e.config._maxDate},set:Ht("max")});var F=function(M){return function(N){e.config[M==="min"?"_minTime":"_maxTime"]=e.parseDate(N,"H:i:S")}};Object.defineProperty(e.config,"minTime",{get:function(){return e.config._minTime},set:F("min")}),Object.defineProperty(e.config,"maxTime",{get:function(){return e.config._maxTime},set:F("max")}),s.mode==="time"&&(e.config.noCalendar=!0,e.config.enableTime=!0),Object.assign(e.config,u,s);for(var E=0;E<i.length;E++)e.config[i[E]]=e.config[i[E]]===!0||e.config[i[E]]==="true";Ge.filter(function(M){return e.config[M]!==void 0}).forEach(function(M){e.config[M]=Xe(e.config[M]||[]).map(c)}),e.isMobile=!e.config.disableMobile&&!e.config.inline&&e.config.mode==="single"&&!e.config.disable.length&&!e.config.enable&&!e.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(var E=0;E<e.config.plugins.length;E++){var S=e.config.plugins[E](e)||{};for(var D in S)Ge.indexOf(D)>-1?e.config[D]=Xe(S[D]).map(c).concat(e.config[D]):typeof s[D]=="undefined"&&(e.config[D]=S[D])}s.altInputClass||(e.config.altInputClass=Wt().className+" "+e.config.altInputClass),R("onParseConfig")}function Wt(){return e.config.wrap?n.querySelector("[data-input]"):n}function _t(){typeof e.config.locale!="object"&&typeof W.l10ns[e.config.locale]=="undefined"&&e.config.errorHandler(new Error("flatpickr: invalid locale "+e.config.locale)),e.l10n=J(J({},W.l10ns.default),typeof e.config.locale=="object"?e.config.locale:e.config.locale!=="default"?W.l10ns[e.config.locale]:void 0),ae.D="("+e.l10n.weekdays.shorthand.join("|")+")",ae.l="("+e.l10n.weekdays.longhand.join("|")+")",ae.M="("+e.l10n.months.shorthand.join("|")+")",ae.F="("+e.l10n.months.longhand.join("|")+")",ae.K="("+e.l10n.amPM[0]+"|"+e.l10n.amPM[1]+"|"+e.l10n.amPM[0].toLowerCase()+"|"+e.l10n.amPM[1].toLowerCase()+")";var i=J(J({},t),JSON.parse(JSON.stringify(n.dataset||{})));i.time_24hr===void 0&&W.defaultConfig.time_24hr===void 0&&(e.config.time_24hr=e.l10n.time_24hr),e.formatDate=Ct(e),e.parseDate=Qe({config:e.config,l10n:e.l10n})}function Ye(i){if(typeof e.config.position=="function")return void e.config.position(e,i);if(e.calendarContainer!==void 0){R("onPreCalendarPosition");var s=i||e._positionElement,u=Array.prototype.reduce.call(e.calendarContainer.children,(function(ar,ir){return ar+ir.offsetHeight}),0),m=e.calendarContainer.offsetWidth,b=e.config.position.split(" "),w=b[0],F=b.length>1?b[1]:null,E=s.getBoundingClientRect(),S=window.innerHeight-E.bottom,D=w==="above"||w!=="below"&&S<u&&E.top>u,M=window.pageYOffset+E.top+(D?-u-2:s.offsetHeight+2);if(z(e.calendarContainer,"arrowTop",!D),z(e.calendarContainer,"arrowBottom",D),!e.config.inline){var N=window.pageXOffset+E.left,Z=!1,X=!1;F==="center"?(N-=(m-E.width)/2,Z=!0):F==="right"&&(N-=m-E.width,X=!0),z(e.calendarContainer,"arrowLeft",!Z&&!X),z(e.calendarContainer,"arrowCenter",Z),z(e.calendarContainer,"arrowRight",X);var Me=window.document.body.offsetWidth-(window.pageXOffset+E.right),he=N+m>window.document.body.offsetWidth,Xn=Me+m>window.document.body.offsetWidth;if(z(e.calendarContainer,"rightMost",he),!e.config.static)if(e.calendarContainer.style.top=M+"px",!he)e.calendarContainer.style.left=N+"px",e.calendarContainer.style.right="auto";else if(!Xn)e.calendarContainer.style.left="auto",e.calendarContainer.style.right=Me+"px";else{var yt=Wn();if(yt===void 0)return;var Qn=window.document.body.offsetWidth,Zn=Math.max(0,Qn/2-m/2),er=".flatpickr-calendar.centerMost:before",tr=".flatpickr-calendar.centerMost:after",nr=yt.cssRules.length,rr="{left:"+E.left+"px;right:auto;}";z(e.calendarContainer,"rightMost",!1),z(e.calendarContainer,"centerMost",!0),yt.insertRule(er+","+tr+rr,nr),e.calendarContainer.style.left=Zn+"px",e.calendarContainer.style.right="auto"}}}}function Wn(){for(var i=null,s=0;s<document.styleSheets.length;s++){var u=document.styleSheets[s];if(u.cssRules){try{u.cssRules}catch(m){continue}i=u;break}}return i!=null?i:_n()}function _n(){var i=document.createElement("style");return document.head.appendChild(i),i.sheet}function $t(){e.config.noCalendar||e.isMobile||(Y(),We(),$())}function gt(){e._input.focus(),window.navigator.userAgent.indexOf("MSIE")!==-1||navigator.msMaxTouchPoints!==void 0?setTimeout(e.close,0):e.close()}function Bt(i){i.preventDefault(),i.stopPropagation();var s=function(M){return M.classList&&M.classList.contains("flatpickr-day")&&!M.classList.contains("flatpickr-disabled")&&!M.classList.contains("notAllowed")},u=Dt(G(i),s);if(u!==void 0){var m=u,b=e.latestSelectedDateObj=new Date(m.dateObj.getTime()),w=(b.getMonth()<e.currentMonth||b.getMonth()>e.currentMonth+e.config.showMonths-1)&&e.config.mode!=="range";if(e.selectedDateElem=m,e.config.mode==="single")e.selectedDates=[b];else if(e.config.mode==="multiple"){var F=vt(b);F?e.selectedDates.splice(parseInt(F),1):e.selectedDates.push(b)}else e.config.mode==="range"&&(e.selectedDates.length===2&&e.clear(!1,!1),e.latestSelectedDateObj=b,e.selectedDates.push(b),U(b,e.selectedDates[0],!0)!==0&&e.selectedDates.sort(function(M,N){return M.getTime()-N.getTime()}));if(p(),w){var E=e.currentYear!==b.getFullYear();e.currentYear=b.getFullYear(),e.currentMonth=b.getMonth(),E&&(R("onYearChange"),Y()),R("onMonthChange")}if(We(),$(),re(),!w&&e.config.mode!=="range"&&e.config.showMonths===1?te(m):e.selectedDateElem!==void 0&&e.hourElement===void 0&&e.selectedDateElem&&e.selectedDateElem.focus(),e.hourElement!==void 0&&e.hourElement!==void 0&&e.hourElement.focus(),e.config.closeOnSelect){var S=e.config.mode==="single"&&!e.config.enableTime,D=e.config.mode==="range"&&e.selectedDates.length===2&&!e.config.enableTime;(S||D)&&gt()}x()}}var He={locale:[_t,At],showMonths:[Nt,l,Rt],minDate:[C],maxDate:[C],positionElement:[Jt],clickOpens:[function(){e.config.clickOpens===!0?(v(e._input,"focus",e.open),v(e._input,"click",e.open)):(e._input.removeEventListener("focus",e.open),e._input.removeEventListener("click",e.open))}]};function $n(i,s){if(i!==null&&typeof i=="object"){Object.assign(e.config,i);for(var u in i)He[u]!==void 0&&He[u].forEach(function(m){return m()})}else e.config[i]=s,He[i]!==void 0?He[i].forEach(function(m){return m()}):Ge.indexOf(i)>-1&&(e.config[i]=Xe(s));e.redraw(),re(!0)}function Vt(i,s){var u=[];if(i instanceof Array)u=i.map(function(m){return e.parseDate(m,s)});else if(i instanceof Date||typeof i=="number")u=[e.parseDate(i,s)];else if(typeof i=="string")switch(e.config.mode){case"single":case"time":u=[e.parseDate(i,s)];break;case"multiple":u=i.split(e.config.conjunction).map(function(m){return e.parseDate(m,s)});break;case"range":u=i.split(e.l10n.rangeSeparator).map(function(m){return e.parseDate(m,s)});break;default:break}else e.config.errorHandler(new Error("Invalid date supplied: "+JSON.stringify(i)));e.selectedDates=e.config.allowInvalidPreload?u:u.filter(function(m){return m instanceof Date&&ue(m,!1)}),e.config.mode==="range"&&e.selectedDates.sort(function(m,b){return m.getTime()-b.getTime()})}function Bn(i,s,u){if(s===void 0&&(s=!1),u===void 0&&(u=e.config.dateFormat),i!==0&&!i||i instanceof Array&&i.length===0)return e.clear(s);Vt(i,u),e.latestSelectedDateObj=e.selectedDates[e.selectedDates.length-1],e.redraw(),C(void 0,s),h(),e.selectedDates.length===0&&e.clear(!1),re(s),s&&R("onChange")}function zt(i){return i.slice().map(function(s){return typeof s=="string"||typeof s=="number"||s instanceof Date?e.parseDate(s,void 0,!0):s&&typeof s=="object"&&s.from&&s.to?{from:e.parseDate(s.from,void 0),to:e.parseDate(s.to,void 0)}:s}).filter(function(s){return s})}function Vn(){e.selectedDates=[],e.now=e.parseDate(e.config.now)||new Date;var i=e.config.defaultDate||((e.input.nodeName==="INPUT"||e.input.nodeName==="TEXTAREA")&&e.input.placeholder&&e.input.value===e.input.placeholder?null:e.input.value);i&&Vt(i,e.config.dateFormat),e._initialDate=e.selectedDates.length>0?e.selectedDates[0]:e.config.minDate&&e.config.minDate.getTime()>e.now.getTime()?e.config.minDate:e.config.maxDate&&e.config.maxDate.getTime()<e.now.getTime()?e.config.maxDate:e.now,e.currentYear=e._initialDate.getFullYear(),e.currentMonth=e._initialDate.getMonth(),e.selectedDates.length>0&&(e.latestSelectedDateObj=e.selectedDates[0]),e.config.minTime!==void 0&&(e.config.minTime=e.parseDate(e.config.minTime,"H:i")),e.config.maxTime!==void 0&&(e.config.maxTime=e.parseDate(e.config.maxTime,"H:i")),e.minDateHasTime=!!e.config.minDate&&(e.config.minDate.getHours()>0||e.config.minDate.getMinutes()>0||e.config.minDate.getSeconds()>0),e.maxDateHasTime=!!e.config.maxDate&&(e.config.maxDate.getHours()>0||e.config.maxDate.getMinutes()>0||e.config.maxDate.getSeconds()>0)}function zn(){if(e.input=Wt(),!e.input){e.config.errorHandler(new Error("Invalid input element specified"));return}e.input._type=e.input.type,e.input.type="text",e.input.classList.add("flatpickr-input"),e._input=e.input,e.config.altInput&&(e.altInput=P(e.input.nodeName,e.config.altInputClass),e._input=e.altInput,e.altInput.placeholder=e.input.placeholder,e.altInput.disabled=e.input.disabled,e.altInput.required=e.input.required,e.altInput.tabIndex=e.input.tabIndex,e.altInput.type="text",e.input.setAttribute("type","hidden"),!e.config.static&&e.input.parentNode&&e.input.parentNode.insertBefore(e.altInput,e.input.nextSibling)),e.config.allowInput||e._input.setAttribute("readonly","readonly"),Jt()}function Jt(){e._positionElement=e.config.positionElement||e._input}function Jn(){var i=e.config.enableTime?e.config.noCalendar?"time":"datetime-local":"date";e.mobileInput=P("input",e.input.className+" flatpickr-mobile"),e.mobileInput.tabIndex=1,e.mobileInput.type=i,e.mobileInput.disabled=e.input.disabled,e.mobileInput.required=e.input.required,e.mobileInput.placeholder=e.input.placeholder,e.mobileFormatStr=i==="datetime-local"?"Y-m-d\\TH:i:S":i==="date"?"Y-m-d":"H:i:S",e.selectedDates.length>0&&(e.mobileInput.defaultValue=e.mobileInput.value=e.formatDate(e.selectedDates[0],e.mobileFormatStr)),e.config.minDate&&(e.mobileInput.min=e.formatDate(e.config.minDate,"Y-m-d")),e.config.maxDate&&(e.mobileInput.max=e.formatDate(e.config.maxDate,"Y-m-d")),e.input.getAttribute("step")&&(e.mobileInput.step=String(e.input.getAttribute("step"))),e.input.type="hidden",e.altInput!==void 0&&(e.altInput.type="hidden");try{e.input.parentNode&&e.input.parentNode.insertBefore(e.mobileInput,e.input.nextSibling)}catch(s){}v(e.mobileInput,"change",function(s){e.setDate(G(s).value,!1,e.mobileFormatStr),R("onChange"),R("onClose")})}function qn(i){if(e.isOpen===!0)return e.close();e.open(i)}function R(i,s){if(e.config!==void 0){var u=e.config[i];if(u!==void 0&&u.length>0)for(var m=0;u[m]&&m<u.length;m++)u[m](e.selectedDates,e.input.value,e,s);i==="onChange"&&(e.input.dispatchEvent(bt("change")),e.input.dispatchEvent(bt("input")))}}function bt(i){var s=document.createEvent("Event");return s.initEvent(i,!0,!0),s}function vt(i){for(var s=0;s<e.selectedDates.length;s++){var u=e.selectedDates[s];if(u instanceof Date&&U(u,i)===0)return""+s}return!1}function Gn(i){return e.config.mode!=="range"||e.selectedDates.length<2?!1:U(i,e.selectedDates[0])>=0&&U(i,e.selectedDates[1])<=0}function We(){e.config.noCalendar||e.isMobile||!e.monthNav||(e.yearElements.forEach(function(i,s){var u=new Date(e.currentYear,e.currentMonth,1);u.setMonth(e.currentMonth+s),e.config.showMonths>1||e.config.monthSelectorType==="static"?e.monthElements[s].textContent=Oe(u.getMonth(),e.config.shorthandCurrentMonth,e.l10n)+" ":e.monthsDropdownContainer.value=u.getMonth().toString(),i.value=u.getFullYear().toString()}),e._hidePrevMonthArrow=e.config.minDate!==void 0&&(e.currentYear===e.config.minDate.getFullYear()?e.currentMonth<=e.config.minDate.getMonth():e.currentYear<e.config.minDate.getFullYear()),e._hideNextMonthArrow=e.config.maxDate!==void 0&&(e.currentYear===e.config.maxDate.getFullYear()?e.currentMonth+1>e.config.maxDate.getMonth():e.currentYear>e.config.maxDate.getFullYear()))}function wt(i){var s=i||(e.config.altInput?e.config.altFormat:e.config.dateFormat);return e.selectedDates.map(function(u){return e.formatDate(u,s)}).filter(function(u,m,b){return e.config.mode!=="range"||e.config.enableTime||b.indexOf(u)===m}).join(e.config.mode!=="range"?e.config.conjunction:e.l10n.rangeSeparator)}function re(i){i===void 0&&(i=!0),e.mobileInput!==void 0&&e.mobileFormatStr&&(e.mobileInput.value=e.latestSelectedDateObj!==void 0?e.formatDate(e.latestSelectedDateObj,e.mobileFormatStr):""),e.input.value=wt(e.config.dateFormat),e.altInput!==void 0&&(e.altInput.value=wt(e.config.altFormat)),i!==!1&&R("onValueUpdate")}function Un(i){var s=G(i),u=e.prevMonthNav.contains(s),m=e.nextMonthNav.contains(s);u||m?mt(u?-1:1):e.yearElements.indexOf(s)>=0?s.select():s.classList.contains("arrowUp")?e.changeYear(e.currentYear+1):s.classList.contains("arrowDown")&&e.changeYear(e.currentYear-1)}function Kn(i){i.preventDefault();var s=i.type==="keydown",u=G(i),m=u;e.amPM!==void 0&&u===e.amPM&&(e.amPM.textContent=e.l10n.amPM[q(e.amPM.textContent===e.l10n.amPM[0])]);var b=parseFloat(m.getAttribute("min")),w=parseFloat(m.getAttribute("max")),F=parseFloat(m.getAttribute("step")),E=parseInt(m.value,10),S=i.delta||(s?i.which===38?1:-1:0),D=E+F*S;if(typeof m.value!="undefined"&&m.value.length===2){var M=m===e.hourElement,N=m===e.minuteElement;D<b?(D=w+D+q(!M)+(q(M)&&q(!e.amPM)),N&&I(void 0,-1,e.hourElement)):D>w&&(D=m===e.hourElement?D-w-q(!e.amPM):b,N&&I(void 0,1,e.hourElement)),e.amPM&&M&&(F===1?D+E===23:Math.abs(D-E)>F)&&(e.amPM.textContent=e.l10n.amPM[q(e.amPM.textContent===e.l10n.amPM[0])]),m.value=V(D)}}return a(),e}function be(n,t){for(var e=Array.prototype.slice.call(n).filter(function(c){return c instanceof HTMLElement}),r=[],a=0;a<e.length;a++){var o=e[a];try{if(o.getAttribute("data-fp-omit")!==null)continue;o._flatpickr!==void 0&&(o._flatpickr.destroy(),o._flatpickr=void 0),o._flatpickr=pr(o,t||{}),r.push(o._flatpickr)}catch(c){console.error(c)}}return r.length===1?r[0]:r}typeof HTMLElement!="undefined"&&typeof HTMLCollection!="undefined"&&typeof NodeList!="undefined"&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(n){return be(this,n)},HTMLElement.prototype.flatpickr=function(n){return be([this],n)});var W=function(n,t){return typeof n=="string"?be(window.document.querySelectorAll(n),t):n instanceof Node?be([n],t):be(n,t)};W.defaultConfig={};W.l10ns={en:J({},Ke),default:J({},Ke)};W.localize=function(n){W.l10ns.default=J(J({},W.l10ns.default),n)};W.setDefaults=function(n){W.defaultConfig=J(J({},W.defaultConfig),n)};W.parseDate=Qe({});W.formatDate=Ct({});W.compareDates=U;typeof jQuery!="undefined"&&typeof jQuery.fn!="undefined"&&(jQuery.fn.flatpickr=function(n){return be(this,n)});Date.prototype.fp_incr=function(n){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+(typeof n=="string"?parseInt(n,10):n))};typeof window!="undefined"&&(window.flatpickr=W);var Zt=W;var mr=Math.pow(10,8)*24*60*60*1e3,Ra=-mr,tt=6048e5,en=864e5;var hr=3600;var tn=hr*24,Aa=tn*7,gr=tn*365.2425,br=gr/12,Ya=br*3,Mt=Symbol.for("constructDateFrom");function K(n,t){return typeof n=="function"?n(t):n&&typeof n=="object"&&Mt in n?n[Mt](t):n instanceof Date?new n.constructor(t):new Date(t)}function A(n,t){return K(t||n,n)}var vr={};function ce(){return vr}function ie(n,t){var l,d,g,f,p,h,y,k;let e=ce(),r=(k=(y=(f=(g=t==null?void 0:t.weekStartsOn)!=null?g:(d=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:d.weekStartsOn)!=null?f:e.weekStartsOn)!=null?y:(h=(p=e.locale)==null?void 0:p.options)==null?void 0:h.weekStartsOn)!=null?k:0,a=A(n,t==null?void 0:t.in),o=a.getDay(),c=(o<r?7:0)+o-r;return a.setDate(a.getDate()-c),a.setHours(0,0,0,0),a}function fe(n,t){return ie(n,{...t,weekStartsOn:1})}function nt(n,t){let e=A(n,t==null?void 0:t.in),r=e.getFullYear(),a=K(e,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);let o=fe(a),c=K(e,0);c.setFullYear(r,0,4),c.setHours(0,0,0,0);let l=fe(c);return e.getTime()>=o.getTime()?r+1:e.getTime()>=l.getTime()?r:r-1}function Tt(n){let t=A(n),e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),+n-+e}function nn(n,...t){let e=K.bind(null,n||t.find(r=>typeof r=="object"));return t.map(e)}function Ft(n,t){let e=A(n,t==null?void 0:t.in);return e.setHours(0,0,0,0),e}function rn(n,t,e){let[r,a]=nn(e==null?void 0:e.in,n,t),o=Ft(r),c=Ft(a),l=+o-Tt(o),d=+c-Tt(c);return Math.round((l-d)/en)}function an(n,t){let e=nt(n,t),r=K((t==null?void 0:t.in)||n,0);return r.setFullYear(e,0,4),r.setHours(0,0,0,0),fe(r)}function on(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function sn(n){return!(!on(n)&&typeof n!="number"||isNaN(+A(n)))}function ln(n,t){let e=A(n,t==null?void 0:t.in);return e.setFullYear(e.getFullYear(),0,1),e.setHours(0,0,0,0),e}var wr={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},cn=(n,t,e)=>{let r,a=wr[n];return typeof a=="string"?r=a:t===1?r=a.one:r=a.other.replace("{{count}}",t.toString()),e!=null&&e.addSuffix?e.comparison&&e.comparison>0?"in "+r:r+" ago":r};function rt(n){return(t={})=>{let e=t.width?String(t.width):n.defaultWidth;return n.formats[e]||n.formats[n.defaultWidth]}}var yr={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},xr={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},kr={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},dn={date:rt({formats:yr,defaultWidth:"full"}),time:rt({formats:xr,defaultWidth:"full"}),dateTime:rt({formats:kr,defaultWidth:"full"})};var Dr={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},un=(n,t,e,r)=>Dr[n];function ve(n){return(t,e)=>{let r=e!=null&&e.context?String(e.context):"standalone",a;if(r==="formatting"&&n.formattingValues){let c=n.defaultFormattingWidth||n.defaultWidth,l=e!=null&&e.width?String(e.width):c;a=n.formattingValues[l]||n.formattingValues[c]}else{let c=n.defaultWidth,l=e!=null&&e.width?String(e.width):n.defaultWidth;a=n.values[l]||n.values[c]}let o=n.argumentCallback?n.argumentCallback(t):t;return a[o]}}var Er={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Cr={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Mr={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Tr={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Fr={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Or={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Sr=(n,t)=>{let e=Number(n),r=e%100;if(r>20||r<10)switch(r%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd"}return e+"th"},fn={ordinalNumber:Sr,era:ve({values:Er,defaultWidth:"wide"}),quarter:ve({values:Cr,defaultWidth:"wide",argumentCallback:n=>n-1}),month:ve({values:Mr,defaultWidth:"wide"}),day:ve({values:Tr,defaultWidth:"wide"}),dayPeriod:ve({values:Fr,defaultWidth:"wide",formattingValues:Or,defaultFormattingWidth:"wide"})};function we(n){return(t,e={})=>{let r=e.width,a=r&&n.matchPatterns[r]||n.matchPatterns[n.defaultMatchWidth],o=t.match(a);if(!o)return null;let c=o[0],l=r&&n.parsePatterns[r]||n.parsePatterns[n.defaultParseWidth],d=Array.isArray(l)?Pr(l,p=>p.test(c)):Ir(l,p=>p.test(c)),g;g=n.valueCallback?n.valueCallback(d):d,g=e.valueCallback?e.valueCallback(g):g;let f=t.slice(c.length);return{value:g,rest:f}}}function Ir(n,t){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e)&&t(n[e]))return e}function Pr(n,t){for(let e=0;e<n.length;e++)if(t(n[e]))return e}function pn(n){return(t,e={})=>{let r=t.match(n.matchPattern);if(!r)return null;let a=r[0],o=t.match(n.parsePattern);if(!o)return null;let c=n.valueCallback?n.valueCallback(o[0]):o[0];c=e.valueCallback?e.valueCallback(c):c;let l=t.slice(a.length);return{value:c,rest:l}}}var Lr=/^(\d+)(th|st|nd|rd)?/i,jr=/\d+/i,Nr={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Rr={any:[/^b/i,/^(a|c)/i]},Ar={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Yr={any:[/1/i,/2/i,/3/i,/4/i]},Hr={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Wr={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},_r={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},$r={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Br={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Vr={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},mn={ordinalNumber:pn({matchPattern:Lr,parsePattern:jr,valueCallback:n=>parseInt(n,10)}),era:we({matchPatterns:Nr,defaultMatchWidth:"wide",parsePatterns:Rr,defaultParseWidth:"any"}),quarter:we({matchPatterns:Ar,defaultMatchWidth:"wide",parsePatterns:Yr,defaultParseWidth:"any",valueCallback:n=>n+1}),month:we({matchPatterns:Hr,defaultMatchWidth:"wide",parsePatterns:Wr,defaultParseWidth:"any"}),day:we({matchPatterns:_r,defaultMatchWidth:"wide",parsePatterns:$r,defaultParseWidth:"any"}),dayPeriod:we({matchPatterns:Br,defaultMatchWidth:"any",parsePatterns:Vr,defaultParseWidth:"any"})};var Ot={code:"en-US",formatDistance:cn,formatLong:dn,formatRelative:un,localize:fn,match:mn,options:{weekStartsOn:0,firstWeekContainsDate:1}};function hn(n,t){let e=A(n,t==null?void 0:t.in);return rn(e,ln(e))+1}function gn(n,t){let e=A(n,t==null?void 0:t.in),r=+fe(e)-+an(e);return Math.round(r/tt)+1}function at(n,t){var f,p,h,y,k,v,x,O;let e=A(n,t==null?void 0:t.in),r=e.getFullYear(),a=ce(),o=(O=(x=(y=(h=t==null?void 0:t.firstWeekContainsDate)!=null?h:(p=(f=t==null?void 0:t.locale)==null?void 0:f.options)==null?void 0:p.firstWeekContainsDate)!=null?y:a.firstWeekContainsDate)!=null?x:(v=(k=a.locale)==null?void 0:k.options)==null?void 0:v.firstWeekContainsDate)!=null?O:1,c=K((t==null?void 0:t.in)||n,0);c.setFullYear(r+1,0,o),c.setHours(0,0,0,0);let l=ie(c,t),d=K((t==null?void 0:t.in)||n,0);d.setFullYear(r,0,o),d.setHours(0,0,0,0);let g=ie(d,t);return+e>=+l?r+1:+e>=+g?r:r-1}function bn(n,t){var l,d,g,f,p,h,y,k;let e=ce(),r=(k=(y=(f=(g=t==null?void 0:t.firstWeekContainsDate)!=null?g:(d=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:d.firstWeekContainsDate)!=null?f:e.firstWeekContainsDate)!=null?y:(h=(p=e.locale)==null?void 0:p.options)==null?void 0:h.firstWeekContainsDate)!=null?k:1,a=at(n,t),o=K((t==null?void 0:t.in)||n,0);return o.setFullYear(a,0,r),o.setHours(0,0,0,0),ie(o,t)}function vn(n,t){let e=A(n,t==null?void 0:t.in),r=+ie(e,t)-+bn(e,t);return Math.round(r/tt)+1}function L(n,t){let e=n<0?"-":"",r=Math.abs(n).toString().padStart(t,"0");return e+r}var oe={y(n,t){let e=n.getFullYear(),r=e>0?e:1-e;return L(t==="yy"?r%100:r,t.length)},M(n,t){let e=n.getMonth();return t==="M"?String(e+1):L(e+1,2)},d(n,t){return L(n.getDate(),t.length)},a(n,t){let e=n.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return e.toUpperCase();case"aaa":return e;case"aaaaa":return e[0];case"aaaa":default:return e==="am"?"a.m.":"p.m."}},h(n,t){return L(n.getHours()%12||12,t.length)},H(n,t){return L(n.getHours(),t.length)},m(n,t){return L(n.getMinutes(),t.length)},s(n,t){return L(n.getSeconds(),t.length)},S(n,t){let e=t.length,r=n.getMilliseconds(),a=Math.trunc(r*Math.pow(10,e-3));return L(a,t.length)}};var ye={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},St={G:function(n,t,e){let r=n.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return e.era(r,{width:"abbreviated"});case"GGGGG":return e.era(r,{width:"narrow"});case"GGGG":default:return e.era(r,{width:"wide"})}},y:function(n,t,e){if(t==="yo"){let r=n.getFullYear(),a=r>0?r:1-r;return e.ordinalNumber(a,{unit:"year"})}return oe.y(n,t)},Y:function(n,t,e,r){let a=at(n,r),o=a>0?a:1-a;if(t==="YY"){let c=o%100;return L(c,2)}return t==="Yo"?e.ordinalNumber(o,{unit:"year"}):L(o,t.length)},R:function(n,t){let e=nt(n);return L(e,t.length)},u:function(n,t){let e=n.getFullYear();return L(e,t.length)},Q:function(n,t,e){let r=Math.ceil((n.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return L(r,2);case"Qo":return e.ordinalNumber(r,{unit:"quarter"});case"QQQ":return e.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return e.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return e.quarter(r,{width:"wide",context:"formatting"})}},q:function(n,t,e){let r=Math.ceil((n.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return L(r,2);case"qo":return e.ordinalNumber(r,{unit:"quarter"});case"qqq":return e.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return e.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return e.quarter(r,{width:"wide",context:"standalone"})}},M:function(n,t,e){let r=n.getMonth();switch(t){case"M":case"MM":return oe.M(n,t);case"Mo":return e.ordinalNumber(r+1,{unit:"month"});case"MMM":return e.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return e.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return e.month(r,{width:"wide",context:"formatting"})}},L:function(n,t,e){let r=n.getMonth();switch(t){case"L":return String(r+1);case"LL":return L(r+1,2);case"Lo":return e.ordinalNumber(r+1,{unit:"month"});case"LLL":return e.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return e.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return e.month(r,{width:"wide",context:"standalone"})}},w:function(n,t,e,r){let a=vn(n,r);return t==="wo"?e.ordinalNumber(a,{unit:"week"}):L(a,t.length)},I:function(n,t,e){let r=gn(n);return t==="Io"?e.ordinalNumber(r,{unit:"week"}):L(r,t.length)},d:function(n,t,e){return t==="do"?e.ordinalNumber(n.getDate(),{unit:"date"}):oe.d(n,t)},D:function(n,t,e){let r=hn(n);return t==="Do"?e.ordinalNumber(r,{unit:"dayOfYear"}):L(r,t.length)},E:function(n,t,e){let r=n.getDay();switch(t){case"E":case"EE":case"EEE":return e.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return e.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return e.day(r,{width:"short",context:"formatting"});case"EEEE":default:return e.day(r,{width:"wide",context:"formatting"})}},e:function(n,t,e,r){let a=n.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(o);case"ee":return L(o,2);case"eo":return e.ordinalNumber(o,{unit:"day"});case"eee":return e.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return e.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return e.day(a,{width:"short",context:"formatting"});case"eeee":default:return e.day(a,{width:"wide",context:"formatting"})}},c:function(n,t,e,r){let a=n.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(o);case"cc":return L(o,t.length);case"co":return e.ordinalNumber(o,{unit:"day"});case"ccc":return e.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return e.day(a,{width:"narrow",context:"standalone"});case"cccccc":return e.day(a,{width:"short",context:"standalone"});case"cccc":default:return e.day(a,{width:"wide",context:"standalone"})}},i:function(n,t,e){let r=n.getDay(),a=r===0?7:r;switch(t){case"i":return String(a);case"ii":return L(a,t.length);case"io":return e.ordinalNumber(a,{unit:"day"});case"iii":return e.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return e.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return e.day(r,{width:"short",context:"formatting"});case"iiii":default:return e.day(r,{width:"wide",context:"formatting"})}},a:function(n,t,e){let a=n.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return e.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return e.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(n,t,e){let r=n.getHours(),a;switch(r===12?a=ye.noon:r===0?a=ye.midnight:a=r/12>=1?"pm":"am",t){case"b":case"bb":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return e.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return e.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(n,t,e){let r=n.getHours(),a;switch(r>=17?a=ye.evening:r>=12?a=ye.afternoon:r>=4?a=ye.morning:a=ye.night,t){case"B":case"BB":case"BBB":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return e.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return e.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(n,t,e){if(t==="ho"){let r=n.getHours()%12;return r===0&&(r=12),e.ordinalNumber(r,{unit:"hour"})}return oe.h(n,t)},H:function(n,t,e){return t==="Ho"?e.ordinalNumber(n.getHours(),{unit:"hour"}):oe.H(n,t)},K:function(n,t,e){let r=n.getHours()%12;return t==="Ko"?e.ordinalNumber(r,{unit:"hour"}):L(r,t.length)},k:function(n,t,e){let r=n.getHours();return r===0&&(r=24),t==="ko"?e.ordinalNumber(r,{unit:"hour"}):L(r,t.length)},m:function(n,t,e){return t==="mo"?e.ordinalNumber(n.getMinutes(),{unit:"minute"}):oe.m(n,t)},s:function(n,t,e){return t==="so"?e.ordinalNumber(n.getSeconds(),{unit:"second"}):oe.s(n,t)},S:function(n,t){return oe.S(n,t)},X:function(n,t,e){let r=n.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return yn(r);case"XXXX":case"XX":return pe(r);case"XXXXX":case"XXX":default:return pe(r,":")}},x:function(n,t,e){let r=n.getTimezoneOffset();switch(t){case"x":return yn(r);case"xxxx":case"xx":return pe(r);case"xxxxx":case"xxx":default:return pe(r,":")}},O:function(n,t,e){let r=n.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+wn(r,":");case"OOOO":default:return"GMT"+pe(r,":")}},z:function(n,t,e){let r=n.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+wn(r,":");case"zzzz":default:return"GMT"+pe(r,":")}},t:function(n,t,e){let r=Math.trunc(+n/1e3);return L(r,t.length)},T:function(n,t,e){return L(+n,t.length)}};function wn(n,t=""){let e=n>0?"-":"+",r=Math.abs(n),a=Math.trunc(r/60),o=r%60;return o===0?e+String(a):e+String(a)+t+L(o,2)}function yn(n,t){return n%60===0?(n>0?"-":"+")+L(Math.abs(n)/60,2):pe(n,t)}function pe(n,t=""){let e=n>0?"-":"+",r=Math.abs(n),a=L(Math.trunc(r/60),2),o=L(r%60,2);return e+a+t+o}var xn=(n,t)=>{switch(n){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},kn=(n,t)=>{switch(n){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},zr=(n,t)=>{let e=n.match(/(P+)(p+)?/)||[],r=e[1],a=e[2];if(!a)return xn(n,t);let o;switch(r){case"P":o=t.dateTime({width:"short"});break;case"PP":o=t.dateTime({width:"medium"});break;case"PPP":o=t.dateTime({width:"long"});break;case"PPPP":default:o=t.dateTime({width:"full"});break}return o.replace("{{date}}",xn(r,t)).replace("{{time}}",kn(a,t))},Dn={p:kn,P:zr};var Jr=/^D+$/,qr=/^Y+$/,Gr=["D","DD","YY","YYYY"];function En(n){return Jr.test(n)}function Cn(n){return qr.test(n)}function Mn(n,t,e){let r=Ur(n,t,e);if(console.warn(r),Gr.includes(n))throw new RangeError(r)}function Ur(n,t,e){let r=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${t}\`) for formatting ${r} to the input \`${e}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}var Kr=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Xr=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Qr=/^'([^]*?)'?$/,Zr=/''/g,ea=/[a-zA-Z]/;function It(n,t,e){var f,p,h,y,k,v,x,O,C,T,I,_,j,te,ne,me,se,je;let r=ce(),a=(p=(f=e==null?void 0:e.locale)!=null?f:r.locale)!=null?p:Ot,o=(T=(C=(v=(k=e==null?void 0:e.firstWeekContainsDate)!=null?k:(y=(h=e==null?void 0:e.locale)==null?void 0:h.options)==null?void 0:y.firstWeekContainsDate)!=null?v:r.firstWeekContainsDate)!=null?C:(O=(x=r.locale)==null?void 0:x.options)==null?void 0:O.firstWeekContainsDate)!=null?T:1,c=(je=(se=(te=(j=e==null?void 0:e.weekStartsOn)!=null?j:(_=(I=e==null?void 0:e.locale)==null?void 0:I.options)==null?void 0:_.weekStartsOn)!=null?te:r.weekStartsOn)!=null?se:(me=(ne=r.locale)==null?void 0:ne.options)==null?void 0:me.weekStartsOn)!=null?je:0,l=A(n,e==null?void 0:e.in);if(!sn(l))throw new RangeError("Invalid time value");let d=t.match(Xr).map($=>{let Y=$[0];if(Y==="p"||Y==="P"){let Ee=Dn[Y];return Ee($,a.formatLong)}return $}).join("").match(Kr).map($=>{if($==="''")return{isToken:!1,value:"'"};let Y=$[0];if(Y==="'")return{isToken:!1,value:ta($)};if(St[Y])return{isToken:!0,value:$};if(Y.match(ea))throw new RangeError("Format string contains an unescaped latin alphabet character `"+Y+"`");return{isToken:!1,value:$}});a.localize.preprocessor&&(d=a.localize.preprocessor(l,d));let g={firstWeekContainsDate:o,weekStartsOn:c,locale:a};return d.map($=>{if(!$.isToken)return $.value;let Y=$.value;(!(e!=null&&e.useAdditionalWeekYearTokens)&&Cn(Y)||!(e!=null&&e.useAdditionalDayOfYearTokens)&&En(Y))&&Mn(Y,t,String(n));let Ee=St[Y[0]];return Ee(l,Y,a.localize,g)}).join("")}function ta(n){let t=n.match(Qr);return t?t[1].replace(Zr,"'"):n}var Pt=new WeakMap,it=class{constructor(){this.formatMap={"MMMM D, YYYY":"MMMM d, yyyy","MMM D":"MMM d","DD/MM/YYYY":"dd/MM/yyyy","MM/DD/YYYY":"MM/dd/yyyy","YYYY/MM/DD":"yyyy/MM/dd"}}render(t,e,r,a,o){e.empty(),e.addClass("json-table-date-cell");let c=Pt.get(e);c&&(c.destroy(),Pt.delete(e));let l=a.typeOptions,d=(l==null?void 0:l.dateFormat)||"YYYY/MM/DD",g=this.formatMap[d],f=parseInt(r,10),p="",h=null;if(!isNaN(f)){h=new Date(f);try{p=It(h,g)}catch(v){console.error("Error formatting date:",v),p="Invalid Date",h=null}}let y=e.createEl("div",{cls:"json-table-date-wrapper"}),k=y.createSpan({text:p,cls:"json-table-date-display"});try{let v=Zt(y,{clickOpens:!0,allowInput:!1,dateFormat:"U",defaultDate:h||void 0,appendTo:document.body,onChange:x=>{var O;if(x.length>0){let C=x[0],T=C.getTime(),I=this.formatMap[((O=a.typeOptions)==null?void 0:O.dateFormat)||"YYYY/MM/DD"];k.setText(It(C,I)),o(T.toString())}else k.setText(""),o("")}});Pt.set(e,v)}catch(v){console.error("Failed to initialize flatpickr:",v),e.setText("Error initializing date picker");return}}};var Se=class{render(t,e,r,a){}};var Tn=require("obsidian"),Ie=class{render(t,e,r,a){t.createEl("label",{text:"Options",cls:"json-table-popup-label"}),e.typeOptions=e.typeOptions||{};let o=e.typeOptions;o.options=o.options||[];let c=t.createEl("div",{cls:"json-table-edit-options-list"}),l=()=>{c.empty(),o.options.forEach((h,y)=>{let k=c.createEl("div",{cls:"json-table-edit-option"}),v=k.createEl("span",{text:h.value,cls:"json-table-dropdown-tag"});h.style&&v.addClass(`dropdown-tag--${h.style}`);let x=k.createEl("button",{text:"\xD7",cls:"json-table-edit-option-delete",attr:{title:"Delete option"}});x.addEventListener("mousedown",O=>O.preventDefault()),x.addEventListener("click",async()=>{let O=h.value;o.options.splice(y,1),r.rows.forEach(T=>{T.forEach(I=>{if(I.column===e.id&&I.value){if(e.type==="dropdown")I.value===O&&(I.value="");else if(e.type==="multiselect"){let _=I.value.split(",").map(j=>j.trim()).filter(j=>j&&j!==O);I.value=_.join(",")}}})}),await a.saveTableData(r);let C=a.getFilePath();if(C){let T=a.app.vault.getAbstractFileByPath(C);T instanceof Tn.TFile?await a.renderContent(T):console.error("Cannot re-render, file not found at path:",C)}else console.error("Cannot re-render, view has no file path set.");l()})})};l();let d=t.createEl("div",{cls:"json-table-edit-option-add"}),g=d.createEl("input",{type:"text",placeholder:"Add new option",cls:"json-table-edit-input"}),f=d.createEl("button",{text:"Add",cls:"json-table-add-row"}),p=async()=>{let h=g.value.trim();h&&(o.options.find(y=>y.value===h)||(o.options.push({value:h,style:"default"}),g.value="",await a.saveTableData(r),l()))};f.addEventListener("mousedown",h=>h.preventDefault()),f.addEventListener("click",p),g.addEventListener("keydown",h=>{h.key==="Enter"&&(h.preventDefault(),p())})}};var ot=class{render(t,e,r,a){t.createEl("label",{cls:"json-table-popup-label",text:"Suggest Options:"});let o=t.createDiv({cls:"json-table-editor-setting"}),c=`suggest-all-${e.id}`,l=o.createEl("input",{type:"checkbox",attr:{id:c}}),d=e.typeOptions;l.checked=!!(d!=null&&d.suggestAllFiles),o.createEl("label",{text:"Suggest all file types (not just notes)",attr:{for:c}}),l.addEventListener("change",async()=>{e.typeOptions=e.typeOptions||{};let g=e.typeOptions;g.suggestAllFiles=l.checked,await a.saveTableData(r)})}};var Fn=require("obsidian"),st=class{constructor(){this.availableFormats=[{label:"Full Date",format:"MMMM D, YYYY"},{label:"Short Date",format:"MMM D"},{label:"Day/Month/Year",format:"DD/MM/YYYY"},{label:"Month/Day/Year",format:"MM/DD/YYYY"},{label:"Year/Month/Day",format:"YYYY/MM/DD"}];this.defaultFormat="YYYY/MM/DD"}render(t,e,r,a){t.createEl("label",{cls:"json-table-popup-label",text:"Date Format:"});let o=t.createEl("select",{cls:"json-table-popup-select"}),c=e.typeOptions,l=(c==null?void 0:c.dateFormat)||this.defaultFormat;this.availableFormats.forEach(d=>{let g=o.createEl("option",{text:d.label,value:d.format});l===d.format&&(g.selected=!0)}),o.addEventListener("change",async()=>{let d=o.value;e.typeOptions=e.typeOptions||{};let g=e.typeOptions;if(g.dateFormat!==d){g.dateFormat=d,await a.saveTableData(r);let f=a.getFilePath();if(f){let p=a.app.vault.getAbstractFileByPath(f);p instanceof Fn.TFile?await a.renderContent(p):console.error("Cannot re-render, file not found at path:",f)}else console.error("Cannot re-render, view has no file path set.")}})}};var lt=class{constructor(t,e,r){this.data=t;this.triggerRender=e;this.view=r;(!this.data.views||!Array.isArray(this.data.views)||this.data.views.length===0)&&(console.warn("No views array found in data, creating default view."),this.data.views=[{id:"default_"+Date.now(),name:"Default",sort:[],filter:[]}]),this.data.views[0].sort||(this.data.views[0].sort=[]),this.data.views[0].filter||(this.data.views[0].filter=[])}getCurrentSortRules(){var t,e;return((e=(t=this.data.views)==null?void 0:t[0])==null?void 0:e.sort)||[]}setCurrentSortRules(t){this.data.views&&this.data.views[0]?this.data.views[0].sort=t:console.error("Cannot set sort rules: No view definition found in data.")}showSortPopup(t){let e=document.querySelector(".json-table-sort-popup");e&&e.remove();let r=document.body.createEl("div",{cls:"json-table-popup json-table-sort-popup"}),a=t.getBoundingClientRect();r.style.top=`${a.bottom+5}px`,r.style.left=`${a.left}px`;let o=this.getCurrentSortRules(),c=o.length>0?o[0]:{columnId:null,direction:"asc"};r.createEl("div",{cls:"json-table-popup-header"}).createEl("h3",{text:"Sort",cls:"json-table-popup-title"});let d=r.createEl("div",{cls:"json-table-popup-content"}),g=d.createEl("select",{cls:"json-table-popup-select"}),f=g.createEl("option",{text:"-- None --",value:""});c.columnId===null&&(f.selected=!0),this.data.columns.forEach(T=>{let I=g.createEl("option",{text:T.name,value:T.id});T.id===c.columnId&&(I.selected=!0)});let p=d.createEl("select",{cls:"json-table-popup-select"}),h=p.createEl("option",{text:"Ascending",value:"asc"}),y=p.createEl("option",{text:"Descending",value:"desc"});c.direction==="asc"?h.selected=!0:y.selected=!0,p.disabled=c.columnId===null,g.addEventListener("change",()=>{p.disabled=g.value===""});let v=r.createEl("div",{cls:"json-table-popup-footer"}).createEl("button",{text:"Apply",cls:"json-table-btn json-table-btn--standard"}),x=async()=>{let T=g.value||null,I=p.value,_=T?[{columnId:T,direction:I}]:[];try{if(this.setCurrentSortRules(_),this.view&&typeof this.view.saveTableData=="function")await this.view.saveTableData(this.data);else{console.error("Error: View instance or saveTableData method is not available!"),O();return}this.triggerRender(),O()}catch(j){console.error("Error applying sort or saving:",j),O()}};v.addEventListener("click",x);let O=()=>{r.remove(),document.removeEventListener("click",C,!0)},C=T=>{!r.contains(T.target)&&!t.contains(T.target)&&O()};setTimeout(()=>{document.addEventListener("click",C,!0)},0)}sortDataInMemory(){let t=this.getCurrentSortRules();if(t.length===0)return;let{columnId:e,direction:r}=t[0],a=this.data.columns.find(c=>c.id===e);if(!a){console.warn(`Sort column with ID "${e}" not found. Skipping sort.`);return}let o=c=>c.replace(/[\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{1F1E0}-\u{1F1FF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}\u{FE0F}\u{1F900}-\u{1F9FF}\u{1FA70}-\u{1FAFF}]/gu,"").trim();this.data.rows.sort((c,l)=>{let d=c.find(v=>v.column===e),g=l.find(v=>v.column===e),f=(d==null?void 0:d.value)||"",p=(g==null?void 0:g.value)||"",h=!f,y=!p;if(h&&y)return 0;if(h)return 1;if(y)return-1;let k=0;switch(a.type){case"date":let v=parseInt(f,10),x=parseInt(p,10);k=(isNaN(v)?0:v)-(isNaN(x)?0:x);break;case"checkbox":let O=f==="true";k=O===(p==="true")?0:O?1:-1;break;default:let T=o(f),I=o(p);k=T.toLowerCase().localeCompare(I.toLowerCase());break}return r==="asc"?k:k*-1})}};var On=require("obsidian"),H={sort:"arrow-up-down",filter:"filter",text:"case-sensitive",dropdown:"circle-chevron-down",multiselect:"list",checkbox:"check-square",date:"calendar",link:"link",plus:"plus",moreVertical:"more-vertical",trash:"trash-2",gripVertical:"grip-vertical",table:"table"};function Q(n,t=16,e){let r=document.createElement("span");r.classList.add("json-table-icon"),e&&r.classList.add(e),(0,On.setIcon)(r,n);let a=r.querySelector("svg");return a&&(a.setAttribute("width",t.toString()),a.setAttribute("height",t.toString()),a.setAttribute("stroke-width","2")),r}var ct=class{constructor(t,e,r){this.data=t;this.triggerRender=e;this.view=r;var a,o,c;(o=(a=this.data.views)==null?void 0:a[0])!=null&&o.filter||((c=this.data.views)!=null&&c[0]?this.data.views[0].filter=[]:this.data.views=[{id:"default_"+Date.now(),name:"Default",sort:[],filter:[]}])}getCurrentFilterRules(){var t,e;return((e=(t=this.data.views)==null?void 0:t[0])==null?void 0:e.filter)||[]}setCurrentFilterRules(t){var e;(e=this.data.views)!=null&&e[0]?this.data.views[0].filter=t:console.error("Cannot set filter rules: No view definition found.")}showFilterPopup(t){let e=document.querySelector(".json-table-filter-popup");e&&e.remove();let r=document.body.createEl("div",{cls:"json-table-popup json-table-filter-popup"}),a=t.getBoundingClientRect();r.style.top=`${a.bottom+5}px`,r.style.left=`${a.left}px`,r.createEl("div",{cls:"json-table-popup-header"}).createEl("h3",{text:"Filters",cls:"json-table-popup-title"});let l=r.createEl("div",{cls:"json-table-popup-content"}).createDiv({cls:"json-table-filters-list"});this.rebuildFilterListUI(l,r),r.createEl("div",{cls:"json-table-popup-footer"}).createEl("button",{text:"+ Add Filter",cls:"json-table-btn json-table-btn--standard"}).addEventListener("click",()=>{var v;let h=(v=this.data.columns[0])==null?void 0:v.id;if(!h){console.warn("Cannot add filter: No columns exist.");return}let y={id:`filter_${Date.now()}`,columnId:h,operator:"contains",value:""},k=this.getCurrentFilterRules();k.push(y),this.setCurrentFilterRules(k),this.rebuildFilterListUI(l,r),this.applyFiltersAndRerender()});let f=()=>{r.remove(),document.removeEventListener("click",p,!0)},p=h=>{!r.contains(h.target)&&!t.contains(h.target)&&f()};setTimeout(()=>{document.addEventListener("click",p,!0)},0)}rebuildFilterListUI(t,e){t.empty();let r=this.getCurrentFilterRules();r.length===0?t.createDiv({text:"No filters applied",cls:"json-table-filter-empty"}):r.forEach((a,o)=>{this.renderFilterRow(t,a,o)})}renderFilterRow(t,e,r){let a=t.createDiv({cls:"json-table-filter-row"}),o=a.createEl("select",{cls:"json-table-popup-select"});this.data.columns.forEach(p=>{let h=o.createEl("option",{text:p.name,value:p.id});p.id===e.columnId&&(h.selected=!0)}),o.addEventListener("change",()=>{e.columnId=o.value,this.applyFiltersAndRerender()});let c=a.createEl("select",{cls:"json-table-popup-select"});[{label:"Contains",value:"contains"},{label:"Does not contain",value:"doesNotContain"},{label:"Starts with",value:"startsWith"},{label:"Ends with",value:"endsWith"},{label:"Is empty",value:"isEmpty"},{label:"Is not empty",value:"isNotEmpty"},{label:"Equals",value:"equals"},{label:"Not equal",value:"notEqual"}].forEach(p=>{let h=c.createEl("option",{text:p.label,value:p.value});p.value===e.operator&&(h.selected=!0)}),c.addEventListener("change",()=>{e.operator=c.value,e.operator==="isEmpty"||e.operator==="isNotEmpty"?d.addClass("is-hidden"):d.removeClass("is-hidden"),this.applyFiltersAndRerender()});let d=a.createEl("input",{type:"text",value:e.value||"",cls:"json-table-popup-input"});(e.operator==="isEmpty"||e.operator==="isNotEmpty")&&d.addClass("is-hidden"),d.addEventListener("blur",()=>{e.value=d.value,this.applyFiltersAndRerender()}),d.addEventListener("keydown",p=>{p.key==="Enter"&&(e.value=d.value,this.applyFiltersAndRerender())});let g=a.createEl("button",{cls:"json-table-delete-filter-button"}),f=Q(H.trash,14);g.appendChild(f),g.addEventListener("click",async()=>{let p=this.getCurrentFilterRules();p.splice(r,1),this.setCurrentFilterRules(p),await this.view.saveTableData(this.data),this.triggerRender();let h=t.closest(".json-table-filter-popup"),y=h==null?void 0:h.querySelector(".json-table-filters-list");y&&h?this.rebuildFilterListUI(y,h):console.error("Could not find filter list container/popup to re-render after delete.")})}async applyFiltersAndRerender(){try{await this.view.saveTableData(this.data),this.triggerRender()}catch(t){console.error("Error saving data after filter change:",t)}}getFilteredRows(){let t=this.getCurrentFilterRules();return t.length===0?this.data.rows:this.data.rows.filter(e=>t.every(r=>{let a=e.find(g=>g.column===r.columnId),o=(a==null?void 0:a.value)||"",c=r.value||"",l=o.toLowerCase(),d=c.toLowerCase();switch(r.operator){case"contains":return l.includes(d);case"doesNotContain":return!l.includes(d);case"startsWith":return l.startsWith(d);case"endsWith":return l.endsWith(d);case"isEmpty":return o==="";case"isNotEmpty":return o!=="";case"equals":return l===d;case"notEqual":return l!==d;default:return console.warn(`Unknown filter operator: ${r.operator}`),!0}}))}hasActiveFilters(){return this.getCurrentFilterRules().length>0}};var na={text:H.text,dropdown:H.dropdown,multiselect:H.multiselect,checkbox:H.checkbox,date:H.date,notelink:H.link},dt=class{constructor(t,e,r){this.container=t;this.data=e;this.view=r;this.isResizing=!1;this.colGroup=null;this.cellRenderers=new Map,this.registerRenderers(),this.columnEditors=new Map,this.registerColumnEditors(),this.sortHandler=new lt(this.data,()=>this.render(),this.view),this.filterHandler=new ct(this.data,()=>this.render(),this.view)}registerRenderers(){this.cellRenderers.set("text",new $e),this.cellRenderers.set("checkbox",new Be),this.cellRenderers.set("dropdown",new Ve),this.cellRenderers.set("multiselect",new ze),this.cellRenderers.set("notelink",new qe),this.cellRenderers.set("date",new it)}registerColumnEditors(){this.columnEditors.set("text",new Se),this.columnEditors.set("checkbox",new Se),this.columnEditors.set("dropdown",new Ie),this.columnEditors.set("multiselect",new Ie),this.columnEditors.set("notelink",new ot),this.columnEditors.set("date",new st)}renderRenameInput(){let t=this.container.createDiv({cls:"json-table-rename-container"}),e=this.view.getFilePath();if(!e)return;let a=e.substring(e.lastIndexOf("/")+1).replace(/\.(table\.json|table\.md)$/,""),o=t.createEl("input",{type:"text",cls:"json-table-rename-input",value:a,placeholder:"Table name"});o.addEventListener("blur",async()=>{let c=o.value.trim();c&&c!==a?await this.view.renameFile(c)||(o.value=a):c||(o.value=a)}),o.addEventListener("keydown",c=>{c.key==="Enter"?(c.preventDefault(),o.blur()):c.key==="Escape"&&(c.preventDefault(),o.value=a,o.blur())})}render(){var h,y;let t=this.container.querySelector(".json-table-wrapper"),e=(h=t==null?void 0:t.scrollLeft)!=null?h:0,r=(y=t==null?void 0:t.scrollTop)!=null?y:0;this.container.empty(),this.renderRenameInput();let a=this.container.createDiv({cls:"json-table-controls"}),o=a.createEl("button",{cls:"json-table-btn json-table-btn--standard json-table-sort-button",attr:{"aria-label":"Sort table"}}),c=Q(H.sort,16,"icon-sort");o.appendChild(c),o.appendText(" Sort"),o.addEventListener("click",()=>{this.sortHandler.showSortPopup(o)});let l=a.createEl("button",{cls:"json-table-btn json-table-btn--standard json-table-filter-button"}),d=Q(H.filter,16,"icon-filter");l.appendChild(d),l.appendText(" Filter"),this.filterHandler.hasActiveFilters()&&l.addClass("json-table-btn--active"),l.addEventListener("click",()=>{this.filterHandler.showFilterPopup(l)});let g=this.container.createEl("div",{cls:"json-table-wrapper"}),f=g.createEl("table",{cls:"json-table"});this.sortHandler.sortDataInMemory();let p=this.filterHandler.getFilteredRows();this.colGroup=f.createEl("colgroup"),this.renderColGroup(),this.renderHeader(f),this.renderBody(f,p),this.renderAddRowButton(this.container),requestAnimationFrame(()=>{g.scrollLeft=e,g.scrollTop=r})}renderColGroup(){if(!this.colGroup)return;let t=this.colGroup;t.empty(),this.data.columns.forEach((r,a)=>{let o=t.createEl("col");o.style.width=r.width?`${r.width}px`:"150px",o.setAttribute("data-col-index",a.toString())}),t.createEl("col").addClass("json-table-buttons-col")}renderHeader(t){let r=t.createEl("thead").createEl("tr"),a=null;this.data.columns.forEach((f,p)=>{let h=r.createEl("th",{cls:"json-table-header-cell"});h.draggable=!0,h.setAttribute("data-col-index",p.toString());let y=h.createEl("div",{cls:"json-table-header-content"}),k=na[f.type];if(k){let x=Q(k,14,`icon-col-${f.type}`);x&&y.appendChild(x)}y.appendText(f.name),h.createEl("div",{cls:"json-table-resize-handle"}).addEventListener("mousedown",x=>{this.onResizeStart(x,f,p)}),h.addEventListener("dragstart",x=>{if(x.target.classList.contains("json-table-resize-handle")){x.preventDefault();return}x.dataTransfer&&(x.dataTransfer.effectAllowed="move",a=p,h.classList.add("is-dragging"))}),h.addEventListener("dragover",x=>{x.preventDefault(),x.dataTransfer&&(x.dataTransfer.dropEffect="move"),h.classList.add("is-dragover")}),h.addEventListener("dragleave",()=>h.classList.remove("is-dragover")),h.addEventListener("drop",x=>{if(x.preventDefault(),h.classList.remove("is-dragover"),a===null)return;let O=p;if(a===O)return;let C=this.data.columns.splice(a,1)[0];this.data.columns.splice(O,0,C),this.view.saveTableData(this.data),this.render()}),h.addEventListener("dragend",()=>{h.classList.remove("is-dragging"),a=null}),h.addEventListener("click",x=>{if(this.isResizing){this.isResizing=!1;return}x.target.classList.contains("json-table-resize-handle")||(x.stopPropagation(),this.showEditColumnDialog(h,f,this.data,p))})});let o=r.createEl("th",{cls:"json-table-header-sticky json-table-buttons-th"}),l=o.createEl("div",{cls:"json-table-header-buttons-container"}).createEl("div",{cls:"json-table-btn json-table-btn--icon",attr:{"aria-label":"Add column",title:"Add column"}}),d=Q(H.plus,18);l.appendChild(d);let g=!1;l.addEventListener("click",f=>{f.preventDefault(),f.stopPropagation(),!g&&(g=!0,this.showAddColumnDialog(o,l,this.data,()=>{g=!1}))})}renderBody(t,e){let r=t.createEl("tbody"),a=new Map;this.data.rows.forEach((o,c)=>a.set(o,c)),e.forEach(o=>{var h;let c=r.createEl("tr",{cls:"json-table-row"}),l=(h=a.get(o))!=null?h:-1;this.renderRow(c,o,this.data.columns,l,this.data);let f=c.createEl("td",{cls:"json-table-row-actions-cell"}).createEl("div",{cls:"json-table-cell-content"}).createEl("div",{cls:"json-table-btn json-table-btn--icon",attr:{"aria-label":"Delete row",title:"Delete row"}}),p=Q(H.trash,16);f.appendChild(p),f.addEventListener("click",async y=>{y.stopPropagation(),l>-1?(this.data.rows.splice(l,1),await this.view.saveTableData(this.data),this.render()):console.error("Could not find original row index for deletion while filtered.")})})}renderRow(t,e,r,a,o){let c=new Map;e.forEach(l=>c.set(l.column,l.value)),r.forEach(l=>{let d=c.get(l.id)||"",g=t.createEl("td",{cls:"json-table-cell"}),f=this.cellRenderers.get(l.type)||this.cellRenderers.get("text");if(!f)return;let p=async h=>{let y=e.find(k=>k.column===l.id);y?y.value=h:e.push({column:l.id,value:h}),await this.view.saveTableData(o),(this.sortHandler.getCurrentSortRules().some(k=>k.columnId===l.id)||this.filterHandler.hasActiveFilters())&&this.render()};f.render(this.view.app,g,d,l,p)})}renderAddRowButton(t){let e=t.createEl("div",{cls:"json-table-add-row"}),r=e.createDiv({cls:"json-table-btn json-table-btn--hybrid"}),a=Q(H.plus,16);r.appendChild(a),r.createSpan({text:"Add row",cls:"json-table-add-row-text"}),e.addEventListener("click",async()=>{let o={};this.data.columns.forEach(d=>{o[d.id]=d.type==="checkbox"?"false":""}),this.filterHandler.getCurrentFilterRules().forEach(d=>{d.operator==="equals"&&d.value&&o.hasOwnProperty(d.columnId)&&(o[d.columnId]=d.value)});let l=Object.entries(o).map(([d,g])=>({column:d,value:g}));this.data.rows.push(l),await this.view.saveTableData(this.data),this.render()})}onResizeStart(t,e,r){if(!this.colGroup)return;this.isResizing=!0,t.preventDefault(),t.stopPropagation();let a=this.colGroup.querySelector(`col[data-col-index="${r}"]`);if(!a){this.isResizing=!1;return}let o=t.clientX,c=a.offsetWidth,l=g=>{let f=c+(g.clientX-o);f>40&&(a.style.width=`${f}px`)},d=()=>{document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",d);let g=a.offsetWidth;e.width=g,this.view.saveTableData(this.data),setTimeout(()=>{this.isResizing=!1},0)};document.addEventListener("mousemove",l),document.addEventListener("mouseup",d)}showEditColumnDialog(t,e,r,a){let o=document.querySelector(".json-table-edit-column-popup");o&&o.remove();let c=document.body.createEl("div",{cls:"json-table-popup json-table-edit-column-popup"}),l=t.getBoundingClientRect();c.style.top=`${l.bottom+5}px`,c.style.left=`${l.left}px`;let d=c.createEl("div",{cls:"json-table-popup-wrapper"}),g=d.createEl("input",{type:"text",cls:"json-table-edit-input",value:e.name,placeholder:"Column name"}),f=d.createEl("div",{cls:"json-table-column-editor-container"}),p=this.columnEditors.get(e.type)||this.columnEditors.get("text");p&&p.render(f,e,this.data,this.view);let h=d.createEl("button",{cls:"json-table-btn json-table-btn--hybrid json-table-btn---delete-column"}),y=Q(H.trash,16);h.appendChild(y),h.appendText("Delete Column"),g.focus(),g.select();let k=()=>{c.remove(),document.removeEventListener("click",O)},v=async()=>{let C=g.value.trim(),T=!1;if(C&&C!==e.name&&(e.name=C,T=!0),T){await this.view.saveTableData(r);let I=t.querySelector(".json-table-header-content"),_=I?Array.from(I.childNodes).find(j=>j.nodeType===Node.TEXT_NODE):null;_?_.textContent=C:console.warn("Could not find text node to update header name."),this.render()}k()},x=async()=>{r.columns.splice(a,1),r.rows.forEach(C=>{let T=C.findIndex(I=>I.column===e.id);T!==-1&&C.splice(T,1)}),await this.view.saveTableData(r),this.render(),k()};h.addEventListener("mousedown",C=>C.preventDefault()),h.addEventListener("click",async C=>{C.stopPropagation(),C.preventDefault(),document.removeEventListener("click",O),await x()}),g.addEventListener("keydown",C=>{C.key==="Enter"?(C.preventDefault(),v()):C.key==="Escape"&&(C.preventDefault(),k())});let O=C=>{!c.contains(C.target)&&!t.contains(C.target)&&v()};setTimeout(()=>{document.addEventListener("click",O)},100)}showAddColumnDialog(t,e,r,a){e.addClass("is-dimmed");let o=document.body.createEl("div",{cls:"json-table-popup json-table-column-popup"}),c=e.getBoundingClientRect();o.style.top=`${c.top}px`,o.style.right=`${document.body.clientWidth-c.right}px`;let l=o.createEl("div",{cls:"json-table-popup-wrapper"}),d=l.createEl("input",{type:"text",cls:"json-table-edit-input",placeholder:"New column name"});setTimeout(()=>d.focus(),50),l.createEl("div",{text:"Select column type:",cls:"json-table-popup-label"});let g=l.createEl("div",{cls:"json-table-type-buttons"}),f=[{type:"text",name:"Text",icon:H.text},{type:"checkbox",name:"Checkbox",icon:H.checkbox},{type:"dropdown",name:"Dropdown",icon:H.dropdown},{type:"multiselect",name:"Multi-select",icon:H.multiselect},{type:"notelink",name:"Note Link",icon:H.link},{type:"date",name:"Date",icon:H.date}],p=[{value:"To Do",style:"red"},{value:"In Progress",style:"blue"},{value:"Done",style:"green"}];f.forEach(({type:x,name:O,icon:C})=>{let T=g.createEl("div",{cls:"json-table-btn json-table-btn--hybrid",attr:{role:"button",tabindex:0}}),I=Q(C,16,`icon-type-${x}`);I&&T.appendChild(I),T.appendText(O);let _=()=>{let j={};(x==="dropdown"||x==="multiselect")&&(j={typeOptions:{options:p}}),x==="date"&&(j={dateFormat:"YYYY/MM/DD"}),y(x,O,j)};T.addEventListener("click",_),T.addEventListener("keydown",j=>{(j.key==="Enter"||j.key===" ")&&(j.preventDefault(),_())})});let h=()=>{o.remove(),e.removeClass("is-dimmed"),document.removeEventListener("click",k),document.removeEventListener("keydown",v),a()},y=async(x,O,C={})=>{let T=d.value.trim()||O,I="col_"+Date.now();r.columns.push({id:I,name:T,type:x,width:150,...C}),r.rows.forEach(_=>_.push({column:I,value:""})),await this.view.saveTableData(r),this.render(),h()},k=x=>{!o.contains(x.target)&&!e.contains(x.target)&&h()},v=x=>{x.key==="Escape"&&h()};d.addEventListener("keydown",x=>{x.key==="Enter"&&(x.preventDefault(),y("text","Text",{}))}),setTimeout(()=>{document.addEventListener("click",k),document.addEventListener("keydown",v)},100)}};var xe=class{constructor(t){this.app=t}async read(t){let e=await this.app.vault.read(t);if(!e)return console.warn(`File is empty: ${t.path}. Returning default structure.`),{columns:[],rows:[],views:[{id:"default_"+Date.now(),name:"Default",sort:[],filter:[]}]};try{let r=JSON.parse(e);if(!r.views||!Array.isArray(r.views)||r.views.length===0?(r.views=[{id:"default_"+Date.now(),name:"Default",sort:[],filter:[]}],r.views[0].sort||(r.views[0].sort=[]),r.views[0].filter||(r.views[0].filter=[])):(r.views[0].sort||(r.views[0].sort=[]),r.views[0].filter||(r.views[0].filter=[])),r.columns.forEach(a=>{a.typeOptions||(a.typeOptions={})}),!r.columns||!r.rows||!r.views)throw new Error("Invalid table JSON structure: missing columns, rows, or views.");return r}catch(r){throw console.error(`Error parsing JSON file ${t.path}:`,r),new Error(`Invalid JSON: ${r.message}`)}}async save(t,e){try{(!e.views||e.views.length===0)&&(e.views=[{id:"default_"+Date.now(),name:"Default",sort:[],filter:[]}]),e.views[0].sort||(e.views[0].sort=[]),e.views[0].filter||(e.views[0].filter=[]),e.columns.forEach(a=>{a.typeOptions||(a.typeOptions={})});let r=JSON.stringify(e,null,2);await this.app.vault.modify(t,r)}catch(r){throw console.error(`Error saving JSON file ${t.path}:`,r),new Error(`Failed to save file: ${r.message}`)}}};var ft=require("obsidian"),de="```json-table",ut="```",Pe=new RegExp(`${de}\\s*\\n?([\\s\\S]*?)\\n?\\s*${ut}`),Lt="json-table-plugin",ra="table-links",ke=class{constructor(t){this.app=t}async read(t){let e=await this.app.vault.read(t),r=this.app.metadataCache.getFileCache(t);if(((r==null?void 0:r.frontmatter)||{})[Lt]!==!0)throw new Error(`File ${t.path} is not a valid table file. Missing '${Lt}: true' in frontmatter.`);let o=e.match(Pe);if(!o||o[1]===void 0||o[1]===null)if(e.includes(de))if(e.substring(e.indexOf(de)).includes(ut)){let l=e.indexOf(de);throw console.error(`Regex failed despite markers present. Content around block:
`,e.substring(Math.max(0,l-20),l+100)),new Error(`Could not extract content from '${de}' code block in ${t.path}. Check for malformed block or unexpected characters.`)}else throw new Error(`Found '${de}' but no closing '${ut}' in ${t.path}`);else throw new Error(`Could not find '${de}' code block start in ${t.path}`);let c=o[1].trim();if(!c)return console.warn(`Empty json-table code block found in ${t.path}. Returning default structure.`),{columns:[],rows:[],views:[{id:"default_"+Date.now(),name:"Default",sort:[],filter:[]}]};try{let l=JSON.parse(c);if(!l||typeof l!="object"||!Array.isArray(l.columns)||!Array.isArray(l.rows))throw new Error("Invalid table JSON structure: missing columns or rows.");return(!l.views||!Array.isArray(l.views)||l.views.length===0)&&(l.views=[{id:"default_"+Date.now(),name:"Default",sort:[],filter:[]}]),l.views[0].sort||(l.views[0].sort=[]),l.columns.forEach(d=>{d.typeOptions||(d.typeOptions={},d.dateFormat&&(d.typeOptions.dateFormat=d.dateFormat,delete d.dateFormat),d.options&&(d.typeOptions.options=d.options,delete d.options),d.suggestAllFiles!==void 0&&(d.typeOptions.suggestAllFiles=d.suggestAllFiles,delete d.suggestAllFiles))}),l}catch(l){throw console.error(`Error parsing embedded JSON in ${t.path}:`,c.substring(0,500),l),new Error(`Invalid embedded JSON: ${l.message}`)}}async save(t,e){try{let r=JSON.stringify(e,null,2),a=this.extractLinkPaths(e),o=await this.app.vault.read(t),c=this.updateMarkdownContent(o,r,a);await this.app.vault.modify(t,c)}catch(r){throw console.error(`Error saving Markdown file ${t.path}:`,r),new Error(`Failed to save Markdown file: ${r.message}`)}}extractLinkPaths(t){let e=new Set,r=t.columns.filter(a=>a.type==="notelink").map(a=>a.id);return r.length===0?[]:(t.rows.forEach(a=>{a.forEach(o=>{r.includes(o.column)&&o.value&&e.add(o.value)})}),Array.from(e))}updateMarkdownContent(t,e,r){let a={},o=t;if(t.startsWith("---")){let f=t.match(/^---\s*([\s\S]*?)\s*---/);if(f&&f[1])try{a=(0,ft.parseYaml)(f[1])||{},o=t.substring(f[0].length).trimStart()}catch(p){console.warn(`Could not parse existing frontmatter in file, preserving original body structure. Error: ${p}`),a={},o=t}else o=t}else o=t;a[Lt]=!0,a[ra]=r.map(f=>`[[${f}]]`);let c=`---
${(0,ft.stringifyYaml)(a)}---
`,l=o,d=o.match(Pe),g=`${de}
${e}
${ut}`;if(d){let f=o.replace(Pe,"").trim(),p=/<!--[\s\S]*?-->/g,h=f.replace(p,"").trim();!h||h.startsWith("##"),l=o.replace(Pe,g)}else console.warn("No json-table code block found in body, appending new one."),l=(o.trim()?o.trim()+`

`:"")+g;return c+l.trim()+`
`}};var Le=class extends De.ItemView{constructor(e){super(e);this.renderer=null;this.fileHandler=null;this.data=null;this.settings=_e;this.currentFilePath=null}getFilePath(){return this.currentFilePath}getViewType(){return ee}getDisplayText(){let e=this.currentFilePath;return e&&e.substring(e.lastIndexOf("/")+1).replace(/\.(table\.json|table\.md)$/,"")||"Table"}getIcon(){return"table"}setSettings(e){this.settings=e,this.currentFilePath&&this.app.workspace.activeLeaf===this.leaf&&this.loadFileAndRender(this.currentFilePath)}async setState(e,r){let a=e.file||null,o=a!==this.currentFilePath;if(this.currentFilePath=a,await super.setState(e,r),this.currentFilePath&&(o||!this.data))await this.loadFileAndRender(this.currentFilePath);else if(!this.currentFilePath){let c=this.containerEl.children[1];c&&this.showError(c,"No file specified in view state.",!1)}}getState(){return{file:this.currentFilePath}}async loadFileAndRender(e){let r=this.app.vault.getAbstractFileByPath(e);r instanceof De.TFile?(this.selectFileHandler(r),await this.renderContent(r)):(console.error(`File not found or is a folder: ${e}`),this.showError(this.containerEl.children[1],`Cannot load table: File not found at "${e}".`,!1),this.clearView())}selectFileHandler(e){let r=this.settings.tableRenderer==="default",a=e.name.endsWith(".table.md"),o=e.name.endsWith(".table.json");this.fileHandler=null,a?r&&(this.fileHandler=new ke(this.app)):o&&(this.fileHandler=new xe(this.app))}async renderContent(e){let r=this.containerEl.children[1];if(r){if(r.empty(),this.renderer=null,this.data=null,r.addClass("json-table-view-container"),this.fileHandler||this.selectFileHandler(e),!this.fileHandler||!this.checkIfHandlerIsValid(e)){console.warn(`renderContent: No valid file handler for ${e.path} with current settings.`);let a=this.settings.tableRenderer==="default";e.name.endsWith(".table.md")&&!a?this.showError(r,"Set 'Table Renderer' to 'Default' in settings to view this file.",!1):this.showError(r,"This file is not recognized as a valid table type or requires different settings.",!0);return}try{if(this.data=await this.fileHandler.read(e),!this.data||typeof this.data!="object"||!Array.isArray(this.data.columns)||!Array.isArray(this.data.rows))throw new Error("Invalid table data structure received.");this.renderer=new dt(r,this.data,this),this.renderer.render()}catch(a){console.error(`Error rendering table for ${e.path}:`,a),this.clearView(),this.showError(r,`Error reading table file: ${a.message}`,!0)}}}async saveTableData(e){if(!this.currentFilePath){console.error("Cannot save: No file path associated with the view."),this.app.workspace.trigger("notice","Error: Cannot save, no file loaded.");return}let r=this.app.vault.getAbstractFileByPath(this.currentFilePath);if(!(r instanceof De.TFile)){console.error(`Cannot save: File not found at path "${this.currentFilePath}".`),this.app.workspace.trigger("notice","Error: File to save not found.");return}if(this.selectFileHandler(r),!this.fileHandler||!e||!this.checkIfHandlerIsValid(r)){console.error("Cannot save: No valid handler, data, or settings mismatch.",{file:r,handler:this.fileHandler,data:e}),this.app.workspace.trigger("notice","Error: Could not save table data.");return}try{await this.fileHandler.save(r,e),this.data=e}catch(a){console.error("Error saving table data:",a),this.app.workspace.trigger("notice",`Error saving table: ${a.message}`)}}async onOpen(){this.currentFilePath&&!this.renderer?await this.loadFileAndRender(this.currentFilePath):this.currentFilePath||this.showError(this.containerEl.children[1],"No file loaded.",!1)}async onClose(){this.clearView()}async renameFile(e){var h;if(!this.currentFilePath)return console.error("Cannot rename: No file path associated with the view."),!1;let r=this.app.vault.getAbstractFileByPath(this.currentFilePath);if(!(r instanceof De.TFile))return console.error(`Cannot rename: File not found at path "${this.currentFilePath}".`),!1;let a=((h=r.parent)==null?void 0:h.path)||"",o=r.name,c=o.endsWith(".table.json"),l=o.endsWith(".table.md");if(!c&&!l)return console.error(`Cannot rename: File "${o}" is not a recognized table file type.`),!1;let f=`${e.replace(/\.(table\.json|table\.md)$/,"")}${c?".table.json":".table.md"}`,p=a?`${a}/${f}`:f;if(await this.app.vault.adapter.exists(p))return console.error(`Cannot rename: File "${f}" already exists.`),!1;try{return await this.app.vault.rename(r,p),this.currentFilePath=p,!0}catch(y){return console.error("Error renaming file:",y),!1}}clearView(){var e;(e=this.containerEl.children[1])==null||e.empty(),this.renderer=null,this.fileHandler=null,this.data=null,this.currentFilePath=null}checkIfHandlerIsValid(e){let r=this.settings.tableRenderer==="default",a=e.name.endsWith(".table.md"),o=e.name.endsWith(".table.json");return a?r:!!o}showError(e,r,a=!1){if(!e)return;e.empty(),e.addClass("json-table-view-container");let o=e.createEl("div",{cls:"json-table-error"});o.createEl("p",{text:r});let c=this.currentFilePath;a&&c&&o.createEl("button",{text:"Open as raw text",cls:"json-table-add-row"}).addEventListener("click",()=>{this.leaf&&this.leaf.setViewState({type:"plaintext",state:{file:c}})})}};var pt=class extends B.Plugin{async onload(){await this.loadSettings(),this.registerView(ee,t=>{let e=new Le(t);return e.setSettings(this.settings),e}),this.app.workspace.onLayoutReady(()=>{this.registerFileExtensions()}),this.addSettingTab(new jt(this.app,this)),this.registerEvent(this.app.workspace.on("file-menu",(t,e,r,a)=>{var c;if(!(e instanceof B.TFile))t.addItem(l=>{l.setTitle("New table").setIcon("table").onClick(async()=>{await this.createNewTable(e)})});else if(e instanceof B.TFile&&e.name.endsWith(".table.md")&&a){let l=this.app.metadataCache.getFileCache(e);(c=l==null?void 0:l.frontmatter)!=null&&c["json-table-plugin"]&&a.view.getViewType()!==ee&&t.addItem(d=>{d.setTitle("Open as Table").setIcon("table").onClick(async()=>{await a.setViewState({type:ee,state:{file:e.path}},{focus:!0})})})}})),this.registerEvent(this.app.workspace.on("files-menu",(t,e)=>{if(e.length===1&&!(e[0]instanceof B.TFile)){let r=e[0];t.addItem(a=>{a.setTitle("New table").setIcon("table").onClick(async()=>{await this.createNewTable(r)})})}})),this.addCommand({id:"create-new-table",name:"Create new table",checkCallback:t=>{let e=this.app.workspace.getActiveFile(),r=e?e.parent:this.app.vault.getRoot();return r&&!(r instanceof B.TFile)?(t||this.createNewTable(r),!0):!1}}),this.registerEvent(this.app.vault.on("rename",(t,e)=>{t instanceof B.TFile&&this.updateLinksInAllTables(e,t.path)})),this.registerEvent(this.app.vault.on("delete",t=>{t instanceof B.TFile&&this.removeLinksInAllTables(t.path)})),this.registerEvent(this.app.workspace.on("file-open",async t=>{var o;if(this.settings.tableRenderer!=="default"||!t||!t.name.endsWith(".table.md"))return;let e=!1;try{let c=await this.app.vault.read(t);e=/^---\s*\n[\s\S]*?json-table-plugin:\s*true[\s\S]*?\n---/.test(c)}catch(c){console.error("file-open: Error reading file content:",c);return}if(!e)return;let r=null,a=this.app.workspace.getLeavesOfType("markdown");for(let c of a)if(((o=c.getViewState().state)==null?void 0:o.file)===t.path){r=c;break}if(r)try{await r.setViewState({type:ee,state:{file:t.path}},{focus:!0})}catch(c){console.error("file-open: Error during setViewState:",c)}}))}onunload(){}registerFileExtensions(){this.registerExtensions(["table.md"],ee),this.registerExtensions(["json"],ee)}async loadSettings(){this.settings=Object.assign({},_e,await this.loadData())}async saveSettings(){await this.saveData(this.settings),this.app.workspace.getLeavesOfType(ee).forEach(t=>{t.view instanceof Le&&t.view.setSettings(this.settings)})}async createNewTable(t){(!t||t instanceof B.TFile)&&(console.error("Invalid target folder provided for createNewTable. Using Vault root."),t=this.app.vault.getRoot());let e="col"+Date.now()+"_1",r="col"+Date.now()+"_2",a={columns:[{id:e,name:"Column 1",type:"text",width:150,typeOptions:{}},{id:r,name:"Column 2",type:"text",width:150,typeOptions:{}}],rows:[[{column:e,value:""},{column:r,value:""}]],views:[{id:"default_"+Date.now(),name:"Default",sort:[],filter:[]}]},o="",c="",l=1,d="",g="New Table",f=t.path==="/"?"":t.path;if(this.settings.tableRenderer==="default"){let p=".table.md";for(o=`${g}${p}`,d=f?`${f}/${o}`:o;await this.app.vault.adapter.exists(d);)o=`${g} ${l}${p}`,d=f?`${f}/${o}`:o,l++;let h=o.replace(p,""),y=JSON.stringify(a,null,2),k=`---
json-table-plugin: true
table-links: []
---
`,v=`
## ${h}

<!-- Do not edit the code block below manually -->

\`\`\`json-table
${y}
\`\`\`
`;c=k+v}else{let p=".table.json";for(o=`${g}${p}`,d=f?`${f}/${o}`:o;await this.app.vault.adapter.exists(d);)o=`${g} ${l}${p}`,d=f?`${f}/${o}`:o,l++;c=JSON.stringify(a,null,2)}try{let p=await this.app.vault.create(d,c);await this.app.workspace.getLeaf("tab").openFile(p)}catch(p){console.error(`Error creating table file "${d}":`,p),new B.Notice("Error creating table file. Check console for details.")}}getHandlerForFile(t){return t.name.endsWith(".table.md")?new ke(this.app):t.name.endsWith(".table.json")?new xe(this.app):null}async updateLinksInAllTables(t,e){let a=this.app.vault.getFiles().filter(o=>o.name.endsWith(".table.json")||o.name.endsWith(".table.md"));if(a.length!==0)for(let o of a){let c=this.getHandlerForFile(o);if(!c)continue;let l=null,d=!1;try{if(l=await c.read(o),!l||!l.columns||!l.rows){console.warn(`Skipping invalid data structure in ${o.path}`);continue}let g=l.columns.filter(f=>f.type==="notelink").map(f=>f.id);if(g.length===0)continue;l.rows.forEach(f=>{f.forEach(p=>{g.includes(p.column)&&p.value===t&&(p.value=e,d=!0)})}),d&&await c.save(o,l)}catch(g){console.error(`Failed to process links update in ${o.path}:`,g)}}}async removeLinksInAllTables(t){let r=this.app.vault.getFiles().filter(a=>a.name.endsWith(".table.json")||a.name.endsWith(".table.md"));if(r.length!==0)for(let a of r){let o=this.getHandlerForFile(a);if(!o)continue;let c=null,l=!1;try{if(c=await o.read(a),!c||!c.columns||!c.rows)continue;let d=c.columns.filter(g=>g.type==="notelink").map(g=>g.id);if(d.length===0)continue;c.rows.forEach(g=>{g.forEach(f=>{d.includes(f.column)&&f.value===t&&(f.value="",l=!0)})}),l&&await o.save(a,c)}catch(d){console.error(`Failed to process link removal in ${a.path}:`,d)}}}},jt=class extends B.PluginSettingTab{constructor(t,e){super(t,e),this.plugin=e}display(){let{containerEl:t}=this;t.empty(),t.createEl("h2",{text:"Tables Settings"}),new B.Setting(t).setName("Table Renderer").setDesc("By default, Tables uses .table.md to maximise compatibility and incorporate Obsidian backlink functionality. JSON is an alternative - it's faster and uses native JSON. Use if experiencing issues with the default renderer. Reload Obsidian for changes to take full effect on file handling and creation.").addDropdown(e=>e.addOption("default","Default (.table.md)").addOption("json","JSON (.table.json)").setValue(this.plugin.settings.tableRenderer).onChange(async r=>{this.plugin.settings.tableRenderer=r,await this.plugin.saveSettings(),new B.Notice("Reload required for file handling changes to take full effect.",7e3)}))}};
